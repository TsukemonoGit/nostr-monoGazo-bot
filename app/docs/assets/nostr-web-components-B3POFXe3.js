const Af="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Af);let wn=!1,Sf=!1;function Of(){wn=!0}Of();const Gs=1,Ys=2,fl=4,If=8,Rf=16,Bf=1,_f=2,Nf=4,Tf=8,Lf=16,Cf=1,qf=2,Js="[",Xs="[!",Qs="]",Dr={},Lt=Symbol(),Uf="http://www.w3.org/1999/xhtml",Pf=!1;var ti=Array.isArray,jf=Array.prototype.indexOf,ei=Array.from,Fn=Object.keys,Vn=Object.defineProperty,wr=Object.getOwnPropertyDescriptor,hl=Object.getOwnPropertyDescriptors,zf=Object.prototype,Df=Array.prototype,ri=Object.getPrototypeOf,ua=Object.isExtensible;const mr=()=>{};function Hf(t){return t()}function Kn(t){for(var e=0;e<t.length;e++)t[e]()}const Yt=2,ni=4,mn=8,oi=16,je=32,Tr=64,si=128,Gt=256,Wn=512,Ht=1024,Ue=2048,dr=4096,Ce=8192,bo=16384,dl=32768,wo=65536,ca=1<<17,Mf=1<<18,pl=1<<19,bs=1<<20,ii=1<<21,Er=Symbol("$state"),gl=Symbol("legacy props"),Ff=Symbol(""),yl=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"},ai=3,un=8;function vl(t){return t===this.v}function li(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function bl(t){return!li(t,this.v)}function Vf(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Kf(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Wf(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Zf(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Gf(){throw new Error("https://svelte.dev/e/hydration_failed")}function Yf(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Jf(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Xf(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Qf(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let At=null;function fa(t){At=t}function Ft(t,e=!1,r){At={p:At,c:null,e:null,s:t,x:null,l:null},wn&&!e&&(At.l={s:null,u:null,r1:[],r2:cn(!1)})}function Vt(t){var e=At,r=e.e;if(r!==null){e.e=null;for(var n of r)Il(n)}return t!==void 0&&(e.x=t),At=e.p,t??{}}function mo(){return!wn||At!==null&&At.l===null}function Pr(t){if(typeof t!="object"||t===null||Er in t)return t;const e=ri(t);if(e!==zf&&e!==Df)return t;var r=new Map,n=ti(t),o=ue(0),s=$r,i=l=>{if($r===s)return l();var a=ht,u=$r;$e(null),ga(s);var c=l();return $e(a),ga(u),c};return n&&r.set("length",ue(t.length)),new Proxy(t,{defineProperty(l,a,u){(!("value"in u)||u.configurable===!1||u.enumerable===!1||u.writable===!1)&&Jf();var c=r.get(a);return c===void 0?c=i(()=>{var f=ue(u.value);return r.set(a,f),f}):F(c,u.value,!0),!0},deleteProperty(l,a){var u=r.get(a);if(u===void 0){if(a in l){const h=i(()=>ue(Lt));r.set(a,h),Zo(o)}}else{if(n&&typeof a=="string"){var c=r.get("length"),f=Number(a);Number.isInteger(f)&&f<c.v&&F(c,f)}F(u,Lt),Zo(o)}return!0},get(l,a,u){if(a===Er)return t;var c=r.get(a),f=a in l;if(c===void 0&&(!f||wr(l,a)?.writable)&&(c=i(()=>{var g=Pr(f?l[a]:Lt),p=ue(g);return p}),r.set(a,c)),c!==void 0){var h=k(c);return h===Lt?void 0:h}return Reflect.get(l,a,u)},getOwnPropertyDescriptor(l,a){var u=Reflect.getOwnPropertyDescriptor(l,a);if(u&&"value"in u){var c=r.get(a);c&&(u.value=k(c))}else if(u===void 0){var f=r.get(a),h=f?.v;if(f!==void 0&&h!==Lt)return{enumerable:!0,configurable:!0,value:h,writable:!0}}return u},has(l,a){if(a===Er)return!0;var u=r.get(a),c=u!==void 0&&u.v!==Lt||Reflect.has(l,a);if(u!==void 0||st!==null&&(!c||wr(l,a)?.writable)){u===void 0&&(u=i(()=>{var h=c?Pr(l[a]):Lt,g=ue(h);return g}),r.set(a,u));var f=k(u);if(f===Lt)return!1}return c},set(l,a,u,c){var f=r.get(a),h=a in l;if(n&&a==="length")for(var g=u;g<f.v;g+=1){var p=r.get(g+"");p!==void 0?F(p,Lt):g in l&&(p=i(()=>ue(Lt)),r.set(g+"",p))}if(f===void 0)(!h||wr(l,a)?.writable)&&(f=i(()=>ue(void 0)),F(f,Pr(u)),r.set(a,f));else{h=f.v!==Lt;var d=i(()=>Pr(u));F(f,d)}var y=Reflect.getOwnPropertyDescriptor(l,a);if(y?.set&&y.set.call(c,u),!h){if(n&&typeof a=="string"){var v=r.get("length"),x=Number(a);Number.isInteger(x)&&x>=v.v&&F(v,x+1)}Zo(o)}return!0},ownKeys(l){k(o);var a=Reflect.ownKeys(l).filter(f=>{var h=r.get(f);return h===void 0||h.v!==Lt});for(var[u,c]of r)c.v!==Lt&&!(u in l)&&a.push(u);return a},setPrototypeOf(){Xf()}})}function En(t){var e=Yt|Ue,r=ht!==null&&(ht.f&Yt)!==0?ht:null;return st===null||r!==null&&(r.f&Gt)!==0?e|=Gt:st.f|=pl,{ctx:At,deps:null,effects:null,equals:vl,f:e,fn:t,reactions:null,rv:0,v:Lt,wv:0,parent:r??st,ac:null}}function jr(t){const e=En(t);return Ul(e),e}function Bt(t){const e=En(t);return e.equals=bl,e}function wl(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)ke(e[r])}}function th(t){for(var e=t.parent;e!==null;){if((e.f&Yt)===0)return e;e=e.parent}return null}function ui(t){var e,r=st;lr(th(t));try{wl(t),e=zl(t)}finally{lr(r)}return e}function ml(t){var e=ui(t);if(t.equals(e)||(t.v=e,t.wv=Pl()),!ar){var r=(er||(t.f&Gt)!==0)&&t.deps!==null?dr:Ht;he(t,r)}}const xr=new Map;function cn(t,e){var r={f:0,v:t,reactions:null,equals:vl,rv:0,wv:0};return r}function ue(t,e){const r=cn(t);return Ul(r),r}function yt(t,e=!1,r=!0){const n=cn(t);return e||(n.equals=bl),wn&&r&&At!==null&&At.l!==null&&(At.l.s??=[]).push(n),n}function F(t,e,r=!1){ht!==null&&(!we||(ht.f&ca)!==0)&&mo()&&(ht.f&(Yt|oi|ca))!==0&&!qe?.includes(t)&&Qf();let n=r?Pr(e):e;return ws(t,n)}function ws(t,e){if(!t.equals(e)){var r=t.v;ar?xr.set(t,e):xr.set(t,r),t.v=e,(t.f&Yt)!==0&&((t.f&Ue)!==0&&ui(t),he(t,(t.f&Gt)===0?Ht:dr)),t.wv=Pl(),El(t,Ue),mo()&&st!==null&&(st.f&Ht)!==0&&(st.f&(je|Tr))===0&&(ee===null?fh([t]):ee.push(t))}return e}function Zo(t){F(t,t.v+1)}function El(t,e){var r=t.reactions;if(r!==null)for(var n=mo(),o=r.length,s=0;s<o;s++){var i=r[s],l=i.f;(l&Ue)===0&&(!n&&i===st||(he(i,e),(l&(Ht|Gt))!==0&&((l&Yt)!==0?El(i,dr):So(i))))}}function Eo(t){console.warn("https://svelte.dev/e/hydration_mismatch")}let Q=!1;function fe(t){Q=t}let at;function ae(t){if(t===null)throw Eo(),Dr;return at=t}function xn(){return ae(ze(at))}function J(t){if(Q){if(ze(at)!==null)throw Eo(),Dr;at=t}}function Fr(t=1){if(Q){for(var e=t,r=at;e--;)r=ze(r);at=r}}function ms(){for(var t=0,e=at;;){if(e.nodeType===un){var r=e.data;if(r===Qs){if(t===0)return e;t-=1}else(r===Js||r===Xs)&&(t+=1)}var n=ze(e);e.remove(),e=n}}function xl(t){if(!t||t.nodeType!==un)throw Eo(),Dr;return t.data}var ha,kl,$l,Al;function Es(){if(ha===void 0){ha=window,kl=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;$l=wr(e,"firstChild").get,Al=wr(e,"nextSibling").get,ua(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),ua(r)&&(r.__t=void 0)}}function ir(t=""){return document.createTextNode(t)}function Ar(t){return $l.call(t)}function ze(t){return Al.call(t)}function X(t,e){if(!Q)return Ar(t);var r=Ar(at);if(r===null)r=at.appendChild(ir());else if(e&&r.nodeType!==ai){var n=ir();return r?.before(n),ae(n),n}return ae(r),r}function it(t,e){if(!Q){var r=Ar(t);return r instanceof Comment&&r.data===""?ze(r):r}return at}function be(t,e=1,r=!1){let n=Q?at:t;for(var o;e--;)o=n,n=ze(n);if(!Q)return n;if(r&&n?.nodeType!==ai){var s=ir();return n===null?o?.after(s):n.before(s),ae(s),s}return ae(n),n}function Sl(t){t.textContent=""}function Ol(t){st===null&&ht===null&&Wf(),ht!==null&&(ht.f&Gt)!==0&&st===null&&Kf(),ar&&Vf()}function eh(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function De(t,e,r,n=!0){var o=st,s={ctx:At,deps:null,nodes_start:null,nodes_end:null,f:t|Ue,first:null,fn:e,last:null,next:null,parent:o,b:o&&o.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{Ao(s),s.f|=dl}catch(a){throw ke(s),a}else e!==null&&So(s);var i=r&&s.deps===null&&s.first===null&&s.nodes_start===null&&s.teardown===null&&(s.f&(pl|si))===0;if(!i&&n&&(o!==null&&eh(s,o),ht!==null&&(ht.f&Yt)!==0)){var l=ht;(l.effects??=[]).push(s)}return s}function rh(t){const e=De(mn,null,!1);return he(e,Ht),e.teardown=t,e}function da(t){if(Ol(),!ht&&st&&(st.f&je)!==0){var e=At;(e.e??=[]).push(t)}else return Il(t)}function Il(t){return De(ni|ii,t,!1)}function nh(t){return Ol(),De(mn|ii,t,!0)}function oh(t){const e=De(Tr,t,!0);return()=>{ke(e)}}function sh(t){const e=De(Tr,t,!0);return(r={})=>new Promise(n=>{r.outro?Zn(e,()=>{ke(e),n(void 0)}):(ke(e),n(void 0))})}function Rl(t){return De(ni,t,!1)}function se(t,e){var r=At,n={effect:null,ran:!1};r.l.r1.push(n),n.effect=kn(()=>{t(),!n.ran&&(n.ran=!0,F(r.l.r2,!0),ft(e))})}function xo(){var t=At;kn(()=>{if(k(t.l.r2)){for(var e of t.l.r1){var r=e.effect;(r.f&Ht)!==0&&he(r,dr),$n(r)&&Ao(r),e.ran=!1}t.l.r2.v=!1}})}function kn(t){return De(mn,t,!0)}function Z(t,e=[],r=En){const n=e.map(r);return ko(()=>t(...n.map(k)))}function ko(t,e=0){var r=De(mn|oi|e,t,!0);return r}function Vr(t,e=!0){return De(mn|je,t,!0,e)}function Bl(t){var e=t.teardown;if(e!==null){const r=ar,n=ht;pa(!0),$e(null);try{e.call(null)}finally{pa(r),$e(n)}}}function _l(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){r.ac?.abort(yl);var n=r.next;(r.f&Tr)!==0?r.parent=null:ke(r,e),r=n}}function ih(t){for(var e=t.first;e!==null;){var r=e.next;(e.f&je)===0&&ke(e),e=r}}function ke(t,e=!0){var r=!1;(e||(t.f&Mf)!==0)&&t.nodes_start!==null&&t.nodes_end!==null&&(ah(t.nodes_start,t.nodes_end),r=!0),_l(t,e&&!r),Jn(t,0),he(t,bo);var n=t.transitions;if(n!==null)for(const s of n)s.stop();Bl(t);var o=t.parent;o!==null&&o.first!==null&&Nl(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function ah(t,e){for(;t!==null;){var r=t===e?null:ze(t);t.remove(),t=r}}function Nl(t){var e=t.parent,r=t.prev,n=t.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function Zn(t,e){var r=[];ci(t,r,!0),Tl(r,()=>{ke(t),e&&e()})}function Tl(t,e){var r=t.length;if(r>0){var n=()=>--r||e();for(var o of t)o.out(n)}else e()}function ci(t,e,r){if((t.f&Ce)===0){if(t.f^=Ce,t.transitions!==null)for(const i of t.transitions)(i.is_global||r)&&e.push(i);for(var n=t.first;n!==null;){var o=n.next,s=(n.f&wo)!==0||(n.f&je)!==0;ci(n,e,s?r:!1),n=o}}}function Gn(t){Ll(t,!0)}function Ll(t,e){if((t.f&Ce)!==0){t.f^=Ce;for(var r=t.first;r!==null;){var n=r.next,o=(r.f&wo)!==0||(r.f&je)!==0;Ll(r,o?e:!1),r=n}if(t.transitions!==null)for(const s of t.transitions)(s.is_global||e)&&s.in()}}let fn=[],xs=[];function Cl(){var t=fn;fn=[],Kn(t)}function lh(){var t=xs;xs=[],Kn(t)}function $o(t){fn.length===0&&queueMicrotask(Cl),fn.push(t)}function uh(){fn.length>0&&Cl(),xs.length>0&&lh()}function ch(t){var e=st;if((e.f&dl)===0){if((e.f&si)===0)throw t;e.fn(t)}else ql(t,e)}function ql(t,e){for(;e!==null;){if((e.f&si)!==0)try{e.b.error(t);return}catch{}e=e.parent}throw t}let hn=!1,dn=null,kr=!1,ar=!1;function pa(t){ar=t}let an=[],ht=null,we=!1;function $e(t){ht=t}let st=null;function lr(t){st=t}let qe=null;function Ul(t){ht!==null&&ht.f&bs&&(qe===null?qe=[t]:qe.push(t))}let Pt=null,Wt=0,ee=null;function fh(t){ee=t}let Yn=1,pn=0,$r=pn;function ga(t){$r=t}let er=!1;function Pl(){return++Yn}function $n(t){var e=t.f;if((e&Ue)!==0)return!0;if((e&dr)!==0){var r=t.deps,n=(e&Gt)!==0;if(r!==null){var o,s,i=(e&Wn)!==0,l=n&&st!==null&&!er,a=r.length;if(i||l){var u=t,c=u.parent;for(o=0;o<a;o++)s=r[o],(i||!s?.reactions?.includes(u))&&(s.reactions??=[]).push(u);i&&(u.f^=Wn),l&&c!==null&&(c.f&Gt)===0&&(u.f^=Gt)}for(o=0;o<a;o++)if(s=r[o],$n(s)&&ml(s),s.wv>t.wv)return!0}(!n||st!==null&&!er)&&he(t,Ht)}return!1}function jl(t,e,r=!0){var n=t.reactions;if(n!==null&&!qe?.includes(t))for(var o=0;o<n.length;o++){var s=n[o];(s.f&Yt)!==0?jl(s,e,!1):e===s&&(r?he(s,Ue):(s.f&Ht)!==0&&he(s,dr),So(s))}}function zl(t){var e=Pt,r=Wt,n=ee,o=ht,s=er,i=qe,l=At,a=we,u=$r,c=t.f;Pt=null,Wt=0,ee=null,er=(c&Gt)!==0&&(we||!kr||ht===null),ht=(c&(je|Tr))===0?t:null,qe=null,fa(t.ctx),we=!1,$r=++pn,t.f|=bs,t.ac!==null&&(t.ac.abort(yl),t.ac=null);try{var f=(0,t.fn)(),h=t.deps;if(Pt!==null){var g;if(Jn(t,Wt),h!==null&&Wt>0)for(h.length=Wt+Pt.length,g=0;g<Pt.length;g++)h[Wt+g]=Pt[g];else t.deps=h=Pt;if(!er||(c&Yt)!==0&&t.reactions!==null)for(g=Wt;g<h.length;g++)(h[g].reactions??=[]).push(t)}else h!==null&&Wt<h.length&&(Jn(t,Wt),h.length=Wt);if(mo()&&ee!==null&&!we&&h!==null&&(t.f&(Yt|dr|Ue))===0)for(g=0;g<ee.length;g++)jl(ee[g],t);return o!==null&&o!==t&&(pn++,ee!==null&&(n===null?n=ee:n.push(...ee))),f}catch(p){ch(p)}finally{Pt=e,Wt=r,ee=n,ht=o,er=s,qe=i,fa(l),we=a,$r=u,t.f^=bs}}function hh(t,e){let r=e.reactions;if(r!==null){var n=jf.call(r,t);if(n!==-1){var o=r.length-1;o===0?r=e.reactions=null:(r[n]=r[o],r.pop())}}r===null&&(e.f&Yt)!==0&&(Pt===null||!Pt.includes(e))&&(he(e,dr),(e.f&(Gt|Wn))===0&&(e.f^=Wn),wl(e),Jn(e,0))}function Jn(t,e){var r=t.deps;if(r!==null)for(var n=e;n<r.length;n++)hh(t,r[n])}function Ao(t){var e=t.f;if((e&bo)===0){he(t,Ht);var r=st,n=kr;st=t,kr=!0;try{(e&oi)!==0?ih(t):_l(t),Bl(t);var o=zl(t);t.teardown=typeof o=="function"?o:null,t.wv=Yn;var s;Pf&&Sf&&(t.f&Ue)!==0&&t.deps}finally{kr=n,st=r}}}function dh(){try{Zf()}catch(t){if(dn!==null)ql(t,dn);else throw t}}function Dl(){var t=kr;try{var e=0;for(kr=!0;an.length>0;){e++>1e3&&dh();var r=an,n=r.length;an=[];for(var o=0;o<n;o++){var s=gh(r[o]);ph(s)}xr.clear()}}finally{hn=!1,kr=t,dn=null}}function ph(t){var e=t.length;if(e!==0){for(var r=0;r<e;r++){var n=t[r];if((n.f&(bo|Ce))===0&&$n(n)){var o=Yn;if(Ao(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null?Nl(n):n.fn=null),Yn>o&&(n.f&ii)!==0)break}}for(;r<e;r+=1)So(t[r])}}function So(t){hn||(hn=!0,queueMicrotask(Dl));for(var e=dn=t;e.parent!==null;){e=e.parent;var r=e.f;if((r&(Tr|je))!==0){if((r&Ht)===0)return;e.f^=Ht}}an.push(e)}function gh(t){for(var e=[],r=t;r!==null;){var n=r.f,o=(n&(je|Tr))!==0,s=o&&(n&Ht)!==0;if(!s&&(n&Ce)===0){(n&ni)!==0?e.push(r):o?r.f^=Ht:$n(r)&&Ao(r);var i=r.first;if(i!==null){r=i;continue}}var l=r.parent;for(r=r.next;r===null&&l!==null;)r=l.next,l=l.parent}return e}function j(t){for(var e;;){if(uh(),an.length===0)return hn=!1,dn=null,e;hn=!0,Dl()}}function k(t){var e=t.f,r=(e&Yt)!==0;if(ht!==null&&!we){if(!qe?.includes(t)){var n=ht.deps;t.rv<pn&&(t.rv=pn,Pt===null&&n!==null&&n[Wt]===t?Wt++:Pt===null?Pt=[t]:(!er||!Pt.includes(t))&&Pt.push(t))}}else if(r&&t.deps===null&&t.effects===null){var o=t,s=o.parent;s!==null&&(s.f&Gt)===0&&(o.f^=Gt)}if(r&&!ar&&(o=t,$n(o)&&ml(o)),ar){if(xr.has(t))return xr.get(t);if(r){o=t;var i=o.v;return((o.f&Ht)!==0||Hl(o))&&(i=ui(o)),xr.set(o,i),i}}return t.v}function Hl(t){if(t.v===Lt)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(xr.has(e)||(e.f&Yt)!==0&&Hl(e))return!0;return!1}function ft(t){var e=we;try{return we=!0,t()}finally{we=e}}const yh=-7169;function he(t,e){t.f=t.f&yh|e}function Ot(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(Er in t)ks(t);else if(!Array.isArray(t))for(let e in t){const r=t[e];typeof r=="object"&&r&&Er in r&&ks(r)}}}function ks(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let n in t)try{ks(t[n],e)}catch{}const r=ri(t);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const n=hl(r);for(let o in n){const s=n[o].get;if(s)try{s.call(t)}catch{}}}}}function vh(t){var e=ht,r=st;$e(null),lr(null);try{return t()}finally{$e(e),lr(r)}}const bh=new Set,ya=new Set;function Ml(t){if(!Q)return;t.removeAttribute("onload"),t.removeAttribute("onerror");const e=t.__e;e!==void 0&&(t.__e=void 0,queueMicrotask(()=>{t.isConnected&&t.dispatchEvent(e)}))}function wh(t,e,r,n={}){function o(s){if(n.capture||sn.call(e,s),!s.cancelBubble)return vh(()=>r?.call(this,s))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?$o(()=>{e.addEventListener(t,o,n)}):e.addEventListener(t,o,n),o}function $s(t,e,r,n,o){var s={capture:n,passive:o},i=wh(t,e,r,s);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&rh(()=>{e.removeEventListener(t,i,s)})}function sn(t){var e=this,r=e.ownerDocument,n=t.type,o=t.composedPath?.()||[],s=o[0]||t.target,i=0,l=t.__root;if(l){var a=o.indexOf(l);if(a!==-1&&(e===document||e===window)){t.__root=e;return}var u=o.indexOf(e);if(u===-1)return;a<=u&&(i=a)}if(s=o[i]||t.target,s!==e){Vn(t,"currentTarget",{configurable:!0,get(){return s||r}});var c=ht,f=st;$e(null),lr(null);try{for(var h,g=[];s!==null;){var p=s.assignedSlot||s.parentNode||s.host||null;try{var d=s["__"+n];if(d!=null&&(!s.disabled||t.target===s))if(ti(d)){var[y,...v]=d;y.apply(s,[t,...v])}else d.call(s,t)}catch(x){h?g.push(x):h=x}if(t.cancelBubble||p===e||p===null)break;s=p}if(h){for(let x of g)queueMicrotask(()=>{throw x});throw h}}finally{t.__root=e,delete t.currentTarget,$e(c),lr(f)}}}function mh(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function nr(t,e){var r=st;r.nodes_start===null&&(r.nodes_start=t,r.nodes_end=e)}function K(t,e){var r=(e&Cf)!==0,n=(e&qf)!==0,o,s=!t.startsWith("<!>");return()=>{if(Q)return nr(at,null),at;o===void 0&&(o=mh(s?t:"<!>"+t),r||(o=Ar(o)));var i=n||kl?document.importNode(o,!0):o.cloneNode(!0);if(r){var l=Ar(i),a=i.lastChild;nr(l,a)}else nr(i,i);return i}}function ie(t=""){if(!Q){var e=ir(t+"");return nr(e,e),e}var r=at;return r.nodeType!==ai&&(r.before(r=ir()),ae(r)),nr(r,r),r}function ut(){if(Q)return nr(at,null),at;var t=document.createDocumentFragment(),e=document.createComment(""),r=ir();return t.append(e,r),nr(e,r),t}function q(t,e){if(Q){st.nodes_end=at,xn();return}t!==null&&t.before(e)}const Eh=["touchstart","touchmove"];function xh(t){return Eh.includes(t)}function $t(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??=t.nodeValue)&&(t.__t=r,t.nodeValue=r+"")}function Fl(t,e){return Vl(t,e)}function kh(t,e){Es(),e.intro=e.intro??!1;const r=e.target,n=Q,o=at;try{for(var s=Ar(r);s&&(s.nodeType!==un||s.data!==Js);)s=ze(s);if(!s)throw Dr;fe(!0),ae(s),xn();const i=Vl(t,{...e,anchor:s});if(at===null||at.nodeType!==un||at.data!==Qs)throw Eo(),Dr;return fe(!1),i}catch(i){if(i===Dr)return e.recover===!1&&Gf(),Es(),Sl(r),fe(!1),Fl(t,e);throw i}finally{fe(n),ae(o)}}const Lr=new Map;function Vl(t,{target:e,anchor:r,props:n={},events:o,context:s,intro:i=!0}){Es();var l=new Set,a=f=>{for(var h=0;h<f.length;h++){var g=f[h];if(!l.has(g)){l.add(g);var p=xh(g);e.addEventListener(g,sn,{passive:p});var d=Lr.get(g);d===void 0?(document.addEventListener(g,sn,{passive:p}),Lr.set(g,1)):Lr.set(g,d+1)}}};a(ei(bh)),ya.add(a);var u=void 0,c=sh(()=>{var f=r??e.appendChild(ir());return Vr(()=>{if(s){Ft({});var h=At;h.c=s}o&&(n.$$events=o),Q&&nr(f,null),u=t(f,n)||{},Q&&(st.nodes_end=at),s&&Vt()}),()=>{for(var h of l){e.removeEventListener(h,sn);var g=Lr.get(h);--g===0?(document.removeEventListener(h,sn),Lr.delete(h)):Lr.set(h,g)}ya.delete(a),f!==r&&f.parentNode?.removeChild(f)}});return As.set(u,c),u}let As=new WeakMap;function $h(t,e){const r=As.get(t);return r?(As.delete(t),r(e)):Promise.resolve()}function Zt(t,e,...r){var n=t,o=mr,s;ko(()=>{o!==(o=e())&&(s&&(ke(s),s=null),s=Vr(()=>o(n,...r)))},wo),Q&&(n=at)}function V(t,e,[r,n]=[0,0]){Q&&r===0&&xn();var o=t,s=null,i=null,l=Lt,a=r>0?wo:0,u=!1;const c=(h,g=!0)=>{u=!0,f(g,h)},f=(h,g)=>{if(l===(l=h))return;let p=!1;if(Q&&n!==-1){if(r===0){const y=xl(o);y===Js?n=0:y===Xs?n=1/0:(n=parseInt(y.substring(1)),n!==n&&(n=l?1/0:-1))}const d=n>r;!!l===d&&(o=ms(),ae(o),fe(!1),p=!0,n=-1)}l?(s?Gn(s):g&&(s=Vr(()=>g(o))),i&&Zn(i,()=>{i=null})):(i?Gn(i):g&&(i=Vr(()=>g(o,[r+1,n]))),s&&Zn(s,()=>{s=null})),p&&fe(!0)};ko(()=>{u=!1,e(c),u||f(null,null)},a),Q&&(o=at)}function fi(t,e){return e}function Ah(t,e,r,n){for(var o=[],s=e.length,i=0;i<s;i++)ci(e[i].e,o,!0);var l=s>0&&o.length===0&&r!==null;if(l){var a=r.parentNode;Sl(a),a.append(r),n.clear(),tr(t,e[0].prev,e[s-1].next)}Tl(o,()=>{for(var u=0;u<s;u++){var c=e[u];l||(n.delete(c.k),tr(t,c.prev,c.next)),ke(c.e,!l)}})}function Xn(t,e,r,n,o,s=null){var i=t,l={flags:e,items:new Map,first:null},a=(e&fl)!==0;if(a){var u=t;i=Q?ae(Ar(u)):u.appendChild(ir())}Q&&xn();var c=null,f=!1,h=Bt(()=>{var g=r();return ti(g)?g:g==null?[]:ei(g)});ko(()=>{var g=k(h),p=g.length;if(f&&p===0)return;f=p===0;let d=!1;if(Q){var y=xl(i)===Xs;y!==(p===0)&&(i=ms(),ae(i),fe(!1),d=!0)}if(Q){for(var v=null,x,m=0;m<p;m++){if(at.nodeType===un&&at.data===Qs){i=at,d=!0,fe(!1);break}var R=g[m],I=n(R,m);x=Kl(at,l,v,null,R,I,m,o,e,r),l.items.set(I,x),v=x}p>0&&ae(ms())}Q||Sh(g,l,i,o,e,n,r),s!==null&&(p===0?c?Gn(c):c=Vr(()=>s(i)):c!==null&&Zn(c,()=>{c=null})),d&&fe(!0),k(h)}),Q&&(i=at)}function Sh(t,e,r,n,o,s,i){var l=(o&If)!==0,a=(o&(Gs|Ys))!==0,u=t.length,c=e.items,f=e.first,h=f,g,p=null,d,y=[],v=[],x,m,R,I;if(l)for(I=0;I<u;I+=1)x=t[I],m=s(x,I),R=c.get(m),R!==void 0&&(R.a?.measure(),(d??=new Set).add(R));for(I=0;I<u;I+=1){if(x=t[I],m=s(x,I),R=c.get(m),R===void 0){var w=h?h.e.nodes_start:r;p=Kl(w,e,p,p===null?e.first:p.next,x,m,I,n,o,i),c.set(m,p),y=[],v=[],h=p.next;continue}if(a&&Oh(R,x,I,o),(R.e.f&Ce)!==0&&(Gn(R.e),l&&(R.a?.unfix(),(d??=new Set).delete(R))),R!==h){if(g!==void 0&&g.has(R)){if(y.length<v.length){var S=v[0],_;p=S.prev;var T=y[0],$=y[y.length-1];for(_=0;_<y.length;_+=1)va(y[_],S,r);for(_=0;_<v.length;_+=1)g.delete(v[_]);tr(e,T.prev,$.next),tr(e,p,T),tr(e,$,S),h=S,p=$,I-=1,y=[],v=[]}else g.delete(R),va(R,h,r),tr(e,R.prev,R.next),tr(e,R,p===null?e.first:p.next),tr(e,p,R),p=R;continue}for(y=[],v=[];h!==null&&h.k!==m;)(h.e.f&Ce)===0&&(g??=new Set).add(h),v.push(h),h=h.next;if(h===null)continue;R=h}y.push(R),p=R,h=R.next}if(h!==null||g!==void 0){for(var B=g===void 0?[]:ei(g);h!==null;)(h.e.f&Ce)===0&&B.push(h),h=h.next;var P=B.length;if(P>0){var U=(o&fl)!==0&&u===0?r:null;if(l){for(I=0;I<P;I+=1)B[I].a?.measure();for(I=0;I<P;I+=1)B[I].a?.fix()}Ah(e,B,U,c)}}l&&$o(()=>{if(d!==void 0)for(R of d)R.a?.apply()}),st.first=e.first&&e.first.e,st.last=p&&p.e}function Oh(t,e,r,n){(n&Gs)!==0&&ws(t.v,e),(n&Ys)!==0?ws(t.i,r):t.i=r}function Kl(t,e,r,n,o,s,i,l,a,u){var c=(a&Gs)!==0,f=(a&Rf)===0,h=c?f?yt(o,!1,!1):cn(o):o,g=(a&Ys)===0?i:cn(i),p={i:g,v:h,k:s,a:null,e:null,prev:r,next:n};try{return p.e=Vr(()=>l(t,h,g,u),Q),p.e.prev=r&&r.e,p.e.next=n&&n.e,r===null?e.first=p:(r.next=p,r.e.next=p.e),n!==null&&(n.prev=p,n.e.prev=p.e),p}finally{}}function va(t,e,r){for(var n=t.next?t.next.e.nodes_start:r,o=e?e.e.nodes_start:r,s=t.e.nodes_start;s!==n;){var i=ze(s);o.before(s),s=i}}function tr(t,e,r){e===null?t.first=r:(e.next=r,e.e.next=r&&r.e),r!==null&&(r.prev=e,r.e.prev=e&&e.e)}function Ih(t,e,r,n,o){Q&&xn();var s=e.$$slots?.[r],i=!1;s===!0&&(s=e.children,i=!0),s===void 0||s(t,i?()=>n:n)}function Ae(t,e){$o(()=>{var r=t.getRootNode(),n=r.host?r:r.head??r.ownerDocument.head;if(!n.querySelector("#"+e.hash)){const o=document.createElement("style");o.id=e.hash,o.textContent=e.code,n.appendChild(o)}})}function Oo(t,e,r){Rl(()=>{var n=ft(()=>e(t,r?.())||{});if(r&&n?.update){var o=!1,s={};kn(()=>{var i=r();Ot(i),o&&li(s,i)&&(s=i,n.update(i))}),o=!0}if(n?.destroy)return()=>n.destroy()})}function Wl(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(r=Wl(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Rh(){for(var t,e,r=0,n="",o=arguments.length;r<o;r++)(t=arguments[r])&&(e=Wl(t))&&(n&&(n+=" "),n+=e);return n}function Bh(t){return typeof t=="object"?Rh(t):t??""}function _h(t,e,r){var n=t==null?"":""+t;return e&&(n=n?n+" "+e:e),n===""?null:n}function Nh(t,e){return t==null?null:String(t)}function ur(t,e,r,n,o,s){var i=t.__className;if(Q||i!==r||i===void 0){var l=_h(r,n);(!Q||l!==t.getAttribute("class"))&&(l==null?t.removeAttribute("class"):t.className=l),t.__className=r}return s}function hi(t,e,r,n){var o=t.__style;if(Q||o!==e){var s=Nh(e);(!Q||s!==t.getAttribute("style"))&&(s==null?t.removeAttribute("style"):t.style.cssText=s),t.__style=e}return n}const Th=Symbol("is custom element"),Lh=Symbol("is html");function jt(t,e,r,n){var o=Ch(t);Q&&(o[e]=t.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&t.nodeName==="LINK")||o[e]!==(o[e]=r)&&(e==="loading"&&(t[Ff]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Zl(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function ce(t,e,r){var n=ht,o=st;let s=Q;Q&&fe(!1),$e(null),lr(null);try{e!=="style"&&(Ss.has(t.nodeName)||!customElements||customElements.get(t.tagName.toLowerCase())?Zl(t).includes(e):r&&typeof r=="object")?t[e]=r:jt(t,e,r==null?r:String(r))}finally{$e(n),lr(o),s&&fe(!0)}}function Ch(t){return t.__attributes??={[Th]:t.nodeName.includes("-"),[Lh]:t.namespaceURI===Uf}}var Ss=new Map;function Zl(t){var e=Ss.get(t.nodeName);if(e)return e;Ss.set(t.nodeName,e=[]);for(var r,n=t,o=Element.prototype;o!==n;){r=hl(n);for(var s in r)r[s].set&&e.push(s);n=ri(n)}return e}function ba(t,e){return t===e||t?.[Er]===e}function qh(t={},e,r,n){return Rl(()=>{var o,s;return kn(()=>{o=s,s=[],ft(()=>{t!==r(...s)&&(e(t,...s),o&&ba(r(...o),t)&&e(null,...o))})}),()=>{$o(()=>{s&&ba(r(...s),t)&&e(null,...s)})}}),t}function Io(t=!1){const e=At,r=e.l.u;if(!r)return;let n=()=>Ot(e.s);if(t){let o=0,s={};const i=En(()=>{let l=!1;const a=e.s;for(const u in a)a[u]!==s[u]&&(s[u]=a[u],l=!0);return l&&o++,o});n=()=>k(i)}r.b.length&&nh(()=>{wa(e,n),Kn(r.b)}),da(()=>{const o=ft(()=>r.m.map(Hf));return()=>{for(const s of o)typeof s=="function"&&s()}}),r.a.length&&da(()=>{wa(e,n),Kn(r.a)})}function wa(t,e){if(t.l.s)for(const r of t.l.s)k(r);e()}function Uh(t,e,r){if(t==null)return e(void 0),mr;const n=ft(()=>t.subscribe(e,r));return n.unsubscribe?()=>n.unsubscribe():n}const Cr=[];function Ph(t,e=mr){let r=null;const n=new Set;function o(l){if(li(t,l)&&(t=l,r)){const a=!Cr.length;for(const u of n)u[1](),Cr.push(u,t);if(a){for(let u=0;u<Cr.length;u+=2)Cr[u][0](Cr[u+1]);Cr.length=0}}}function s(l){o(l(t))}function i(l,a=mr){const u=[l,a];return n.add(u),n.size===1&&(r=e(o,s)||mr),l(t),()=>{n.delete(u),n.size===0&&r&&(r(),r=null)}}return{set:o,update:s,subscribe:i}}function Gl(t){let e;return Uh(t,r=>e=r)(),e}let Ln=!1;function jh(t){var e=Ln;try{return Ln=!1,[t(),Ln]}finally{Ln=e}}function D(t,e,r,n){var o=!wn||(r&_f)!==0,s=(r&Tf)!==0,i=(r&Lf)!==0,l=n,a=!0,u=()=>(a&&(a=!1,l=i?ft(n):n),l),c;if(s){var f=Er in t||gl in t;c=wr(t,e)?.set??(f&&e in t?m=>t[e]=m:void 0)}var h,g=!1;s?[h,g]=jh(()=>t[e]):h=t[e],h===void 0&&n!==void 0&&(h=u(),c&&(o&&Yf(),c(h)));var p;if(o?p=()=>{var m=t[e];return m===void 0?u():(a=!0,m)}:p=()=>{var m=t[e];return m!==void 0&&(l=void 0),m===void 0?l:m},o&&(r&Nf)===0)return p;if(c){var d=t.$$legacy;return function(m,R){return arguments.length>0?((!o||!R||d||g)&&c(R?p():m),m):p()}}var y=!1,v=((r&Bf)!==0?En:Bt)(()=>(y=!1,p()));s&&k(v);var x=st;return function(m,R){if(arguments.length>0){const I=R?k(v):o&&s?Pr(m):m;return F(v,I),y=!0,l!==void 0&&(l=I),m}return ar&&y||(x.f&bo)!==0?v.v:k(v)}}function zh(t){return new Dh(t)}class Dh{#e;#t;constructor(e){var r=new Map,n=(s,i)=>{var l=yt(i,!1,!1);return r.set(s,l),l};const o=new Proxy({...e.props||{},$$events:{}},{get(s,i){return k(r.get(i)??n(i,Reflect.get(s,i)))},has(s,i){return i===gl?!0:(k(r.get(i)??n(i,Reflect.get(s,i))),Reflect.has(s,i))},set(s,i,l){return F(r.get(i)??n(i,l),l),Reflect.set(s,i,l)}});this.#t=(e.hydrate?kh:Fl)(e.component,{target:e.target,anchor:e.anchor,props:o,context:e.context,intro:e.intro??!1,recover:e.recover}),(!e?.props?.$$host||e.sync===!1)&&j(),this.#e=o.$$events;for(const s of Object.keys(this.#t))s==="$set"||s==="$destroy"||s==="$on"||Vn(this,s,{get(){return this.#t[s]},set(i){this.#t[s]=i},enumerable:!0});this.#t.$set=s=>{Object.assign(o,s)},this.#t.$destroy=()=>{$h(this.#t)}}$set(e){this.#t.$set(e)}$on(e,r){this.#e[e]=this.#e[e]||[];const n=(...o)=>r.call(this,...o);return this.#e[e].push(n),()=>{this.#e[e]=this.#e[e].filter(o=>o!==n)}}$destroy(){this.#t.$destroy()}}let Yl;typeof HTMLElement=="function"&&(Yl=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;$$me;constructor(t,e,r){super(),this.$$ctor=t,this.$$s=e,r&&this.attachShadow({mode:"open"})}addEventListener(t,e,r){if(this.$$l[t]=this.$$l[t]||[],this.$$l[t].push(e),this.$$c){const n=this.$$c.$on(t,e);this.$$l_u.set(e,n)}super.addEventListener(t,e,r)}removeEventListener(t,e,r){if(super.removeEventListener(t,e,r),this.$$c){const n=this.$$l_u.get(e);n&&(n(),this.$$l_u.delete(e))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let t=function(n){return o=>{const s=document.createElement("slot");n!=="default"&&(s.name=n),q(o,s)}};if(await Promise.resolve(),!this.$$cn||this.$$c)return;const e={},r=Hh(this);for(const n of this.$$s)n in r&&(n==="default"&&!this.$$d.children?(this.$$d.children=t(n),e.default=!0):e[n]=t(n));for(const n of this.attributes){const o=this.$$g_p(n.name);o in this.$$d||(this.$$d[o]=zn(o,n.value,this.$$p_d,"toProp"))}for(const n in this.$$p_d)!(n in this.$$d)&&this[n]!==void 0&&(this.$$d[n]=this[n],delete this[n]);this.$$c=zh({component:this.$$ctor,target:this.shadowRoot||this,props:{...this.$$d,$$slots:e,$$host:this}}),this.$$me=oh(()=>{kn(()=>{this.$$r=!0;for(const n of Fn(this.$$c)){if(!this.$$p_d[n]?.reflect)continue;this.$$d[n]=this.$$c[n];const o=zn(n,this.$$d[n],this.$$p_d,"toAttribute");o==null?this.removeAttribute(this.$$p_d[n].attribute||n):this.setAttribute(this.$$p_d[n].attribute||n,o)}this.$$r=!1})});for(const n in this.$$l)for(const o of this.$$l[n]){const s=this.$$c.$on(n,o);this.$$l_u.set(o,s)}this.$$l={}}}attributeChangedCallback(t,e,r){this.$$r||(t=this.$$g_p(t),this.$$d[t]=zn(t,r,this.$$p_d,"toProp"),this.$$c?.$set({[t]:this.$$d[t]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{!this.$$cn&&this.$$c&&(this.$$c.$destroy(),this.$$me(),this.$$c=void 0)})}$$g_p(t){return Fn(this.$$p_d).find(e=>this.$$p_d[e].attribute===t||!this.$$p_d[e].attribute&&e.toLowerCase()===t)||t}});function zn(t,e,r,n){const o=r[t]?.type;if(e=o==="Boolean"&&typeof e!="boolean"?e!=null:e,!n||!r[t])return e;if(n==="toAttribute")switch(o){case"Object":case"Array":return e==null?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return e??null;default:return e}else switch(o){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":return e;case"Number":return e!=null?+e:e;default:return e}}function Hh(t){const e={};return t.childNodes.forEach(r=>{e[r.slot||"default"]=!0}),e}function Jt(t,e,r,n,o,s){let i=class extends Yl{constructor(){super(t,r,o),this.$$p_d=e}static get observedAttributes(){return Fn(e).map(l=>(e[l].attribute||l).toLowerCase())}};return Fn(e).forEach(l=>{Vn(i.prototype,l,{get(){return this.$$c&&l in this.$$c?this.$$c[l]:this.$$d[l]},set(a){a=zn(l,a,e),this.$$d[l]=a;var u=this.$$c;if(u){var c=wr(u,l)?.get;c?u[l]=a:u.$set({[l]:a})}}})}),n.forEach(l=>{Vn(i.prototype,l,{get(){return this.$$c?.[l]}})}),t.element=i,i}var Mh=Object.defineProperty,Fh=(t,e,r)=>e in t?Mh(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,H=(t,e,r)=>(Fh(t,typeof e!="symbol"?e+"":e,r),r);class An extends Error{}let ma=class extends An{constructor(t){super(`RxNostrWebSocketError: WebSocket was closed with code ${t} by relay.`),this.code=t,this.name="RxNostrWebSocketError"}};class Dn extends An{constructor(e){super(`RxNostrInvalidUsageError: ${e}`),this.name="RxNostrInvalidUsageError"}}let Go=class extends An{constructor(t){super(`RxNostrEnvironmentError: ${t}`),this.name="RxNostrEnvironmentError"}};class Jl extends An{constructor(){super("RxNostrLogicError: This is rx-nostr's internal bug. Please report to the author of the library."),this.name="RxNostrLogicError"}}let Re=class extends An{constructor(){super("RxNostrAlreadyDisposedError: Attempted to access a disposed resource."),this.name="RxNostrAlreadyDisposedError"}};const Sn=(t,e)=>({...e,...t});function Vh(t){if(typeof t.id!="string"||typeof t.sig!="string"||typeof t.kind!="number"||typeof t.pubkey!="string"||typeof t.content!="string"||typeof t.created_at!="number"||!Array.isArray(t.tags))return!1;for(let e=0;e<t.tags.length;e++){const r=t.tags[e];if(!Array.isArray(r))return!1;for(let n=0;n<r.length;n++)if(typeof r[n]=="object")return!1}return!0}function Yo(t){throw t}function Kh(t){return{async signEvent(e){var r,n;const o={...e,pubkey:e.pubkey??await((r=window?.nostr)==null?void 0:r.getPublicKey())??Yo(new Go("window.nostr.getPublicKey() is not found")),tags:[...e.tags??[]],created_at:e.created_at??Math.floor(Date.now()/1e3)};return Vh(o)?o:await((n=window?.nostr)==null?void 0:n.signEvent(o))??Yo(new Go("window.nostr.signEvent() is not found"))},getPublicKey(){var e;return((e=window?.nostr)==null?void 0:e.getPublicKey())??Yo(new Go("window.nostr.getPublicKey() is not found"))}}}const Wh=t=>Sn(t,{signer:Kh(),connectionStrategy:"lazy",retry:{strategy:"exponential",maxCount:5,initialDelay:1e3},disconnectTimeout:1e4,eoseTimeout:30*1e3,okTimeout:30*1e3,authTimeout:30*1e3,skipVerify:!1,skipValidateFilterMatching:!1,skipExpirationCheck:!1,skipFetchNip11:!1});function Zh(t){return"length"in t?t.map(Ea):[Ea(t)]}function Ea(t){return{...t,since:t.since?xa(t.since):void 0,until:t.until?xa(t.until):void 0}}function xa(t){return typeof t=="number"?t:t()}async function Gh(t){try{const e=new URL(t);return e.protocol=e.protocol.replace(/^ws(s?):/,"http$1:"),await(await fetch(e.toString(),{headers:{Accept:"application/nostr+json"}})).json()}catch{return{}}}function ka(t,e){try{return t()}catch(r){return e instanceof Function?e(r):e}}function Be(t){let e="";try{e=t.trim();const r=new URL(e);r.hash="",r.pathname=ka(()=>decodeURI(r.pathname),r.pathname),r.pathname=r.pathname.replace(/\/$/,""),r.hostname=r.hostname.replace(/\.$/,""),r.searchParams.sort(),r.search=ka(()=>decodeURIComponent(r.search),r.search);let n=r.toString();return r.search||(n=n.replace(/\/$/,"")),n}catch{return e}}class Hr extends Map{constructor(e){if(super(),!!e)for(const[r,n]of Object.entries(e))this.set(Be(r),n)}get(e){return super.get(Be(e))}getMany(e){const r=[];for(const n of new Set(e.map(Be))){const o=this.get(n);o!==void 0&&r.push(o)}return r}set(e,r){return super.set(Be(e),r)}has(e){return super.has(Be(e))}delete(e){return super.delete(Be(e))}toObject(){const e={};for(const[r,n]of this.entries())e[r]=n;return e}toKeys(){return[...super.keys()]}toValues(){return[...super.values()]}copy(){return new Hr(this.toObject())}}class Qn{static async getValue(e,r,n){if(!(n!=null&&n.skipCache)){const o=await this.cache.get(e);if(o)return r(o)}if(!(n!=null&&n.skipFetch)){const o=await this.fetch(e);if(o)return r(o)}return r(this.default)}static get(e){const r=this.cache.get(e);if(r&&!(r instanceof Promise))return r}static async fetch(e){const r=Gh(e);return this.cache.set(e,r),r.then(n=>{this.cache.set(e,n)}),r}static async getOrFetch(e){return this.cache.get(e)??this.fetch(e)}static set(e,r){this.cache.set(e,r)}static getDefault(){return this.default}static setDefault(e){this.default=e}static forget(e){this.cache.delete(e)}static forgetAll(){this.cache.clear()}}H(Qn,"cache",new Hr),H(Qn,"default",{});/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */new Uint8Array(new Uint32Array([287454020]).buffer)[0];function Yh(t,e,r){return Array.isArray(e)?e.some(n=>$a(t,n)):$a(t,e)}function $a(t,e,r){const{sinceInclusive:n,untilInclusive:o}=Sn({},{sinceInclusive:!0,untilInclusive:!0});if(e.ids&&e.ids.every(s=>!t.id.startsWith(s))||e.kinds&&!e.kinds.includes(t.kind)||e.authors&&e.authors.every(s=>!t.pubkey.startsWith(s))||e.since&&(n&&!(e.since<=t.created_at)||!n&&!(e.since<t.created_at))||e.until&&(o&&!(t.created_at<=e.until)||!o&&!(t.created_at<e.until)))return!1;for(const[s,i]of Object.entries(e)){if(!s.startsWith("#")||!Array.isArray(i))continue;const l=s.slice(1);if(!t.tags.find(([a,u])=>l===a&&i.includes(u)))return!1}return!0}function Jh(t,e){const r=t.tags.find(n=>n[0]==="expiration");if(!r)return!1;try{const n=Number(r[1]);return Number.isInteger(n)?n<=(e??Math.floor(Date.now()/1e3)):!1}catch{return!1}}var Os=function(t,e){return Os=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},Os(t,e)};function He(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Os(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}function Xh(t,e,r,n){function o(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function l(c){try{u(n.next(c))}catch(f){i(f)}}function a(c){try{u(n.throw(c))}catch(f){i(f)}}function u(c){c.done?s(c.value):o(c.value).then(l,a)}u((n=n.apply(t,[])).next())})}function Xl(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,i;return i={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(u){return function(c){return a([u,c])}}function a(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(r=0)),r;)try{if(n=1,o&&(s=u[0]&2?o.return:u[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,u[1])).done)return s;switch(o=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,o=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(c){u=[6,c],o=0}finally{n=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Kr(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Wr(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],i;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(l){i={error:l}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}return s}function Zr(t,e,r){if(arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))}function Mr(t){return this instanceof Mr?(this.v=t,this):new Mr(t)}function Qh(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),o,s=[];return o={},i("next"),i("throw"),i("return"),o[Symbol.asyncIterator]=function(){return this},o;function i(h){n[h]&&(o[h]=function(g){return new Promise(function(p,d){s.push([h,g,p,d])>1||l(h,g)})})}function l(h,g){try{a(n[h](g))}catch(p){f(s[0][3],p)}}function a(h){h.value instanceof Mr?Promise.resolve(h.value.v).then(u,c):f(s[0][2],h)}function u(h){l("next",h)}function c(h){l("throw",h)}function f(h,g){h(g),s.shift(),s.length&&l(s[0][0],s[0][1])}}function td(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Kr=="function"?Kr(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=t[s]&&function(i){return new Promise(function(l,a){i=t[s](i),o(l,a,i.done,i.value)})}}function o(s,i,l,a){Promise.resolve(a).then(function(u){s({value:u,done:l})},i)}}function kt(t){return typeof t=="function"}function Ro(t){var e=function(n){Error.call(n),n.stack=new Error().stack},r=t(e);return r.prototype=Object.create(Error.prototype),r.prototype.constructor=r,r}var Jo=Ro(function(t){return function(e){t(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(r,n){return n+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function to(t,e){if(t){var r=t.indexOf(e);0<=r&&t.splice(r,1)}}var On=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,r,n,o,s;if(!this.closed){this.closed=!0;var i=this._parentage;if(i)if(this._parentage=null,Array.isArray(i))try{for(var l=Kr(i),a=l.next();!a.done;a=l.next()){var u=a.value;u.remove(this)}}catch(d){e={error:d}}finally{try{a&&!a.done&&(r=l.return)&&r.call(l)}finally{if(e)throw e.error}}else i.remove(this);var c=this.initialTeardown;if(kt(c))try{c()}catch(d){s=d instanceof Jo?d.errors:[d]}var f=this._finalizers;if(f){this._finalizers=null;try{for(var h=Kr(f),g=h.next();!g.done;g=h.next()){var p=g.value;try{Aa(p)}catch(d){s=s??[],d instanceof Jo?s=Zr(Zr([],Wr(s)),Wr(d.errors)):s.push(d)}}}catch(d){n={error:d}}finally{try{g&&!g.done&&(o=h.return)&&o.call(h)}finally{if(n)throw n.error}}}if(s)throw new Jo(s)}},t.prototype.add=function(e){var r;if(e&&e!==this)if(this.closed)Aa(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(r=this._finalizers)!==null&&r!==void 0?r:[]).push(e)}},t.prototype._hasParent=function(e){var r=this._parentage;return r===e||Array.isArray(r)&&r.includes(e)},t.prototype._addParent=function(e){var r=this._parentage;this._parentage=Array.isArray(r)?(r.push(e),r):r?[r,e]:e},t.prototype._removeParent=function(e){var r=this._parentage;r===e?this._parentage=null:Array.isArray(r)&&to(r,e)},t.prototype.remove=function(e){var r=this._finalizers;r&&to(r,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),Ql=On.EMPTY;function tu(t){return t instanceof On||t&&"closed"in t&&kt(t.remove)&&kt(t.add)&&kt(t.unsubscribe)}function Aa(t){kt(t)?t():t.unsubscribe()}var ed={Promise:void 0},rd={setTimeout:function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setTimeout.apply(void 0,Zr([t,e],Wr(r)))},clearTimeout:function(t){return clearTimeout(t)},delegate:void 0};function eu(t){rd.setTimeout(function(){throw t})}function eo(){}function Hn(t){t()}var di=function(t){He(e,t);function e(r){var n=t.call(this)||this;return n.isStopped=!1,r?(n.destination=r,tu(r)&&r.add(n)):n.destination=sd,n}return e.create=function(r,n,o){return new ro(r,n,o)},e.prototype.next=function(r){this.isStopped||this._next(r)},e.prototype.error=function(r){this.isStopped||(this.isStopped=!0,this._error(r))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(r){this.destination.next(r)},e.prototype._error=function(r){try{this.destination.error(r)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}(On),nd=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var r=this.partialObserver;if(r.next)try{r.next(e)}catch(n){Cn(n)}},t.prototype.error=function(e){var r=this.partialObserver;if(r.error)try{r.error(e)}catch(n){Cn(n)}else Cn(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(r){Cn(r)}},t}(),ro=function(t){He(e,t);function e(r,n,o){var s=t.call(this)||this,i;return kt(r)||!r?i={next:r??void 0,error:n??void 0,complete:o??void 0}:i=r,s.destination=new nd(i),s}return e}(di);function Cn(t){eu(t)}function od(t){throw t}var sd={closed:!0,next:eo,error:od,complete:eo},pi=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Me(t){return t}function id(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return ru(t)}function ru(t){return t.length===0?Me:t.length===1?t[0]:function(e){return t.reduce(function(r,n){return n(r)},e)}}var Mt=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(e,r,n){var o=this,s=ld(e)?e:new ro(e,r,n);return Hn(function(){var i=o,l=i.operator,a=i.source;s.add(l?l.call(s,a):a?o._subscribe(s):o._trySubscribe(s))}),s},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(r){e.error(r)}},t.prototype.forEach=function(e,r){var n=this;return r=Sa(r),new r(function(o,s){var i=new ro({next:function(l){try{e(l)}catch(a){s(a),i.unsubscribe()}},error:s,complete:o});n.subscribe(i)})},t.prototype._subscribe=function(e){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(e)},t.prototype[pi]=function(){return this},t.prototype.pipe=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return ru(e)(this)},t.prototype.toPromise=function(e){var r=this;return e=Sa(e),new e(function(n,o){var s;r.subscribe(function(i){return s=i},function(i){return o(i)},function(){return n(s)})})},t.create=function(e){return new t(e)},t}();function Sa(t){var e;return(e=t??ed.Promise)!==null&&e!==void 0?e:Promise}function ad(t){return t&&kt(t.next)&&kt(t.error)&&kt(t.complete)}function ld(t){return t&&t instanceof di||ad(t)&&tu(t)}function ud(t){return kt(t?.lift)}function Tt(t){return function(e){if(ud(e))return e.lift(function(r){try{return t(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function St(t,e,r,n,o){return new cd(t,e,r,n,o)}var cd=function(t){He(e,t);function e(r,n,o,s,i,l){var a=t.call(this,r)||this;return a.onFinalize=i,a.shouldUnsubscribe=l,a._next=n?function(u){try{n(u)}catch(c){r.error(c)}}:t.prototype._next,a._error=s?function(u){try{s(u)}catch(c){r.error(c)}finally{this.unsubscribe()}}:t.prototype._error,a._complete=o?function(){try{o()}catch(u){r.error(u)}finally{this.unsubscribe()}}:t.prototype._complete,a}return e.prototype.unsubscribe=function(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;t.prototype.unsubscribe.call(this),!n&&((r=this.onFinalize)===null||r===void 0||r.call(this))}},e}(di),fd=Ro(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),mt=function(t){He(e,t);function e(){var r=t.call(this)||this;return r.closed=!1,r.currentObservers=null,r.observers=[],r.isStopped=!1,r.hasError=!1,r.thrownError=null,r}return e.prototype.lift=function(r){var n=new Oa(this,this);return n.operator=r,n},e.prototype._throwIfClosed=function(){if(this.closed)throw new fd},e.prototype.next=function(r){var n=this;Hn(function(){var o,s;if(n._throwIfClosed(),!n.isStopped){n.currentObservers||(n.currentObservers=Array.from(n.observers));try{for(var i=Kr(n.currentObservers),l=i.next();!l.done;l=i.next()){var a=l.value;a.next(r)}}catch(u){o={error:u}}finally{try{l&&!l.done&&(s=i.return)&&s.call(i)}finally{if(o)throw o.error}}}})},e.prototype.error=function(r){var n=this;Hn(function(){if(n._throwIfClosed(),!n.isStopped){n.hasError=n.isStopped=!0,n.thrownError=r;for(var o=n.observers;o.length;)o.shift().error(r)}})},e.prototype.complete=function(){var r=this;Hn(function(){if(r._throwIfClosed(),!r.isStopped){r.isStopped=!0;for(var n=r.observers;n.length;)n.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var r;return((r=this.observers)===null||r===void 0?void 0:r.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(r){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,r)},e.prototype._subscribe=function(r){return this._throwIfClosed(),this._checkFinalizedStatuses(r),this._innerSubscribe(r)},e.prototype._innerSubscribe=function(r){var n=this,o=this,s=o.hasError,i=o.isStopped,l=o.observers;return s||i?Ql:(this.currentObservers=null,l.push(r),new On(function(){n.currentObservers=null,to(l,r)}))},e.prototype._checkFinalizedStatuses=function(r){var n=this,o=n.hasError,s=n.thrownError,i=n.isStopped;o?r.error(s):i&&r.complete()},e.prototype.asObservable=function(){var r=new Mt;return r.source=this,r},e.create=function(r,n){return new Oa(r,n)},e}(Mt),Oa=function(t){He(e,t);function e(r,n){var o=t.call(this)||this;return o.destination=r,o.source=n,o}return e.prototype.next=function(r){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.next)===null||o===void 0||o.call(n,r)},e.prototype.error=function(r){var n,o;(o=(n=this.destination)===null||n===void 0?void 0:n.error)===null||o===void 0||o.call(n,r)},e.prototype.complete=function(){var r,n;(n=(r=this.destination)===null||r===void 0?void 0:r.complete)===null||n===void 0||n.call(r)},e.prototype._subscribe=function(r){var n,o;return(o=(n=this.source)===null||n===void 0?void 0:n.subscribe(r))!==null&&o!==void 0?o:Ql},e}(mt),hd=function(t){He(e,t);function e(r){var n=t.call(this)||this;return n._value=r,n}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(r){var n=t.prototype._subscribe.call(this,r);return!n.closed&&r.next(this._value),n},e.prototype.getValue=function(){var r=this,n=r.hasError,o=r.thrownError,s=r._value;if(n)throw o;return this._throwIfClosed(),s},e.prototype.next=function(r){t.prototype.next.call(this,this._value=r)},e}(mt),dd={now:function(){return Date.now()}},pd=function(t){He(e,t);function e(r,n){return t.call(this)||this}return e.prototype.schedule=function(r,n){return this},e}(On),Is={setInterval:function(t,e){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var o=Is.delegate;return o!=null&&o.setInterval?o.setInterval.apply(o,Zr([t,e],Wr(r))):setInterval.apply(void 0,Zr([t,e],Wr(r)))},clearInterval:function(t){return clearInterval(t)},delegate:void 0},gd=function(t){He(e,t);function e(r,n){var o=t.call(this,r,n)||this;return o.scheduler=r,o.work=n,o.pending=!1,o}return e.prototype.schedule=function(r,n){var o;if(n===void 0&&(n=0),this.closed)return this;this.state=r;var s=this.id,i=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(i,s,n)),this.pending=!0,this.delay=n,this.id=(o=this.id)!==null&&o!==void 0?o:this.requestAsyncId(i,this.id,n),this},e.prototype.requestAsyncId=function(r,n,o){return o===void 0&&(o=0),Is.setInterval(r.flush.bind(r,this),o)},e.prototype.recycleAsyncId=function(r,n,o){if(o===void 0&&(o=0),o!=null&&this.delay===o&&this.pending===!1)return n;n!=null&&Is.clearInterval(n)},e.prototype.execute=function(r,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var o=this._execute(r,n);if(o)return o;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(r,n){var o=!1,s;try{this.work(r)}catch(i){o=!0,s=i||new Error("Scheduled action threw falsy error")}if(o)return this.unsubscribe(),s},e.prototype.unsubscribe=function(){if(!this.closed){var r=this,n=r.id,o=r.scheduler,s=o.actions;this.work=this.state=this.scheduler=null,this.pending=!1,to(s,this),n!=null&&(this.id=this.recycleAsyncId(o,n,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(pd),Ia=function(){function t(e,r){r===void 0&&(r=t.now),this.schedulerActionCtor=e,this.now=r}return t.prototype.schedule=function(e,r,n){return r===void 0&&(r=0),new this.schedulerActionCtor(this,e).schedule(n,r)},t.now=dd.now,t}(),yd=function(t){He(e,t);function e(r,n){n===void 0&&(n=Ia.now);var o=t.call(this,r,n)||this;return o.actions=[],o._active=!1,o}return e.prototype.flush=function(r){var n=this.actions;if(this._active){n.push(r);return}var o;this._active=!0;do if(o=r.execute(r.state,r.delay))break;while(r=n.shift());if(this._active=!1,o){for(;r=n.shift();)r.unsubscribe();throw o}},e}(Ia),nu=new yd(gd),vd=nu,In=new Mt(function(t){return t.complete()});function bd(t){return t&&kt(t.schedule)}function gi(t){return t[t.length-1]}function wd(t){return kt(gi(t))?t.pop():void 0}function yi(t){return bd(gi(t))?t.pop():void 0}function md(t,e){return typeof gi(t)=="number"?t.pop():e}var ou=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function su(t){return kt(t?.then)}function iu(t){return kt(t[pi])}function au(t){return Symbol.asyncIterator&&kt(t?.[Symbol.asyncIterator])}function lu(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function Ed(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var uu=Ed();function cu(t){return kt(t?.[uu])}function fu(t){return Qh(this,arguments,function(){var e,r,n,o;return Xl(this,function(s){switch(s.label){case 0:e=t.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,Mr(e.read())];case 3:return r=s.sent(),n=r.value,o=r.done,o?[4,Mr(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,Mr(n)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return e.releaseLock(),[7];case 10:return[2]}})})}function hu(t){return kt(t?.getReader)}function pe(t){if(t instanceof Mt)return t;if(t!=null){if(iu(t))return xd(t);if(ou(t))return kd(t);if(su(t))return $d(t);if(au(t))return du(t);if(cu(t))return Ad(t);if(hu(t))return Sd(t)}throw lu(t)}function xd(t){return new Mt(function(e){var r=t[pi]();if(kt(r.subscribe))return r.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function kd(t){return new Mt(function(e){for(var r=0;r<t.length&&!e.closed;r++)e.next(t[r]);e.complete()})}function $d(t){return new Mt(function(e){t.then(function(r){e.closed||(e.next(r),e.complete())},function(r){return e.error(r)}).then(null,eu)})}function Ad(t){return new Mt(function(e){var r,n;try{for(var o=Kr(t),s=o.next();!s.done;s=o.next()){var i=s.value;if(e.next(i),e.closed)return}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}e.complete()})}function du(t){return new Mt(function(e){Od(t,e).catch(function(r){return e.error(r)})})}function Sd(t){return du(fu(t))}function Od(t,e){var r,n,o,s;return Xh(this,void 0,void 0,function(){var i,l;return Xl(this,function(a){switch(a.label){case 0:a.trys.push([0,5,6,11]),r=td(t),a.label=1;case 1:return[4,r.next()];case 2:if(n=a.sent(),!!n.done)return[3,4];if(i=n.value,e.next(i),e.closed)return[2];a.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return l=a.sent(),o={error:l},[3,11];case 6:return a.trys.push([6,,9,10]),n&&!n.done&&(s=r.return)?[4,s.call(r)]:[3,8];case 7:a.sent(),a.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function xe(t,e,r,n,o){n===void 0&&(n=0),o===void 0&&(o=!1);var s=e.schedule(function(){r(),o?t.add(this.schedule(null,n)):this.unsubscribe()},n);if(t.add(s),!o)return s}function pu(t,e){return e===void 0&&(e=0),Tt(function(r,n){r.subscribe(St(n,function(o){return xe(n,t,function(){return n.next(o)},e)},function(){return xe(n,t,function(){return n.complete()},e)},function(o){return xe(n,t,function(){return n.error(o)},e)}))})}function gu(t,e){return e===void 0&&(e=0),Tt(function(r,n){n.add(t.schedule(function(){return r.subscribe(n)},e))})}function Id(t,e){return pe(t).pipe(gu(e),pu(e))}function Rd(t,e){return pe(t).pipe(gu(e),pu(e))}function Bd(t,e){return new Mt(function(r){var n=0;return e.schedule(function(){n===t.length?r.complete():(r.next(t[n++]),r.closed||this.schedule())})})}function _d(t,e){return new Mt(function(r){var n;return xe(r,e,function(){n=t[uu](),xe(r,e,function(){var o,s,i;try{o=n.next(),s=o.value,i=o.done}catch(l){r.error(l);return}i?r.complete():r.next(s)},0,!0)}),function(){return kt(n?.return)&&n.return()}})}function yu(t,e){if(!t)throw new Error("Iterable cannot be null");return new Mt(function(r){xe(r,e,function(){var n=t[Symbol.asyncIterator]();xe(r,e,function(){n.next().then(function(o){o.done?r.complete():r.next(o.value)})},0,!0)})})}function Nd(t,e){return yu(fu(t),e)}function Td(t,e){if(t!=null){if(iu(t))return Id(t,e);if(ou(t))return Bd(t,e);if(su(t))return Rd(t,e);if(au(t))return yu(t,e);if(cu(t))return _d(t,e);if(hu(t))return Nd(t,e)}throw lu(t)}function Rn(t,e){return e?Td(t,e):pe(t)}function vu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=yi(t);return Rn(t,r)}var vi=Ro(function(t){return function(){t(this),this.name="EmptyError",this.message="no elements in sequence"}});function bu(t,e){return new Promise(function(r,n){var o=new ro({next:function(s){r(s),o.unsubscribe()},error:n,complete:function(){n(new vi)}});t.subscribe(o)})}function wu(t){return t instanceof Date&&!isNaN(t)}var mu=Ro(function(t){return function(e){e===void 0&&(e=null),t(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=e}});function Eu(t,e){var r=wu(t)?{first:t}:typeof t=="number"?{each:t}:t,n=r.first,o=r.each,s=r.with,i=s===void 0?Ld:s,l=r.scheduler,a=l===void 0?nu:l,u=r.meta,c=u===void 0?null:u;if(n==null&&o==null)throw new TypeError("No timeout provided.");return Tt(function(f,h){var g,p,d=null,y=0,v=function(x){p=xe(h,a,function(){try{g.unsubscribe(),pe(i({meta:c,lastValue:d,seen:y})).subscribe(h)}catch(m){h.error(m)}},x)};g=f.subscribe(St(h,function(x){p?.unsubscribe(),y++,h.next(d=x),o>0&&v(o)},void 0,void 0,function(){p!=null&&p.closed||p==null||p.unsubscribe(),d=null})),!y&&v(n!=null?typeof n=="number"?n:+n-a.now():o)})}function Ld(t){throw new mu(t)}function or(t,e){return Tt(function(r,n){var o=0;r.subscribe(St(n,function(s){n.next(t.call(e,s,o++))}))})}var Cd=Array.isArray;function qd(t,e){return Cd(e)?t.apply(void 0,Zr([],Wr(e))):t(e)}function Ud(t){return or(function(e){return qd(t,e)})}var Pd=Array.isArray,jd=Object.getPrototypeOf,zd=Object.prototype,Dd=Object.keys;function Hd(t){if(t.length===1){var e=t[0];if(Pd(e))return{args:e,keys:null};if(Md(e)){var r=Dd(e);return{args:r.map(function(n){return e[n]}),keys:r}}}return{args:t,keys:null}}function Md(t){return t&&typeof t=="object"&&jd(t)===zd}function Fd(t,e){return t.reduce(function(r,n,o){return r[n]=e[o],r},{})}function Vd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=yi(t),n=wd(t),o=Hd(t),s=o.args,i=o.keys;if(s.length===0)return Rn([],r);var l=new Mt(Kd(s,r,i?function(a){return Fd(i,a)}:Me));return n?l.pipe(Ud(n)):l}function Kd(t,e,r){return r===void 0&&(r=Me),function(n){Ra(e,function(){for(var o=t.length,s=new Array(o),i=o,l=o,a=function(c){Ra(e,function(){var f=Rn(t[c],e),h=!1;f.subscribe(St(n,function(g){s[c]=g,h||(h=!0,l--),l||n.next(r(s.slice()))},function(){--i||n.complete()}))},n)},u=0;u<o;u++)a(u)},n)}}function Ra(t,e,r){t?xe(r,t,e):e()}function Wd(t,e,r,n,o,s,i,l){var a=[],u=0,c=0,f=!1,h=function(){f&&!a.length&&!u&&e.complete()},g=function(d){return u<n?p(d):a.push(d)},p=function(d){u++;var y=!1;pe(r(d,c++)).subscribe(St(e,function(v){e.next(v)},function(){y=!0},void 0,function(){if(y)try{u--;for(var v=function(){var x=a.shift();i?xe(e,i,function(){return p(x)}):p(x)};a.length&&u<n;)v();h()}catch(x){e.error(x)}}))};return t.subscribe(St(e,g,function(){f=!0,h()})),function(){}}function no(t,e,r){return r===void 0&&(r=1/0),kt(e)?no(function(n,o){return or(function(s,i){return e(n,s,o,i)})(pe(t(n,o)))},r):(typeof e=="number"&&(r=e),Tt(function(n,o){return Wd(n,o,t,r)}))}function xu(t){return t===void 0&&(t=1/0),no(Me,t)}function Ba(t,e,r){return t===void 0&&(t=0),r===void 0&&(r=vd),new Mt(function(n){var o=wu(t)?+t-r.now():t;o<0&&(o=0);var s=0;return r.schedule(function(){n.closed||(n.next(s++),n.complete())},o)})}function Zd(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=yi(t),n=md(t,1/0),o=t;return o.length?o.length===1?pe(o[0]):xu(n)(Rn(o,r)):In}function oe(t,e){return Tt(function(r,n){var o=0;r.subscribe(St(n,function(s){return t.call(e,s,o++)&&n.next(s)}))})}function ku(t){return Tt(function(e,r){var n=null,o=!1,s;n=e.subscribe(St(r,void 0,void 0,function(i){s=pe(t(i,ku(t)(e))),n?(n.unsubscribe(),n=null,s.subscribe(r)):o=!0})),o&&(n.unsubscribe(),n=null,s.subscribe(r))})}function Gd(t){return Tt(function(e,r){var n=!1;e.subscribe(St(r,function(o){n=!0,r.next(o)},function(){n||r.next(t),r.complete()}))})}function Yd(t){return t<=0?function(){return In}:Tt(function(e,r){var n=0;e.subscribe(St(r,function(o){++n<=t&&(r.next(o),t<=n&&r.complete())}))})}function Jd(t,e){return Tt(function(r,n){var o=new Set;r.subscribe(St(n,function(s){var i=t?t(s):s;o.has(i)||(o.add(i),n.next(s))})),e&&pe(e).subscribe(St(n,function(){return o.clear()},eo))})}function Xd(t,e){return e===void 0&&(e=Me),t=t??Qd,Tt(function(r,n){var o,s=!0;r.subscribe(St(n,function(i){var l=e(i);(s||!t(o,l))&&(s=!1,o=l,n.next(i))}))})}function Qd(t,e){return t===e}function tp(t){return t===void 0&&(t=ep),Tt(function(e,r){var n=!1;e.subscribe(St(r,function(o){n=!0,r.next(o)},function(){return n?r.complete():r.error(t())}))})}function ep(){return new vi}function Xo(t){return Tt(function(e,r){try{e.subscribe(r)}finally{r.add(t)}})}function Rs(t,e){var r=arguments.length>=2;return function(n){return n.pipe(t?oe(function(o,s){return t(o,s,n)}):Me,Yd(1),r?Gd(e):tp(function(){return new vi}))}}function rp(t,e){return Tt(function(r,n){var o=null,s=0,i=!1,l=function(){return i&&!o&&n.complete()};r.subscribe(St(n,function(a){o?.unsubscribe();var u=0,c=s++;pe(t(a,c)).subscribe(o=St(n,function(f){return n.next(e?e(a,f,c,u++):f)},function(){o=null,l()}))},function(){i=!0,l()}))})}function np(){return rp(Me)}function rn(t){return Tt(function(e,r){pe(t).subscribe(St(r,function(){return r.complete()},eo)),!r.closed&&e.subscribe(r)})}function op(t,e){return Tt(function(r,n){var o=0;r.subscribe(St(n,function(s){var i=t(s,o++);(i||e)&&n.next(s),!i&&n.complete()}))})}function qn(t,e,r){var n=kt(t)||e||r?{next:t,error:e,complete:r}:t;return n?Tt(function(o,s){var i;(i=n.subscribe)===null||i===void 0||i.call(n);var l=!0;o.subscribe(St(s,function(a){var u;(u=n.next)===null||u===void 0||u.call(n,a),s.next(a)},function(){var a;l=!1,(a=n.complete)===null||a===void 0||a.call(n),s.complete()},function(a){var u;l=!1,(u=n.error)===null||u===void 0||u.call(n,a),s.error(a)},function(){var a,u;l&&((a=n.unsubscribe)===null||a===void 0||a.call(n)),(u=n.finalize)===null||u===void 0||u.call(n)}))}):Me}function sp(t){return Jd(({event:e})=>e.id,t)}function ip(t){return no((e,r)=>Rn(t(e,r)).pipe(no(n=>n?vu(e):In)))}function _a(t){return id(Eu(t),ku(e=>{if(e instanceof mu)return In;throw e}))}function Qo(t,e){const{not:r}=Sn(e,{not:!1});return oe(n=>ap(n.subId===t,r))}function ap(t,e){return!t&&e||t&&!e}class lp{constructor(e){H(this,"relay"),H(this,"config"),H(this,"authenticator"),H(this,"ongoings",new Set),H(this,"authResult$",new mt),H(this,"disposed",!1),this.relay=e.relay,this.config=e.config,this.authenticator=e.authenticator;const r=this.relay.getOKObservable().subscribe(o=>{const{eventId:s,ok:i}=o;this.ongoings.has(s)&&(this.ongoings.delete(s),this.authResult$.next(i),i||(r.unsubscribe(),n.unsubscribe()))}),n=this.relay.getAUTHObservable().subscribe(({challenge:o})=>{this.challenge(o)})}getAuthResultObservable(){return this.authResult$.asObservable()}async challenge(e){try{const r=await this.signer.signEvent({kind:22242,content:"",tags:[["relay",this.relay.url],["challenge",e]]});this.ongoings.add(r.id),this.relay.send(["AUTH",r])}catch{}}get signer(){return this.authenticator.signer??this.config.signer}dispose(){this[Symbol.dispose]()}[Symbol.dispose](){if(this.disposed)return;this.disposed=!0;const e=[this.authResult$];for(const r of e)r.complete()}}let $u=class extends hd{constructor(t){super(t??0)}increment(){this.next(this.getValue()+1)}decrement(){this.next(this.getValue()-1)}next(t){typeof t=="number"?super.next(t):super.next(t(this.getValue()))}};class up extends mt{waitNext(){return bu(this.pipe(Rs(null,void 0)))}}class cp{constructor(e){H(this,"relay"),H(this,"authProxy"),H(this,"pubs",new Map),H(this,"authRequiredPubs",new Set),H(this,"count$",new $u(0)),H(this,"ok$",new mt),H(this,"disposed",!1);var r;this.relay=e.relay,this.authProxy=e.authProxy,this.relay.getReconnectedObservable().subscribe(n=>{for(const[o,s]of n)o==="EVENT"&&this.pubs.has(s.id)&&this.sendEVENT(s)}),this.relay.getOKObservable().subscribe(async n=>{const{eventId:o,notice:s}=n;this.pubs.get(o)&&(this.authProxy&&s!=null&&s.startsWith("auth-required:")?(this.authRequiredPubs.add(o),this.ok$.next({...n,done:!1})):(this.ok$.next({...n,done:!0}),this.confirmOK(o)))}),(r=this.authProxy)==null||r.getAuthResultObservable().subscribe(n=>{if(n)for(const o of this.authRequiredPubs){const s=this.pubs.get(o);s&&this.sendEVENT(s)}else for(const o of this.authRequiredPubs)this.confirmOK(o);this.authRequiredPubs.clear()})}async publish(e){if(!this.disposed)return this.pubs.has(e.id)||(this.pubs.set(e.id,e),this.count$.increment()),this.sendEVENT(e)}confirmOK(e){this.disposed||this.pubs.has(e)||(this.pubs.delete(e),this.count$.decrement())}getOkAgainstEventObservable(){return this.ok$.asObservable()}getLogicalConnectionSizeObservable(){return this.count$.asObservable()}dispose(){this[Symbol.dispose]()}[Symbol.dispose](){if(this.disposed)return;this.disposed=!0;const e=[this.count$,this.ok$];for(const r of e)r.complete()}sendEVENT(e){return this.relay.send(["EVENT",e])}}const Na={OPEN:1};class fp{constructor(e,r){H(this,"socket",null),H(this,"buffer",[]),H(this,"unsent",[]),H(this,"reconnected$",new mt),H(this,"outgoing$",new mt),H(this,"message$",new mt),H(this,"error$",new mt),H(this,"retryTimer",null),H(this,"sendAttempted$",new up),H(this,"isFirstTry",!0),H(this,"maybeDown",!1),H(this,"disposed",!1),H(this,"state$",new mt),H(this,"_state","initialized"),this.url=e,this.config=r,r.skipFetchNip11||Qn.getOrFetch(e),this.setState("initialized")}get state(){return this._state}setState(e){this._state=e,this.state$.next(e)}connectManually(){this.connect()}connect(e){if(this.state==="terminated")return;const r=typeof e=="number";(this.state==="initialized"||this.state==="dormant"||this.state==="error"||this.state==="rejected"||r)&&(this.socket=this.createSocket(e??0))}createSocket(e){const r=this.isFirstTry;this.isFirstTry=!1;let n=!1;const o=e>0,s=this.state==="error"||this.state==="rejected";o?this.setState("retrying"):this.setState("connecting");const i=async()=>{if(this.state==="terminated"){c?.close(Ur.RX_NOSTR_DISPOSED);return}this.setState("connected"),n=!0,(o||s)&&(this.reconnected$.next(this.unsent),this.unsent=[]);try{for(const f of this.buffer)this.send(f)}catch(f){this.error$.next(f)}finally{this.buffer=[]}},l=({data:f})=>{if(this.state!=="terminated")try{this.message$.next(this.pack(JSON.parse(f)))}catch(h){this.error$.next(h)}},a=({code:f})=>{var h;if(c?.removeEventListener("open",i),c?.removeEventListener("message",l),c?.removeEventListener("close",a),this.socket===c&&(this.socket=null),this.state==="terminated"||f===Ur.RX_NOSTR_DISPOSED){this.unsent=[],this.buffer=[];return}if(f===Ur.RX_NOSTR_IDLE)this.setState("dormant"),this.buffer.length>0&&this.connect();else if(f===Ur.DONT_RETRY)this.unsent=[],this.buffer=[],this.error$.next(new ma(f)),this.setState("rejected");else{r&&!n&&(this.maybeDown=!0),this.unsent.push(...this.buffer),this.buffer=[],this.error$.next(new ma(f));const g=e+1;this.config.retry.strategy!=="off"&&!(this.config.retry.polite&&this.maybeDown)&&g<=this.config.retry.maxCount?(this.setState("waiting-for-retrying"),(h=this.retryTimer)==null||h.unsubscribe(),this.retryTimer=hp(this.config.retry,g).subscribe(()=>{this.disposed||this.connect(g)})):this.setState("error")}},u=this.config.websocketCtor??globalThis.WebSocket;if(!u)throw new Dn("WebSocket constructor is missing");const c=(()=>{try{return new u(this.url)}catch{return a({code:0}),null}})();return c?.addEventListener("open",i),c?.addEventListener("message",l),c?.addEventListener("close",a),c}pack(e){const r=e[0],n=this.url;switch(r){case"EVENT":return{from:n,type:r,message:e,subId:e[1],event:e[2]};case"EOSE":return{from:n,type:r,message:e,subId:e[1]};case"OK":return{from:n,type:r,message:e,eventId:e[1],ok:e[2],notice:e[3]};case"CLOSED":return{from:n,type:r,message:e,subId:e[1],notice:e[2]};case"NOTICE":return{from:n,type:r,message:e,notice:e[1]};case"AUTH":return{from:n,type:r,message:e,challenge:e[1]};case"COUNT":return{from:n,type:r,message:e,subId:e[1],count:e[2]};default:return{from:n,type:"unknown",message:e}}}disconnect(e){var r;((r=this.socket)==null?void 0:r.readyState)===Na.OPEN&&this.socket.close(e)}send(e){const r=this.sendAttempted$.waitNext();switch(this.state){case"terminated":case"rejected":return this.sendAttempted$.next(),r;case"initialized":case"connecting":case"dormant":return this.buffer.push(e),this.connect(),r;case"connected":{if(!this.socket)throw new Jl;return this.socket.readyState===Na.OPEN?(this.outgoing$.next({to:this.url,message:e}),this.socket.send(JSON.stringify(e)),this.sendAttempted$.next(),r):(this.buffer.push(e),r)}case"waiting-for-retrying":case"retrying":case"error":return this.sendAttempted$.next(),this.unsent.push(e),r}}getEVENTObservable(){return this.message$.pipe(oe(e=>e.type==="EVENT"))}getEOSEObservable(){return this.message$.pipe(oe(e=>e.type==="EOSE"))}getCLOSEDObservable(){return this.message$.pipe(oe(e=>e.type==="CLOSED"))}getOKObservable(){return this.message$.pipe(oe(e=>e.type==="OK"))}getAUTHObservable(){return this.message$.pipe(oe(e=>e.type==="AUTH"))}getAllMessageObservable(){return this.message$.asObservable()}getOutgoingMessageObservable(){return this.outgoing$.asObservable()}getReconnectedObservable(){return this.reconnected$.asObservable()}getConnectionStateObservable(){return this.state$.pipe(Xd(),or(e=>({from:this.url,state:e})))}getErrorObservable(){return this.error$.asObservable()}dispose(){this[Symbol.dispose]()}[Symbol.dispose](){var e,r;if(this.disposed)return;this.disposed=!0,this.setState("terminated"),(e=this.retryTimer)==null||e.unsubscribe(),(r=this.socket)==null||r.close(Ur.RX_NOSTR_DISPOSED),this.socket=null;const n=[this.state$,this.outgoing$,this.message$,this.error$,this.reconnected$,this.sendAttempted$];for(const o of n)o.complete()}}function hp(t,e){switch(t.strategy){case"exponential":{const r=Math.max(t.initialDelay*2**(e-1)+(Math.random()-.5)*1e3,1e3);return Ba(r)}case"immediately":return vu(0);case"linear":return Ba(t.interval);case"off":return In}}const Ur={DONT_RETRY:4e3,RX_NOSTR_IDLE:4537,RX_NOSTR_DISPOSED:4538};class dp{constructor(e){H(this,"relay"),H(this,"authProxy"),H(this,"config"),H(this,"subs",new Map),H(this,"authRequiredSubs",new Set),H(this,"fin$",new mt),H(this,"disposed",!1),H(this,"queue");var r;this.relay=e.relay,this.authProxy=e.authProxy,this.config=e.config,this.queue=new pp(this.relay.url,this.config),this.queue.getActivationObservable().subscribe(n=>{for(const{req:o}of n)this.sendREQ(o)}),this.relay.getReconnectedObservable().subscribe(()=>{for(const{req:n}of this.queue.ongoings)this.sendREQ(n)}),this.relay.getEOSEObservable().subscribe(({subId:n})=>{var o;(o=this.subs.get(n))!=null&&o.autoclose&&this.unsubscribe(n)}),this.relay.getCLOSEDObservable().subscribe(async({subId:n,notice:o})=>{this.subs.get(n)&&(this.authProxy&&o!=null&&o.startsWith("auth-required:")?this.authRequiredSubs.add(n):this.fin(n))}),(r=this.authProxy)==null||r.getAuthResultObservable().subscribe(n=>{var o;if(n)for(const s of this.authRequiredSubs){const i=(o=this.subs.get(s))==null?void 0:o.req;i&&this.sendREQ(i)}else for(const s of this.authRequiredSubs)this.fin(s);this.authRequiredSubs.clear()})}subscribe(e,r){if(this.disposed)return;const n=e[1],o={subId:n,req:e,autoclose:r};this.subs.set(n,o),this.queue.enqueue(o)}unsubscribe(e){this.disposed||(this.subs.has(e)&&this.sendCLOSE(e),this.fin(e))}isOngoingOrQueued(e){return this.subs.has(e)}getEventObservable(){return this.relay.getEVENTObservable().pipe(oe(({subId:e,event:r})=>{var n;const o=(n=this.subs.get(e))==null?void 0:n.filters;return o?this.config.skipValidateFilterMatching||Yh(r,o):!1}))}getFinObservable(){return this.fin$.asObservable()}getLogicalConnectionSizeObservable(){return this.queue.getSizeObservable()}dispose(){this[Symbol.dispose]()}[Symbol.dispose](){if(this.disposed)return;this.disposed=!0;const e=[this.fin$];for(const r of e)r.complete();this.queue.dispose()}sendREQ([,e,...r]){const n=Zh(r),o=this.subs.get(e);o&&(o.filters=n,this.relay.send(["REQ",e,...n]))}sendCLOSE(e){this.relay.send(["CLOSE",e])}fin(e){this.subs.delete(e),this.queue.drop(e),this.fin$.next({from:this.relay.url,subId:e})}}class pp{constructor(e,r){H(this,"_queuings",[]),H(this,"_ongoings",[]),H(this,"activated$",new mt),H(this,"count$",new $u),this.url=e,this.config=r}get queuings(){return this._queuings}set queuings(e){this._queuings=e}get ongoings(){return this._ongoings}set ongoings(e){this._ongoings=e}enqueue(e){this.queuings=[...this.queuings,e],this.count$.increment(),this.shift()}drop(e){const r=(l,a)=>{const u=l.length,c=l.filter(h=>h.subId!==a),f=u-c.length;return[c,f]},[n,o]=r(this.queuings,e),[s,i]=r(this.ongoings,e);this.queuings=n,this.ongoings=s,this.count$.next(l=>l-(o+i)),this.shift()}getActivationObservable(){return this.activated$.asObservable()}getSizeObservable(){return this.count$.asObservable()}dispose(){const e=[this.activated$,this.count$];for(const r of e)r.complete()}async shift(){const e=await this.capacity(),r=[...this.ongoings,...this.queuings],n=r.slice(0,e),o=r.slice(e),s=this.queuings.slice(0,e-this.ongoings.length);this.ongoings=n,this.queuings=o,s.length>0&&this.activated$.next(s)}async capacity(){return await Qn.getValue(this.url,e=>{var r;return(r=e.limitation)==null?void 0:r.max_subscriptions},{skipFetch:this.config.skipFetchNip11})??1/0}}class gp{constructor(e,r){H(this,"relay"),H(this,"pubProxy"),H(this,"subProxy"),H(this,"defaultSubscriptionIds",new Set),H(this,"communicating",!1),H(this,"strategy","lazy"),H(this,"disconnectTimeout"),H(this,"disconnectTimer"),H(this,"isDefaultRelay",!1),H(this,"disposed",!1),H(this,"_url"),this._url=Be(e);const n=yp(e,r),o=new fp(this.url,r),s=n?new lp({relay:o,config:r,authenticator:n}):null,i=new cp({relay:o,authProxy:s}),l=new dp({relay:o,authProxy:s,config:r});this.relay=o,this.pubProxy=i,this.subProxy=l,this.disconnectTimeout=r.disconnectTimeout,Vd([this.pubProxy.getLogicalConnectionSizeObservable(),this.subProxy.getLogicalConnectionSizeObservable()]).pipe(or(([a,u])=>a+u)).subscribe(a=>{this.communicating=a>0,this.resetConnection()})}get url(){return this._url}setConnectionStrategy(e){this.disposed||(this.strategy=e,this.resetConnection())}resetConnection(){let e=this.strategy;switch(this.isDefaultRelay||(e="lazy"),e){case"lazy":{const r=()=>{this.communicating||this.relay.disconnect(Ur.RX_NOSTR_IDLE)};this.disconnectTimeout>0?(this.disconnectTimeout&&(clearTimeout(this.disconnectTimer),this.disconnectTimer=void 0),this.disconnectTimer=setTimeout(r,this.disconnectTimeout)):r();break}case"lazy-keep":break;case"aggressive":{(this.connectionState==="initialized"||this.connectionState==="dormant")&&this.relay.connectManually();break}}}markAsDefault(e){if(!this.disposed){if(this.isDefaultRelay=e,!this.isDefaultRelay){for(const r of this.defaultSubscriptionIds)this.subProxy.unsubscribe(r);this.defaultSubscriptionIds.clear()}this.resetConnection()}}async publish(e){if(!this.disposed)return this.pubProxy.publish(e)}confirmOK(e){this.disposed||this.pubProxy.confirmOK(e)}subscribe(e,r){if(this.disposed)return;const{mode:n,overwrite:o,autoclose:s}=Sn(r??{},{overwrite:!1,autoclose:!1,mode:"default"}),[,i]=e;n==="default"&&!this.isDefaultRelay||!o&&this.subProxy.isOngoingOrQueued(i)||(n==="default"&&this.defaultSubscriptionIds.add(i),this.subProxy.subscribe(e,s))}unsubscribe(e){this.disposed||(this.defaultSubscriptionIds.delete(e),this.subProxy.unsubscribe(e))}getEventObservable(){if(this.disposed)throw new Re;return this.subProxy.getEventObservable()}getFinObservable(){if(this.disposed)throw new Re;return this.subProxy.getFinObservable()}getOkAgainstEventObservable(){if(this.disposed)throw new Re;return this.pubProxy.getOkAgainstEventObservable()}getAllMessageObservable(){if(this.disposed)throw new Re;return this.relay.getAllMessageObservable()}getOutgoingMessageObservable(){if(this.disposed)throw new Re;return this.relay.getOutgoingMessageObservable()}getConnectionStateObservable(){if(this.disposed)throw new Re;return this.relay.getConnectionStateObservable()}get connectionState(){return this.relay.state}getErrorObservable(){if(this.disposed)throw new Re;return this.relay.getErrorObservable().pipe(or(e=>({from:this.url,reason:e})))}connectManually(){this.relay.connectManually()}dispose(){this[Symbol.dispose]()}[Symbol.dispose](){this.disposed||(this.disposed=!0,this.disconnectTimer&&clearTimeout(this.disconnectTimer),this.disconnectTimer=void 0,this.relay.dispose(),this.pubProxy.dispose(),this.subProxy.dispose())}}function yp(t,e){const r=e.authenticator;if(!r)return;const n=r instanceof Function?r(t):r;return n==="auto"?{}:n}function vp(t,e){return t.filter(r=>!e.includes(r))}function bp(t){const{rxReq:e,index:r}=t,{rxReqId:n,strategy:o}=e;return`${n}:${o==="backward"?r:0}`}function wp(t){const{rxReq:e,filters:r,index:n}=t;return["REQ",bp({rxReq:e,index:n}),...r]}function Ta(t){if(Array.isArray(t)){const e=t.map(r=>{let n="",o=!1,s=!1;if(typeof r=="string")n=r,o=!0,s=!0;else if(Array.isArray(r)){const i=r[2];n=r[1],o=!i||i==="read",s=!i||i==="write"}else n=r.url,o=r.read,s=r.write;return{url:n,read:o,write:s}});return Object.fromEntries(e.map(r=>[r.url,r]))}else{const e=Object.entries(t).map(([r,n])=>({url:r,...n}));return Object.fromEntries(e.map(r=>[r.url,r]))}}function La(t,e){const r=new Set;if(e!=null&&e.on){const n=e.on;if(!n.defaultReadRelays&&!n.defaultWriteRelays&&!n.relays)return;const o=t.getDefaultRelays();if(n.defaultReadRelays)for(const{url:s}of Object.values(o).filter(i=>i.read))r.add(s);if(n.defaultWriteRelays)for(const{url:s}of Object.values(o).filter(i=>i.write))r.add(s);if(n.relays)for(const s of n.relays)r.add(Be(s));return[...r]}else if(e!=null&&e.relays){for(const n of e.relays)r.add(Be(n));return[...r]}else return}function mp(t){return new Ep(Wh(t??{}))}class Ep{constructor(e){H(this,"connections",new Hr),H(this,"defaultRelays",new Hr),H(this,"defaultSubscriptions",new Map),H(this,"event$",new mt),H(this,"fin$",new mt),H(this,"ok$",new mt),H(this,"all$",new mt),H(this,"error$",new mt),H(this,"connectionState$",new mt),H(this,"outgoing$",new mt),H(this,"dispose$",new mt),H(this,"disposed",!1),this.config=e}get defaultReadables(){const e=[];for(const{url:r,read:n}of this.defaultRelays.values()){const o=this.connections.get(r);n&&o&&e.push(o)}return e}get defaultWritables(){const e=[];for(const{url:r,write:n}of this.defaultRelays.values()){const o=this.connections.get(r);n&&o&&e.push(o)}return e}getDefaultRelays(){if(this.disposed)throw new Re;return this.defaultRelays.toObject()}getDefaultRelay(e){return this.defaultRelays.get(e)}setDefaultRelays(e){if(this.disposed)throw new Re;const r=new Hr(Ta(e)),n=[];for(const{read:o,url:s}of r.values()){const i=this.ensureNostrConnection(s);i.setConnectionStrategy(this.config.connectionStrategy),o&&n.push(i)}this.updateDefaultSubscriptions(n),this.defaultRelays=r}ensureNostrConnection(e){let r=this.connections.get(e);return r||(r=new gp(e,this.config),this.attachNostrConnection(r),this.connections.set(e,r),r)}attachNostrConnection(e){e.getEventObservable().subscribe(this.event$),e.getFinObservable().subscribe(this.fin$),e.getOkAgainstEventObservable().subscribe(this.ok$),e.getAllMessageObservable().subscribe(this.all$),e.getConnectionStateObservable().subscribe(this.connectionState$),e.getErrorObservable().subscribe(this.error$),e.getOutgoingMessageObservable().subscribe(this.outgoing$)}updateDefaultSubscriptions(e){const r=vp(this.defaultReadables,e);for(const n of r)n.markAsDefault(!1);for(const n of e){n.markAsDefault(!0);for(const{req:o,autoclose:s}of this.defaultSubscriptions.values())n?.subscribe(o,{mode:"default",overwrite:!1,autoclose:s})}}addDefaultRelays(e){const r=Ta(e);this.setDefaultRelays({...this.defaultRelays.toObject(),...r})}removeDefaultRelays(e){const r=this.defaultRelays.copy(),n=Array.isArray(e)?e:[e];for(const o of n)r.delete(o);this.setDefaultRelays(r.toObject())}getAllRelayStatus(){return Object.fromEntries(Array.from(this.connections.values()).map(e=>[e.url,{connection:e.connectionState}]))}getRelayStatus(e){const r=this.connections.get(e);if(r)return{connection:r.connectionState}}reconnect(e){const r=this.getDefaultRelay(e);if(!r)throw new Dn(`The relay (${e}) is not a default relay. \`reconnect()\` can be used only for a readable default relay.`);if(!r.read)throw new Dn(`The relay (${e}) is not readable. \`reconnect()\` can be used only for a readable default relay.`);const n=this.connections.get(e);if(!n)throw new Jl;(n.connectionState==="error"||n.connectionState==="rejected")&&n.connectManually()}use(e,r){const n=La(this,r),o=({filters:c,relays:f},h)=>{var g;const p=e.strategy==="backward"?f:void 0,d=wp({rxReq:e,filters:c,index:h});return{subId:d[1],req:d,targetConnections:((g=p??n)==null?void 0:g.map(y=>this.ensureNostrConnection(y)))??this.defaultReadables,mode:p===void 0&&n===void 0?"default":"temporary"}},s=({req:c,targetConnections:f,mode:h})=>{this.startSubscription({req:c,targetConnections:f,mode:h,overwrite:e.strategy==="forward",autoclose:e.strategy==="backward"})},i=({subId:c,targetConnections:f,mode:h})=>{this.teardownSubscription({subId:c,targetConnections:f,mode:h})},l=({req:c,targetConnections:f})=>e.strategy==="forward"?this.createForwardEventObservable({req:c}).pipe(rn(this.dispose$)):this.createBackwardEventObservable({req:c,targetConnections:f}).pipe(rn(this.dispose$)),a=e.getReqPacketObservable().pipe(oe(({filters:c})=>c.length>0),or(o),rn(this.dispose$)),u=()=>ip(async({event:c})=>(this.config.skipVerify||await this.config.verifier(c))&&(this.config.skipExpirationCheck||!Jh(c)));if(e.strategy==="forward"){let c;return a.pipe(qn(f=>{c=f}),qn(s),or(l),Xo(()=>{c&&i(c)}),np(),u())}else return a.pipe(qn(s),or(c=>l(c).pipe(Xo(()=>{i(c)}))),xu(),u())}createForwardEventObservable(e){const{req:r}=e,n=r[1];return this.event$.pipe(Qo(n))}createBackwardEventObservable(e){const{req:r,targetConnections:n}=e,o=r[1],s=new Set,i=c=>c==="error"||c==="rejected"||c==="terminated",l=()=>n.every(({connectionState:c,url:f})=>i(c)||s.has(f)),a=this.fin$.pipe(Qo(o),qn(({from:c})=>{s.add(c)})),u=Zd(a,this.connectionState$.asObservable()).pipe(oe(()=>l()),Rs(null,void 0));return this.event$.pipe(rn(u),_a(this.config.eoseTimeout),Qo(o),oe(c=>!s.has(c.from)))}startSubscription(e){const{req:r,targetConnections:n,mode:o,overwrite:s,autoclose:i}=e,l=r[1];o==="default"&&this.defaultSubscriptions.set(l,{req:r,autoclose:i});for(const a of n)a.subscribe(r,{mode:o,overwrite:s,autoclose:i})}teardownSubscription(e){const{subId:r,targetConnections:n,mode:o}=e;o==="default"&&this.defaultSubscriptions.delete(r);for(const s of n)s.unsubscribe(r)}createAllEventObservable(){return this.event$.asObservable()}createAllErrorObservable(){return this.error$.asObservable()}createAllMessageObservable(){return this.all$.asObservable()}createConnectionStateObservable(){return this.connectionState$.asObservable()}createOutgoingMessageObservable(){return this.outgoing$.asObservable()}send(e,r){const{signer:n,errorOnTimeout:o,completeOn:s}=Sn(r??{},{signer:this.config.signer,errorOnTimeout:!1,completeOn:"all-ok"}),i=La(this,r),l=i===void 0?this.defaultWritables:i.map(g=>this.ensureNostrConnection(g)),a=new mt,u=new Set;let c="";const f=()=>{a.closed||a.complete();for(const g of l)g.confirmOK(c)};n.signEvent(e).then(async g=>{a.closed||(c=g.id,this.ok$.pipe(oe(({eventId:p})=>p===g.id)).subscribe(a),await Promise.all(l.map(p=>p.publish(g))),s==="sent"&&a.complete())}).catch(g=>{throw f(),new Dn(g instanceof Error?g.message:"Failed to sign the given event")});const h=(()=>{switch(s){case"sent":return Me;case"all-ok":return op(({from:g,done:p})=>(p&&u.add(g),u.size<l.length),!0);case"any-ok":return Rs(g=>g.ok)}})();return a.pipe(h,rn(this.dispose$),o?Eu(this.config.okTimeout):_a(this.config.okTimeout),Xo(f))}async cast(e,r){await bu(this.send(e,{...r,completeOn:"sent"}))}dispose(){this[Symbol.dispose]()}[Symbol.dispose](){if(this.disposed)return;this.disposed=!0;for(const r of this.connections.values())r.dispose();this.connections.clear();const e=[this.event$,this.ok$,this.fin$,this.all$,this.connectionState$,this.error$,this.outgoing$];for(const r of e)r.complete();this.dispose$.next(),this.dispose$.complete()}}const Au=t=>{const{strategy:e}=t,r=t.operators??[],n=t.rxReqId??kp(),o=t.subject??new mt;return{strategy:e,rxReqId:n,getReqPacketObservable(){return o.pipe(...r)},pipe(...s){return Au({strategy:e,rxReqId:n,operators:[...r,...s],subject:o})},emit(s,i){o.next({filters:Ap(s),...i??{}})},over(){o.complete()}}};function xp(t){return Au({strategy:"backward",rxReqId:t})}function kp(){return`${Math.floor(Math.random()*1e6)}`}function $p(t){var e,r;const n={},o=s=>/^#[a-zA-Z]$/.test(s);for(const s of Object.keys(t)){if(s==="limit"&&(t[s]??-1)>=0){n[s]=t[s];continue}if(s==="since"||s==="until"){const i=t[s];if(typeof i!="number"||(i??-1)>=0){n[s]=i;continue}}if((o(s)||s==="ids"||s==="authors")&&t[s]!==void 0&&(((e=t[s])==null?void 0:e.length)??-1)>0){n[s]=t[s];continue}if(s==="kinds"&&t[s]!==void 0&&(((r=t[s])==null?void 0:r.length)??-1)>0){n[s]=t[s];continue}if(s==="search"&&t[s]!==void 0){n[s]=t[s];continue}}return typeof n.since!="number"||typeof n.until!="number"||n.since<=n.until?n:null}function Ap(t){return(Array.isArray(t)?t:[t]).map(e=>$p(e)).filter(e=>e!==null)}function Ca(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Su(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function Sp(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ca(t.outputLen),Ca(t.blockLen)}function oo(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Op(t,e){Su(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const ts=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ou=t=>t instanceof Uint8Array,es=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ge=(t,e)=>t<<32-e|t>>>e,Ip=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ip)throw new Error("Non little-endian hardware is not supported");function Rp(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function bi(t){if(typeof t=="string"&&(t=Rp(t)),!Ou(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function Bp(...t){const e=new Uint8Array(t.reduce((n,o)=>n+o.length,0));let r=0;return t.forEach(n=>{if(!Ou(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}let Iu=class{clone(){return this._cloneInto()}};function _p(t){const e=n=>t().update(bi(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Ru(t=32){if(ts&&typeof ts.getRandomValues=="function")return ts.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Np(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const o=BigInt(32),s=BigInt(4294967295),i=Number(r>>o&s),l=Number(r&s),a=n?4:0,u=n?0:4;t.setUint32(e+a,i,n),t.setUint32(e+u,l,n)}let Tp=class extends Iu{constructor(t,e,r,n){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=es(this.buffer)}update(t){oo(this);const{view:e,buffer:r,blockLen:n}=this;t=bi(t);const o=t.length;for(let s=0;s<o;){const i=Math.min(n-this.pos,o-s);if(i===n){const l=es(t);for(;n<=o-s;s+=n)this.process(l,s);continue}r.set(t.subarray(s,s+i),this.pos),this.pos+=i,s+=i,this.pos===n&&(this.process(e,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){oo(this),Op(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:o}=this;let{pos:s}=this;e[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>n-s&&(this.process(r,0),s=0);for(let c=s;c<n;c++)e[c]=0;Np(r,n-8,BigInt(this.length*8),o),this.process(r,0);const i=es(t),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const a=l/4,u=this.get();if(a>u.length)throw new Error("_sha2: outputLen bigger than state");for(let c=0;c<a;c++)i.setUint32(4*c,u[c],o)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:o,destroyed:s,pos:i}=this;return t.length=n,t.pos=i,t.finished=o,t.destroyed=s,n%e&&t.buffer.set(r),t}};const Lp=(t,e,r)=>t&e^~t&r,Cp=(t,e,r)=>t&e^t&r^e&r,qp=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ze=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ge=new Uint32Array(64);let Up=class extends Tp{constructor(){super(64,32,8,!1),this.A=Ze[0]|0,this.B=Ze[1]|0,this.C=Ze[2]|0,this.D=Ze[3]|0,this.E=Ze[4]|0,this.F=Ze[5]|0,this.G=Ze[6]|0,this.H=Ze[7]|0}get(){const{A:t,B:e,C:r,D:n,E:o,F:s,G:i,H:l}=this;return[t,e,r,n,o,s,i,l]}set(t,e,r,n,o,s,i,l){this.A=t|0,this.B=e|0,this.C=r|0,this.D=n|0,this.E=o|0,this.F=s|0,this.G=i|0,this.H=l|0}process(t,e){for(let c=0;c<16;c++,e+=4)Ge[c]=t.getUint32(e,!1);for(let c=16;c<64;c++){const f=Ge[c-15],h=Ge[c-2],g=ge(f,7)^ge(f,18)^f>>>3,p=ge(h,17)^ge(h,19)^h>>>10;Ge[c]=p+Ge[c-7]+g+Ge[c-16]|0}let{A:r,B:n,C:o,D:s,E:i,F:l,G:a,H:u}=this;for(let c=0;c<64;c++){const f=ge(i,6)^ge(i,11)^ge(i,25),h=u+f+Lp(i,l,a)+qp[c]+Ge[c]|0,g=(ge(r,2)^ge(r,13)^ge(r,22))+Cp(r,n,o)|0;u=a,a=l,l=i,i=s+h|0,s=o,o=n,n=r,r=h+g|0}r=r+this.A|0,n=n+this.B|0,o=o+this.C|0,s=s+this.D|0,i=i+this.E|0,l=l+this.F|0,a=a+this.G|0,u=u+this.H|0,this.set(r,n,o,s,i,l,a,u)}roundClean(){Ge.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Bs=_p(()=>new Up);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Bu=BigInt(0),Bo=BigInt(1),Pp=BigInt(2),_o=t=>t instanceof Uint8Array,jp=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Gr(t){if(!_o(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=jp[t[r]];return e}function _u(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function wi(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}function Yr(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){const o=n*2,s=t.slice(o,o+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");r[n]=i}return r}function zt(t){return wi(Gr(t))}function mi(t){if(!_o(t))throw new Error("Uint8Array expected");return wi(Gr(Uint8Array.from(t).reverse()))}function cr(t,e){return Yr(t.toString(16).padStart(e*2,"0"))}function Ei(t,e){return cr(t,e).reverse()}function zp(t){return Yr(_u(t))}function Ct(t,e,r){let n;if(typeof e=="string")try{n=Yr(e)}catch(s){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${s}`)}else if(_o(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const o=n.length;if(typeof r=="number"&&o!==r)throw new Error(`${t} expected ${r} bytes, got ${o}`);return n}function Sr(...t){const e=new Uint8Array(t.reduce((n,o)=>n+o.length,0));let r=0;return t.forEach(n=>{if(!_o(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}function Dp(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function Hp(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Mp(t){let e;for(e=0;t>Bu;t>>=Bo,e+=1);return e}function Fp(t,e){return t>>BigInt(e)&Bo}const Vp=(t,e,r)=>t|(r?Bo:Bu)<<BigInt(e),xi=t=>(Pp<<BigInt(t-1))-Bo,rs=t=>new Uint8Array(t),qa=t=>Uint8Array.from(t);function Nu(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=rs(t),o=rs(t),s=0;const i=()=>{n.fill(1),o.fill(0),s=0},l=(...c)=>r(o,n,...c),a=(c=rs())=>{o=l(qa([0]),c),n=l(),c.length!==0&&(o=l(qa([1]),c),n=l())},u=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let c=0;const f=[];for(;c<e;){n=l();const h=n.slice();f.push(h),c+=n.length}return Sr(...f)};return(c,f)=>{i(),a(c);let h;for(;!(h=f(u()));)a();return i(),h}}const Kp={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||t instanceof Uint8Array,isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Bn(t,e,r={}){const n=(o,s,i)=>{const l=Kp[s];if(typeof l!="function")throw new Error(`Invalid validator "${s}", expected function`);const a=t[o];if(!(i&&a===void 0)&&!l(a,t))throw new Error(`Invalid param ${String(o)}=${a} (${typeof a}), expected ${s}`)};for(const[o,s]of Object.entries(e))n(o,s,!1);for(const[o,s]of Object.entries(r))n(o,s,!0);return t}const Wp=Object.freeze(Object.defineProperty({__proto__:null,bitGet:Fp,bitLen:Mp,bitMask:xi,bitSet:Vp,bytesToHex:Gr,bytesToNumberBE:zt,bytesToNumberLE:mi,concatBytes:Sr,createHmacDrbg:Nu,ensureBytes:Ct,equalBytes:Dp,hexToBytes:Yr,hexToNumber:wi,numberToBytesBE:cr,numberToBytesLE:Ei,numberToHexUnpadded:_u,numberToVarBytesBE:zp,utf8ToBytes:Hp,validateObject:Bn},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const It=BigInt(0),Et=BigInt(1),gr=BigInt(2),Zp=BigInt(3),_s=BigInt(4),Ua=BigInt(5),Pa=BigInt(8);BigInt(9);BigInt(16);function _t(t,e){const r=t%e;return r>=It?r:e+r}function Gp(t,e,r){if(r<=It||e<It)throw new Error("Expected power/modulo > 0");if(r===Et)return It;let n=Et;for(;e>It;)e&Et&&(n=n*t%r),t=t*t%r,e>>=Et;return n}function Xt(t,e,r){let n=t;for(;e-- >It;)n*=n,n%=r;return n}function Ns(t,e){if(t===It||e<=It)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=_t(t,e),n=e,o=It,s=Et;for(;r!==It;){const i=n/r,l=n%r,a=o-s*i;n=r,r=l,o=s,s=a}if(n!==Et)throw new Error("invert: does not exist");return _t(o,e)}function Yp(t){const e=(t-Et)/gr;let r,n,o;for(r=t-Et,n=0;r%gr===It;r/=gr,n++);for(o=gr;o<t&&Gp(o,e,t)!==t-Et;o++);if(n===1){const i=(t+Et)/_s;return function(l,a){const u=l.pow(a,i);if(!l.eql(l.sqr(u),a))throw new Error("Cannot find square root");return u}}const s=(r+Et)/gr;return function(i,l){if(i.pow(l,e)===i.neg(i.ONE))throw new Error("Cannot find square root");let a=n,u=i.pow(i.mul(i.ONE,o),r),c=i.pow(l,s),f=i.pow(l,r);for(;!i.eql(f,i.ONE);){if(i.eql(f,i.ZERO))return i.ZERO;let h=1;for(let p=i.sqr(f);h<a&&!i.eql(p,i.ONE);h++)p=i.sqr(p);const g=i.pow(u,Et<<BigInt(a-h-1));u=i.sqr(g),c=i.mul(c,g),f=i.mul(f,u),a=h}return c}}function Jp(t){if(t%_s===Zp){const e=(t+Et)/_s;return function(r,n){const o=r.pow(n,e);if(!r.eql(r.sqr(o),n))throw new Error("Cannot find square root");return o}}if(t%Pa===Ua){const e=(t-Ua)/Pa;return function(r,n){const o=r.mul(n,gr),s=r.pow(o,e),i=r.mul(n,s),l=r.mul(r.mul(i,gr),s),a=r.mul(i,r.sub(l,r.ONE));if(!r.eql(r.sqr(a),n))throw new Error("Cannot find square root");return a}}return Yp(t)}const Xp=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Qp(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Xp.reduce((n,o)=>(n[o]="function",n),e);return Bn(t,r)}function tg(t,e,r){if(r<It)throw new Error("Expected power > 0");if(r===It)return t.ONE;if(r===Et)return e;let n=t.ONE,o=e;for(;r>It;)r&Et&&(n=t.mul(n,o)),o=t.sqr(o),r>>=Et;return n}function eg(t,e){const r=new Array(e.length),n=e.reduce((s,i,l)=>t.is0(i)?s:(r[l]=s,t.mul(s,i)),t.ONE),o=t.inv(n);return e.reduceRight((s,i,l)=>t.is0(i)?s:(r[l]=t.mul(s,r[l]),t.mul(s,i)),o),r}function Tu(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function rg(t,e,r=!1,n={}){if(t<=It)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:o,nByteLength:s}=Tu(t,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");const i=Jp(t),l=Object.freeze({ORDER:t,BITS:o,BYTES:s,MASK:xi(o),ZERO:It,ONE:Et,create:a=>_t(a,t),isValid:a=>{if(typeof a!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof a}`);return It<=a&&a<t},is0:a=>a===It,isOdd:a=>(a&Et)===Et,neg:a=>_t(-a,t),eql:(a,u)=>a===u,sqr:a=>_t(a*a,t),add:(a,u)=>_t(a+u,t),sub:(a,u)=>_t(a-u,t),mul:(a,u)=>_t(a*u,t),pow:(a,u)=>tg(l,a,u),div:(a,u)=>_t(a*Ns(u,t),t),sqrN:a=>a*a,addN:(a,u)=>a+u,subN:(a,u)=>a-u,mulN:(a,u)=>a*u,inv:a=>Ns(a,t),sqrt:n.sqrt||(a=>i(l,a)),invertBatch:a=>eg(l,a),cmov:(a,u,c)=>c?u:a,toBytes:a=>r?Ei(a,s):cr(a,s),fromBytes:a=>{if(a.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${a.length}`);return r?mi(a):zt(a)}});return Object.freeze(l)}function Lu(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function Cu(t){const e=Lu(t);return e+Math.ceil(e/2)}function ng(t,e,r=!1){const n=t.length,o=Lu(e),s=Cu(e);if(n<16||n<s||n>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${n}`);const i=r?zt(t):mi(t),l=_t(i,e-Et)+Et;return r?Ei(l,o):cr(l,o)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const og=BigInt(0),ns=BigInt(1);function sg(t,e){const r=(o,s)=>{const i=s.negate();return o?i:s},n=o=>{const s=Math.ceil(e/o)+1,i=2**(o-1);return{windows:s,windowSize:i}};return{constTimeNegate:r,unsafeLadder(o,s){let i=t.ZERO,l=o;for(;s>og;)s&ns&&(i=i.add(l)),l=l.double(),s>>=ns;return i},precomputeWindow(o,s){const{windows:i,windowSize:l}=n(s),a=[];let u=o,c=u;for(let f=0;f<i;f++){c=u,a.push(c);for(let h=1;h<l;h++)c=c.add(u),a.push(c);u=c.double()}return a},wNAF(o,s,i){const{windows:l,windowSize:a}=n(o);let u=t.ZERO,c=t.BASE;const f=BigInt(2**o-1),h=2**o,g=BigInt(o);for(let p=0;p<l;p++){const d=p*a;let y=Number(i&f);i>>=g,y>a&&(y-=h,i+=ns);const v=d,x=d+Math.abs(y)-1,m=p%2!==0,R=y<0;y===0?c=c.add(r(m,s[v])):u=u.add(r(R,s[x]))}return{p:u,f:c}},wNAFCached(o,s,i,l){const a=o._WINDOW_SIZE||1;let u=s.get(o);return u||(u=this.precomputeWindow(o,a),a!==1&&s.set(o,l(u))),this.wNAF(a,u,i)}}}function qu(t){return Qp(t.Fp),Bn(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Tu(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function ig(t){const e=qu(t);Bn(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:o}=e;if(r){if(!n.eql(o,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:ag,hexToBytes:lg}=Wp,vr={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){const{Err:e}=vr;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:ag(n),l:t.subarray(r+2)}},toSig(t){const{Err:e}=vr,r=typeof t=="string"?lg(t):t;if(!(r instanceof Uint8Array))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:o,l:s}=vr._parseInt(r.subarray(2)),{d:i,l}=vr._parseInt(s);if(l.length)throw new e("Invalid signature: left bytes after parsing");return{r:o,s:i}},hexFromSig(t){const e=u=>Number.parseInt(u[0],16)&8?"00"+u:u,r=u=>{const c=u.toString(16);return c.length&1?`0${c}`:c},n=e(r(t.s)),o=e(r(t.r)),s=n.length/2,i=o.length/2,l=r(s),a=r(i);return`30${r(i+s+4)}02${a}${o}02${l}${n}`}},_e=BigInt(0),re=BigInt(1);BigInt(2);const ja=BigInt(3);BigInt(4);function ug(t){const e=ig(t),{Fp:r}=e,n=e.toBytes||((p,d,y)=>{const v=d.toAffine();return Sr(Uint8Array.from([4]),r.toBytes(v.x),r.toBytes(v.y))}),o=e.fromBytes||(p=>{const d=p.subarray(1),y=r.fromBytes(d.subarray(0,r.BYTES)),v=r.fromBytes(d.subarray(r.BYTES,2*r.BYTES));return{x:y,y:v}});function s(p){const{a:d,b:y}=e,v=r.sqr(p),x=r.mul(v,p);return r.add(r.add(x,r.mul(p,d)),y)}if(!r.eql(r.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function i(p){return typeof p=="bigint"&&_e<p&&p<e.n}function l(p){if(!i(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function a(p){const{allowedPrivateKeyLengths:d,nByteLength:y,wrapPrivateKey:v,n:x}=e;if(d&&typeof p!="bigint"){if(p instanceof Uint8Array&&(p=Gr(p)),typeof p!="string"||!d.includes(p.length))throw new Error("Invalid key");p=p.padStart(y*2,"0")}let m;try{m=typeof p=="bigint"?p:zt(Ct("private key",p,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof p}`)}return v&&(m=_t(m,x)),l(m),m}const u=new Map;function c(p){if(!(p instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(d,y,v){if(this.px=d,this.py=y,this.pz=v,d==null||!r.isValid(d))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(v==null||!r.isValid(v))throw new Error("z required")}static fromAffine(d){const{x:y,y:v}=d||{};if(!d||!r.isValid(y)||!r.isValid(v))throw new Error("invalid affine point");if(d instanceof f)throw new Error("projective point not allowed");const x=m=>r.eql(m,r.ZERO);return x(y)&&x(v)?f.ZERO:new f(y,v,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){const y=r.invertBatch(d.map(v=>v.pz));return d.map((v,x)=>v.toAffine(y[x])).map(f.fromAffine)}static fromHex(d){const y=f.fromAffine(o(Ct("pointHex",d)));return y.assertValidity(),y}static fromPrivateKey(d){return f.BASE.multiply(a(d))}_setWindowSize(d){this._WINDOW_SIZE=d,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:d,y}=this.toAffine();if(!r.isValid(d)||!r.isValid(y))throw new Error("bad point: x or y not FE");const v=r.sqr(y),x=s(d);if(!r.eql(v,x))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:d}=this.toAffine();if(r.isOdd)return!r.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){c(d);const{px:y,py:v,pz:x}=this,{px:m,py:R,pz:I}=d,w=r.eql(r.mul(y,I),r.mul(m,x)),S=r.eql(r.mul(v,I),r.mul(R,x));return w&&S}negate(){return new f(this.px,r.neg(this.py),this.pz)}double(){const{a:d,b:y}=e,v=r.mul(y,ja),{px:x,py:m,pz:R}=this;let I=r.ZERO,w=r.ZERO,S=r.ZERO,_=r.mul(x,x),T=r.mul(m,m),$=r.mul(R,R),B=r.mul(x,m);return B=r.add(B,B),S=r.mul(x,R),S=r.add(S,S),I=r.mul(d,S),w=r.mul(v,$),w=r.add(I,w),I=r.sub(T,w),w=r.add(T,w),w=r.mul(I,w),I=r.mul(B,I),S=r.mul(v,S),$=r.mul(d,$),B=r.sub(_,$),B=r.mul(d,B),B=r.add(B,S),S=r.add(_,_),_=r.add(S,_),_=r.add(_,$),_=r.mul(_,B),w=r.add(w,_),$=r.mul(m,R),$=r.add($,$),_=r.mul($,B),I=r.sub(I,_),S=r.mul($,T),S=r.add(S,S),S=r.add(S,S),new f(I,w,S)}add(d){c(d);const{px:y,py:v,pz:x}=this,{px:m,py:R,pz:I}=d;let w=r.ZERO,S=r.ZERO,_=r.ZERO;const T=e.a,$=r.mul(e.b,ja);let B=r.mul(y,m),P=r.mul(v,R),U=r.mul(x,I),z=r.add(y,v),b=r.add(m,R);z=r.mul(z,b),b=r.add(B,P),z=r.sub(z,b),b=r.add(y,x);let E=r.add(m,I);return b=r.mul(b,E),E=r.add(B,U),b=r.sub(b,E),E=r.add(v,x),w=r.add(R,I),E=r.mul(E,w),w=r.add(P,U),E=r.sub(E,w),_=r.mul(T,b),w=r.mul($,U),_=r.add(w,_),w=r.sub(P,_),_=r.add(P,_),S=r.mul(w,_),P=r.add(B,B),P=r.add(P,B),U=r.mul(T,U),b=r.mul($,b),P=r.add(P,U),U=r.sub(B,U),U=r.mul(T,U),b=r.add(b,U),B=r.mul(P,b),S=r.add(S,B),B=r.mul(E,b),w=r.mul(z,w),w=r.sub(w,B),B=r.mul(z,P),_=r.mul(E,_),_=r.add(_,B),new f(w,S,_)}subtract(d){return this.add(d.negate())}is0(){return this.equals(f.ZERO)}wNAF(d){return g.wNAFCached(this,u,d,y=>{const v=r.invertBatch(y.map(x=>x.pz));return y.map((x,m)=>x.toAffine(v[m])).map(f.fromAffine)})}multiplyUnsafe(d){const y=f.ZERO;if(d===_e)return y;if(l(d),d===re)return this;const{endo:v}=e;if(!v)return g.unsafeLadder(this,d);let{k1neg:x,k1:m,k2neg:R,k2:I}=v.splitScalar(d),w=y,S=y,_=this;for(;m>_e||I>_e;)m&re&&(w=w.add(_)),I&re&&(S=S.add(_)),_=_.double(),m>>=re,I>>=re;return x&&(w=w.negate()),R&&(S=S.negate()),S=new f(r.mul(S.px,v.beta),S.py,S.pz),w.add(S)}multiply(d){l(d);let y=d,v,x;const{endo:m}=e;if(m){const{k1neg:R,k1:I,k2neg:w,k2:S}=m.splitScalar(y);let{p:_,f:T}=this.wNAF(I),{p:$,f:B}=this.wNAF(S);_=g.constTimeNegate(R,_),$=g.constTimeNegate(w,$),$=new f(r.mul($.px,m.beta),$.py,$.pz),v=_.add($),x=T.add(B)}else{const{p:R,f:I}=this.wNAF(y);v=R,x=I}return f.normalizeZ([v,x])[0]}multiplyAndAddUnsafe(d,y,v){const x=f.BASE,m=(I,w)=>w===_e||w===re||!I.equals(x)?I.multiplyUnsafe(w):I.multiply(w),R=m(this,y).add(m(d,v));return R.is0()?void 0:R}toAffine(d){const{px:y,py:v,pz:x}=this,m=this.is0();d==null&&(d=m?r.ONE:r.inv(x));const R=r.mul(y,d),I=r.mul(v,d),w=r.mul(x,d);if(m)return{x:r.ZERO,y:r.ZERO};if(!r.eql(w,r.ONE))throw new Error("invZ was invalid");return{x:R,y:I}}isTorsionFree(){const{h:d,isTorsionFree:y}=e;if(d===re)return!0;if(y)return y(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:d,clearCofactor:y}=e;return d===re?this:y?y(f,this):this.multiplyUnsafe(e.h)}toRawBytes(d=!0){return this.assertValidity(),n(f,this,d)}toHex(d=!0){return Gr(this.toRawBytes(d))}}f.BASE=new f(e.Gx,e.Gy,r.ONE),f.ZERO=new f(r.ZERO,r.ONE,r.ZERO);const h=e.nBitLength,g=sg(f,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:f,normPrivateKeyToScalar:a,weierstrassEquation:s,isWithinCurveOrder:i}}function cg(t){const e=qu(t);return Bn(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function fg(t){const e=cg(t),{Fp:r,n}=e,o=r.BYTES+1,s=2*r.BYTES+1;function i(b){return _e<b&&b<r.ORDER}function l(b){return _t(b,n)}function a(b){return Ns(b,n)}const{ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:f,isWithinCurveOrder:h}=ug({...e,toBytes(b,E,O){const A=E.toAffine(),N=r.toBytes(A.x),L=Sr;return O?L(Uint8Array.from([E.hasEvenY()?2:3]),N):L(Uint8Array.from([4]),N,r.toBytes(A.y))},fromBytes(b){const E=b.length,O=b[0],A=b.subarray(1);if(E===o&&(O===2||O===3)){const N=zt(A);if(!i(N))throw new Error("Point is not on curve");const L=f(N);let C=r.sqrt(L);const M=(C&re)===re;return(O&1)===1!==M&&(C=r.neg(C)),{x:N,y:C}}else if(E===s&&O===4){const N=r.fromBytes(A.subarray(0,r.BYTES)),L=r.fromBytes(A.subarray(r.BYTES,2*r.BYTES));return{x:N,y:L}}else throw new Error(`Point of length ${E} was invalid. Expected ${o} compressed bytes or ${s} uncompressed bytes`)}}),g=b=>Gr(cr(b,e.nByteLength));function p(b){const E=n>>re;return b>E}function d(b){return p(b)?l(-b):b}const y=(b,E,O)=>zt(b.slice(E,O));class v{constructor(E,O,A){this.r=E,this.s=O,this.recovery=A,this.assertValidity()}static fromCompact(E){const O=e.nByteLength;return E=Ct("compactSignature",E,O*2),new v(y(E,0,O),y(E,O,2*O))}static fromDER(E){const{r:O,s:A}=vr.toSig(Ct("DER",E));return new v(O,A)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(E){return new v(this.r,this.s,E)}recoverPublicKey(E){const{r:O,s:A,recovery:N}=this,L=S(Ct("msgHash",E));if(N==null||![0,1,2,3].includes(N))throw new Error("recovery id invalid");const C=N===2||N===3?O+e.n:O;if(C>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const M=(N&1)===0?"02":"03",Y=u.fromHex(M+g(C)),lt=a(C),bt=l(-L*lt),pt=l(A*lt),wt=u.BASE.multiplyAndAddUnsafe(Y,bt,pt);if(!wt)throw new Error("point at infinify");return wt.assertValidity(),wt}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new v(this.r,l(-this.s),this.recovery):this}toDERRawBytes(){return Yr(this.toDERHex())}toDERHex(){return vr.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Yr(this.toCompactHex())}toCompactHex(){return g(this.r)+g(this.s)}}const x={isValidPrivateKey(b){try{return c(b),!0}catch{return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{const b=Cu(e.n);return ng(e.randomBytes(b),e.n)},precompute(b=8,E=u.BASE){return E._setWindowSize(b),E.multiply(BigInt(3)),E}};function m(b,E=!0){return u.fromPrivateKey(b).toRawBytes(E)}function R(b){const E=b instanceof Uint8Array,O=typeof b=="string",A=(E||O)&&b.length;return E?A===o||A===s:O?A===2*o||A===2*s:b instanceof u}function I(b,E,O=!0){if(R(b))throw new Error("first arg must be private key");if(!R(E))throw new Error("second arg must be public key");return u.fromHex(E).multiply(c(b)).toRawBytes(O)}const w=e.bits2int||function(b){const E=zt(b),O=b.length*8-e.nBitLength;return O>0?E>>BigInt(O):E},S=e.bits2int_modN||function(b){return l(w(b))},_=xi(e.nBitLength);function T(b){if(typeof b!="bigint")throw new Error("bigint expected");if(!(_e<=b&&b<_))throw new Error(`bigint expected < 2^${e.nBitLength}`);return cr(b,e.nByteLength)}function $(b,E,O=B){if(["recovered","canonical"].some(G=>G in O))throw new Error("sign() legacy options not supported");const{hash:A,randomBytes:N}=e;let{lowS:L,prehash:C,extraEntropy:M}=O;L==null&&(L=!0),b=Ct("msgHash",b),C&&(b=Ct("prehashed msgHash",A(b)));const Y=S(b),lt=c(E),bt=[T(lt),T(Y)];if(M!=null){const G=M===!0?N(r.BYTES):M;bt.push(Ct("extraEntropy",G))}const pt=Sr(...bt),wt=Y;function W(G){const et=w(G);if(!h(et))return;const nt=a(et),ct=u.BASE.multiply(et).toAffine(),dt=l(ct.x);if(dt===_e)return;const ot=l(nt*l(wt+dt*lt));if(ot===_e)return;let Kt=(ct.x===dt?0:2)|Number(ct.y&re),le=ot;return L&&p(ot)&&(le=d(ot),Kt^=1),new v(dt,le,Kt)}return{seed:pt,k2sig:W}}const B={lowS:e.lowS,prehash:!1},P={lowS:e.lowS,prehash:!1};function U(b,E,O=B){const{seed:A,k2sig:N}=$(b,E,O),L=e;return Nu(L.hash.outputLen,L.nByteLength,L.hmac)(A,N)}u.BASE._setWindowSize(8);function z(b,E,O,A=P){const N=b;if(E=Ct("msgHash",E),O=Ct("publicKey",O),"strict"in A)throw new Error("options.strict was renamed to lowS");const{lowS:L,prehash:C}=A;let M,Y;try{if(typeof N=="string"||N instanceof Uint8Array)try{M=v.fromDER(N)}catch(nt){if(!(nt instanceof vr.Err))throw nt;M=v.fromCompact(N)}else if(typeof N=="object"&&typeof N.r=="bigint"&&typeof N.s=="bigint"){const{r:nt,s:ct}=N;M=new v(nt,ct)}else throw new Error("PARSE");Y=u.fromHex(O)}catch(nt){if(nt.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(L&&M.hasHighS())return!1;C&&(E=e.hash(E));const{r:lt,s:bt}=M,pt=S(E),wt=a(bt),W=l(pt*wt),G=l(lt*wt),et=u.BASE.multiplyAndAddUnsafe(Y,W,G)?.toAffine();return et?l(et.x)===lt:!1}return{CURVE:e,getPublicKey:m,getSharedSecret:I,sign:U,verify:z,ProjectivePoint:u,Signature:v,utils:x}}let Uu=class extends Iu{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,Sp(t);const r=bi(e);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,o=new Uint8Array(n);o.set(r.length>n?t.create().update(r).digest():r);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=t.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(t){return oo(this),this.iHash.update(t),this}digestInto(t){oo(this),Su(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:n,destroyed:o,blockLen:s,outputLen:i}=this;return t=t,t.finished=n,t.destroyed=o,t.blockLen=s,t.outputLen=i,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const Pu=(t,e,r)=>new Uu(t,e).update(r).digest();Pu.create=(t,e)=>new Uu(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function hg(t){return{hash:t,hmac:(e,...r)=>Pu(t,e,Bp(...r)),randomBytes:Ru}}function dg(t,e){const r=n=>fg({...t,...hg(n)});return Object.freeze({...r(e),create:r})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const No=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),so=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),ju=BigInt(1),io=BigInt(2),za=(t,e)=>(t+e/io)/e;function zu(t){const e=No,r=BigInt(3),n=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),l=BigInt(44),a=BigInt(88),u=t*t*t%e,c=u*u*t%e,f=Xt(c,r,e)*c%e,h=Xt(f,r,e)*c%e,g=Xt(h,io,e)*u%e,p=Xt(g,o,e)*g%e,d=Xt(p,s,e)*p%e,y=Xt(d,l,e)*d%e,v=Xt(y,a,e)*y%e,x=Xt(v,l,e)*d%e,m=Xt(x,r,e)*c%e,R=Xt(m,i,e)*p%e,I=Xt(R,n,e)*u%e,w=Xt(I,io,e);if(!Ts.eql(Ts.sqr(w),t))throw new Error("Cannot find square root");return w}const Ts=rg(No,void 0,void 0,{sqrt:zu}),Qr=dg({a:BigInt(0),b:BigInt(7),Fp:Ts,n:so,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=so,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-ju*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,i=BigInt("0x100000000000000000000000000000000"),l=za(s*t,e),a=za(-n*t,e);let u=_t(t-l*r-a*o,e),c=_t(-l*n-a*s,e);const f=u>i,h=c>i;if(f&&(u=e-u),h&&(c=e-c),u>i||c>i)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:f,k1:u,k2neg:h,k2:c}}}},Bs),To=BigInt(0),Du=t=>typeof t=="bigint"&&To<t&&t<No,pg=t=>typeof t=="bigint"&&To<t&&t<so,Da={};function ao(t,...e){let r=Da[t];if(r===void 0){const n=Bs(Uint8Array.from(t,o=>o.charCodeAt(0)));r=Sr(n,n),Da[t]=r}return Bs(Sr(r,...e))}const ki=t=>t.toRawBytes(!0).slice(1),Ls=t=>cr(t,32),os=t=>_t(t,No),gn=t=>_t(t,so),$i=Qr.ProjectivePoint,gg=(t,e,r)=>$i.BASE.multiplyAndAddUnsafe(t,e,r);function Cs(t){let e=Qr.utils.normPrivateKeyToScalar(t),r=$i.fromPrivateKey(e);return{scalar:r.hasEvenY()?e:gn(-e),bytes:ki(r)}}function Hu(t){if(!Du(t))throw new Error("bad x: need 0 < x < p");const e=os(t*t),r=os(e*t+BigInt(7));let n=zu(r);n%io!==To&&(n=os(-n));const o=new $i(t,n,ju);return o.assertValidity(),o}function Mu(...t){return gn(zt(ao("BIP0340/challenge",...t)))}function yg(t){return Cs(t).bytes}function vg(t,e,r=Ru(32)){const n=Ct("message",t),{bytes:o,scalar:s}=Cs(e),i=Ct("auxRand",r,32),l=Ls(s^zt(ao("BIP0340/aux",i))),a=ao("BIP0340/nonce",l,o,n),u=gn(zt(a));if(u===To)throw new Error("sign failed: k is zero");const{bytes:c,scalar:f}=Cs(u),h=Mu(c,o,n),g=new Uint8Array(64);if(g.set(c,0),g.set(Ls(gn(f+h*s)),32),!Fu(g,n,o))throw new Error("sign: Invalid signature produced");return g}function Fu(t,e,r){const n=Ct("signature",t,64),o=Ct("message",e),s=Ct("publicKey",r,32);try{const i=Hu(zt(s)),l=zt(n.subarray(0,32));if(!Du(l))return!1;const a=zt(n.subarray(32,64));if(!pg(a))return!1;const u=Mu(Ls(l),ki(i),o),c=gg(i,a,gn(-u));return!(!c||!c.hasEvenY()||c.toAffine().x!==l)}catch{return!1}}const nn={getPublicKey:yg,sign:vg,verify:Fu,utils:{randomPrivateKey:Qr.utils.randomPrivateKey,lift_x:Hu,pointToBytes:ki,numberToBytesBE:cr,bytesToNumberBE:zt,taggedHash:ao,mod:_t}},ss=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ai=t=>t instanceof Uint8Array,is=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ye=(t,e)=>t<<32-e|t>>>e,bg=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!bg)throw new Error("Non little-endian hardware is not supported");const wg=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function vt(t){if(!Ai(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=wg[t[r]];return e}function Or(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){const o=n*2,s=t.slice(o,o+2),i=Number.parseInt(s,16);if(Number.isNaN(i)||i<0)throw new Error("Invalid byte sequence");r[n]=i}return r}function mg(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function yn(t){if(typeof t=="string"&&(t=mg(t)),!Ai(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function Lo(...t){const e=new Uint8Array(t.reduce((n,o)=>n+o.length,0));let r=0;return t.forEach(n=>{if(!Ai(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}class Vu{clone(){return this._cloneInto()}}function Ku(t){const e=n=>t().update(yn(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Wu(t=32){if(ss&&typeof ss.getRandomValues=="function")return ss.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function qs(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function Eg(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}function Zu(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function xg(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");qs(t.outputLen),qs(t.blockLen)}function kg(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function $g(t,e){Zu(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const me={number:qs,bool:Eg,bytes:Zu,hash:xg,exists:kg,output:$g};function Ag(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const o=BigInt(32),s=BigInt(4294967295),i=Number(r>>o&s),l=Number(r&s),a=n?4:0,u=n?0:4;t.setUint32(e+a,i,n),t.setUint32(e+u,l,n)}class Sg extends Vu{constructor(e,r,n,o){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=is(this.buffer)}update(e){me.exists(this);const{view:r,buffer:n,blockLen:o}=this;e=yn(e);const s=e.length;for(let i=0;i<s;){const l=Math.min(o-this.pos,s-i);if(l===o){const a=is(e);for(;o<=s-i;i+=o)this.process(a,i);continue}n.set(e.subarray(i,i+l),this.pos),this.pos+=l,i+=l,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){me.exists(this),me.output(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:o,isLE:s}=this;let{pos:i}=this;r[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(n,0),i=0);for(let f=i;f<o;f++)r[f]=0;Ag(n,o-8,BigInt(this.length*8),s),this.process(n,0);const l=is(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=a/4,c=this.get();if(u>c.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<u;f++)l.setUint32(4*f,c[f],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:o,finished:s,destroyed:i,pos:l}=this;return e.length=o,e.pos=l,e.finished=s,e.destroyed=i,o%r&&e.buffer.set(n),e}}const Og=(t,e,r)=>t&e^~t&r,Ig=(t,e,r)=>t&e^t&r^e&r,Rg=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ye=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Je=new Uint32Array(64);class Gu extends Sg{constructor(){super(64,32,8,!1),this.A=Ye[0]|0,this.B=Ye[1]|0,this.C=Ye[2]|0,this.D=Ye[3]|0,this.E=Ye[4]|0,this.F=Ye[5]|0,this.G=Ye[6]|0,this.H=Ye[7]|0}get(){const{A:e,B:r,C:n,D:o,E:s,F:i,G:l,H:a}=this;return[e,r,n,o,s,i,l,a]}set(e,r,n,o,s,i,l,a){this.A=e|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=l|0,this.H=a|0}process(e,r){for(let f=0;f<16;f++,r+=4)Je[f]=e.getUint32(r,!1);for(let f=16;f<64;f++){const h=Je[f-15],g=Je[f-2],p=ye(h,7)^ye(h,18)^h>>>3,d=ye(g,17)^ye(g,19)^g>>>10;Je[f]=d+Je[f-7]+p+Je[f-16]|0}let{A:n,B:o,C:s,D:i,E:l,F:a,G:u,H:c}=this;for(let f=0;f<64;f++){const h=ye(l,6)^ye(l,11)^ye(l,25),g=c+h+Og(l,a,u)+Rg[f]+Je[f]|0,p=(ye(n,2)^ye(n,13)^ye(n,22))+Ig(n,o,s)|0;c=u,u=a,a=l,l=i+g|0,i=s,s=o,o=n,n=g+p|0}n=n+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,l=l+this.E|0,a=a+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(n,o,s,i,l,a,u,c)}roundClean(){Je.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Bg extends Gu{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const tn=Ku(()=>new Gu);Ku(()=>new Bg);/*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) */function en(t){if(!Number.isSafeInteger(t))throw new Error(`Wrong integer: ${t}`)}function Fe(...t){const e=(o,s)=>i=>o(s(i)),r=Array.from(t).reverse().reduce((o,s)=>o?e(o,s.encode):s.encode,void 0),n=t.reduce((o,s)=>o?e(o,s.decode):s.decode,void 0);return{encode:r,decode:n}}function Ve(t){return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return e.map(r=>{if(en(r),r<0||r>=t.length)throw new Error(`Digit index outside alphabet: ${r} (alphabet: ${t.length})`);return t[r]})},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("alphabet.decode input should be array of strings");return e.map(r=>{if(typeof r!="string")throw new Error(`alphabet.decode: not string element=${r}`);const n=t.indexOf(r);if(n===-1)throw new Error(`Unknown letter: "${r}". Allowed: ${t}`);return n})}}}function Ke(t=""){if(typeof t!="string")throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("join.encode input should be array of strings");for(let r of e)if(typeof r!="string")throw new Error(`join.encode: non-string input=${r}`);return e.join(t)},decode:e=>{if(typeof e!="string")throw new Error("join.decode input should be string");return e.split(t)}}}function Co(t,e="="){if(en(t),typeof e!="string")throw new Error("padding chr should be string");return{encode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let n of r)if(typeof n!="string")throw new Error(`padding.encode: non-string input=${n}`);for(;r.length*t%8;)r.push(e);return r},decode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let o of r)if(typeof o!="string")throw new Error(`padding.decode: non-string input=${o}`);let n=r.length;if(n*t%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;n>0&&r[n-1]===e;n--)if(!((n-1)*t%8))throw new Error("Invalid padding: string has too much padding");return r.slice(0,n)}}}function Yu(t){if(typeof t!="function")throw new Error("normalize fn should be function");return{encode:e=>e,decode:e=>t(e)}}function Ha(t,e,r){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: wrong to=${r}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let n=0;const o=[],s=Array.from(t);for(s.forEach(i=>{if(en(i),i<0||i>=e)throw new Error(`Wrong integer: ${i}`)});;){let i=0,l=!0;for(let a=n;a<s.length;a++){const u=s[a],c=e*i+u;if(!Number.isSafeInteger(c)||e*i/e!==i||c-u!==e*i)throw new Error("convertRadix: carry overflow");if(i=c%r,s[a]=Math.floor(c/r),!Number.isSafeInteger(s[a])||s[a]*r+i!==c)throw new Error("convertRadix: carry overflow");if(l)s[a]?l=!1:n=a;else continue}if(o.push(i),l)break}for(let i=0;i<t.length-1&&t[i]===0;i++)o.push(0);return o.reverse()}const Ju=(t,e)=>e?Ju(e,t%e):t,lo=(t,e)=>t+(e-Ju(t,e));function Us(t,e,r,n){if(!Array.isArray(t))throw new Error("convertRadix2: data should be array");if(e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(lo(e,r)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${r} carryBits=${lo(e,r)}`);let o=0,s=0;const i=2**r-1,l=[];for(const a of t){if(en(a),a>=2**e)throw new Error(`convertRadix2: invalid data word=${a} from=${e}`);if(o=o<<e|a,s+e>32)throw new Error(`convertRadix2: carry overflow pos=${s} from=${e}`);for(s+=e;s>=r;s-=r)l.push((o>>s-r&i)>>>0);o&=2**s-1}if(o=o<<r-s&i,!n&&s>=e)throw new Error("Excess padding");if(!n&&o)throw new Error(`Non-zero padding: ${o}`);return n&&s>0&&l.push(o>>>0),l}function _g(t){return en(t),{encode:e=>{if(!(e instanceof Uint8Array))throw new Error("radix.encode input should be Uint8Array");return Ha(Array.from(e),2**8,t)},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("radix.decode input should be array of strings");return Uint8Array.from(Ha(e,t,2**8))}}}function pr(t,e=!1){if(en(t),t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(lo(8,t)>32||lo(t,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!(r instanceof Uint8Array))throw new Error("radix2.encode input should be Uint8Array");return Us(Array.from(r),8,t,!e)},decode:r=>{if(!Array.isArray(r)||r.length&&typeof r[0]!="number")throw new Error("radix2.decode input should be array of strings");return Uint8Array.from(Us(r,t,8,e))}}}function Ma(t){if(typeof t!="function")throw new Error("unsafeWrapper fn should be function");return function(...e){try{return t.apply(null,e)}catch{}}}const Ng=Fe(pr(4),Ve("0123456789ABCDEF"),Ke("")),Tg=Fe(pr(5),Ve("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),Co(5),Ke(""));Fe(pr(5),Ve("0123456789ABCDEFGHIJKLMNOPQRSTUV"),Co(5),Ke(""));Fe(pr(5),Ve("0123456789ABCDEFGHJKMNPQRSTVWXYZ"),Ke(""),Yu(t=>t.toUpperCase().replace(/O/g,"0").replace(/[IL]/g,"1")));const Pe=Fe(pr(6),Ve("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),Co(6),Ke("")),Lg=Fe(pr(6),Ve("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"),Co(6),Ke("")),Si=t=>Fe(_g(58),Ve(t),Ke("")),Ps=Si("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");Si("123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ");Si("rpshnaf39wBUDNEGHJKLM4PQRST7VWXYZ2bcdeCg65jkm8oFqi1tuvAxyz");const Fa=[0,2,3,5,6,7,9,10,11],Cg={encode(t){let e="";for(let r=0;r<t.length;r+=8){const n=t.subarray(r,r+8);e+=Ps.encode(n).padStart(Fa[n.length],"1")}return e},decode(t){let e=[];for(let r=0;r<t.length;r+=11){const n=t.slice(r,r+11),o=Fa.indexOf(n.length),s=Ps.decode(n);for(let i=0;i<s.length-o;i++)if(s[i]!==0)throw new Error("base58xmr: wrong padding");e=e.concat(Array.from(s.slice(s.length-o)))}return Uint8Array.from(e)}},js=Fe(Ve("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),Ke("")),Va=[996825010,642813549,513874426,1027748829,705979059];function on(t){const e=t>>25;let r=(t&33554431)<<5;for(let n=0;n<Va.length;n++)(e>>n&1)===1&&(r^=Va[n]);return r}function Ka(t,e,r=1){const n=t.length;let o=1;for(let s=0;s<n;s++){const i=t.charCodeAt(s);if(i<33||i>126)throw new Error(`Invalid prefix (${t})`);o=on(o)^i>>5}o=on(o);for(let s=0;s<n;s++)o=on(o)^t.charCodeAt(s)&31;for(let s of e)o=on(o)^s;for(let s=0;s<6;s++)o=on(o);return o^=r,js.encode(Us([o%2**30],30,5,!1))}function Xu(t){const e=t==="bech32"?1:734539939,r=pr(5),n=r.decode,o=r.encode,s=Ma(n);function i(c,f,h=90){if(typeof c!="string")throw new Error(`bech32.encode prefix should be string, not ${typeof c}`);if(!Array.isArray(f)||f.length&&typeof f[0]!="number")throw new Error(`bech32.encode words should be array of numbers, not ${typeof f}`);const g=c.length+7+f.length;if(h!==!1&&g>h)throw new TypeError(`Length ${g} exceeds limit ${h}`);return c=c.toLowerCase(),`${c}1${js.encode(f)}${Ka(c,f,e)}`}function l(c,f=90){if(typeof c!="string")throw new Error(`bech32.decode input should be string, not ${typeof c}`);if(c.length<8||f!==!1&&c.length>f)throw new TypeError(`Wrong string length: ${c.length} (${c}). Expected (8..${f})`);const h=c.toLowerCase();if(c!==h&&c!==c.toUpperCase())throw new Error("String must be lowercase or uppercase");c=h;const g=c.lastIndexOf("1");if(g===0||g===-1)throw new Error('Letter "1" must be present between prefix and data only');const p=c.slice(0,g),d=c.slice(g+1);if(d.length<6)throw new Error("Data must be at least 6 characters long");const y=js.decode(d).slice(0,-6),v=Ka(p,y,e);if(!d.endsWith(v))throw new Error(`Invalid checksum in ${c}: expected "${v}"`);return{prefix:p,words:y}}const a=Ma(l);function u(c){const{prefix:f,words:h}=l(c,!1);return{prefix:f,words:h,bytes:n(h)}}return{encode:i,decode:l,decodeToBytes:u,decodeUnsafe:a,fromWords:n,fromWordsUnsafe:s,toWords:o}}const fr=Xu("bech32");Xu("bech32m");const qg={encode:t=>new TextDecoder().decode(t),decode:t=>new TextEncoder().encode(t)},Ug=Fe(pr(4),Ve("0123456789abcdef"),Ke(""),Yu(t=>{if(typeof t!="string"||t.length%2)throw new TypeError(`hex.decode: expected string, got ${typeof t} with length ${t.length}`);return t.toLowerCase()})),Pg={utf8:qg,hex:Ug,base16:Ng,base32:Tg,base64:Pe,base64url:Lg,base58:Ps,base58xmr:Cg};`${Object.keys(Pg).join(", ")}`;function as(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function Wa(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function jg(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function Te(t,...e){if(!jg(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}/*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) */const Ut=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),zg=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!zg)throw new Error("Non little-endian hardware is not supported");function Dg(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function Hg(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}const Mg=(t,e)=>(Object.assign(e,t),e),sr=16,Fg=283;function Oi(t){return t<<1^Fg&-(t>>7)}function zr(t,e){let r=0;for(;e>0;e>>=1)r^=t&-(e&1),t=Oi(t);return r}const zs=(()=>{let t=new Uint8Array(256);for(let r=0,n=1;r<256;r++,n^=Oi(n))t[r]=n;const e=new Uint8Array(256);e[0]=99;for(let r=0;r<255;r++){let n=t[255-r];n|=n<<8,e[t[r]]=(n^n>>4^n>>5^n>>6^n>>7^99)&255}return e})(),Vg=zs.map((t,e)=>zs.indexOf(e)),Kg=t=>t<<24|t>>>8,ls=t=>t<<8|t>>>24;function Qu(t,e){if(t.length!==256)throw new Error("Wrong sbox length");const r=new Uint32Array(256).map((u,c)=>e(t[c])),n=r.map(ls),o=n.map(ls),s=o.map(ls),i=new Uint32Array(256*256),l=new Uint32Array(256*256),a=new Uint16Array(256*256);for(let u=0;u<256;u++)for(let c=0;c<256;c++){const f=u*256+c;i[f]=r[u]^n[c],l[f]=o[u]^s[c],a[f]=t[u]<<8|t[c]}return{sbox:t,sbox2:a,T0:r,T1:n,T2:o,T3:s,T01:i,T23:l}}const Ii=Qu(zs,t=>zr(t,3)<<24|t<<16|t<<8|zr(t,2)),tc=Qu(Vg,t=>zr(t,11)<<24|zr(t,13)<<16|zr(t,9)<<8|zr(t,14)),Wg=(()=>{const t=new Uint8Array(16);for(let e=0,r=1;e<16;e++,r=Oi(r))t[e]=r;return t})();function ec(t){Te(t);const e=t.length;if(![16,24,32].includes(e))throw new Error(`aes: wrong key size: should be 16, 24 or 32, got: ${e}`);const{sbox2:r}=Ii,n=Ut(t),o=n.length,s=l=>Ee(r,l,l,l,l),i=new Uint32Array(e+28);i.set(n);for(let l=o;l<i.length;l++){let a=i[l-1];l%o===0?a=s(Kg(a))^Wg[l/o-1]:o>6&&l%o===4&&(a=s(a)),i[l]=i[l-o]^a}return i}function Zg(t){const e=ec(t),r=e.slice(),n=e.length,{sbox2:o}=Ii,{T0:s,T1:i,T2:l,T3:a}=tc;for(let u=0;u<n;u+=4)for(let c=0;c<4;c++)r[u+c]=e[n-u-4+c];e.fill(0);for(let u=4;u<n-4;u++){const c=r[u],f=Ee(o,c,c,c,c);r[u]=s[f&255]^i[f>>>8&255]^l[f>>>16&255]^a[f>>>24]}return r}function rr(t,e,r,n,o,s){return t[r<<8&65280|n>>>8&255]^e[o>>>8&65280|s>>>24&255]}function Ee(t,e,r,n,o){return t[e&255|r&65280]|t[n>>>16&255|o>>>16&65280]<<16}function Za(t,e,r,n,o){const{sbox2:s,T01:i,T23:l}=Ii;let a=0;e^=t[a++],r^=t[a++],n^=t[a++],o^=t[a++];const u=t.length/4-2;for(let p=0;p<u;p++){const d=t[a++]^rr(i,l,e,r,n,o),y=t[a++]^rr(i,l,r,n,o,e),v=t[a++]^rr(i,l,n,o,e,r),x=t[a++]^rr(i,l,o,e,r,n);e=d,r=y,n=v,o=x}const c=t[a++]^Ee(s,e,r,n,o),f=t[a++]^Ee(s,r,n,o,e),h=t[a++]^Ee(s,n,o,e,r),g=t[a++]^Ee(s,o,e,r,n);return{s0:c,s1:f,s2:h,s3:g}}function Gg(t,e,r,n,o){const{sbox2:s,T01:i,T23:l}=tc;let a=0;e^=t[a++],r^=t[a++],n^=t[a++],o^=t[a++];const u=t.length/4-2;for(let p=0;p<u;p++){const d=t[a++]^rr(i,l,e,o,n,r),y=t[a++]^rr(i,l,r,e,o,n),v=t[a++]^rr(i,l,n,r,e,o),x=t[a++]^rr(i,l,o,n,r,e);e=d,r=y,n=v,o=x}const c=t[a++]^Ee(s,e,o,n,r),f=t[a++]^Ee(s,r,e,o,n),h=t[a++]^Ee(s,n,r,e,o),g=t[a++]^Ee(s,o,n,r,e);return{s0:c,s1:f,s2:h,s3:g}}function rc(t,e){if(!e)return new Uint8Array(t);if(Te(e),e.length<t)throw new Error(`aes: wrong destination length, expected at least ${t}, got: ${e.length}`);return e}function Yg(t){if(Te(t),t.length%sr!==0)throw new Error(`aes/(cbc-ecb).decrypt ciphertext should consist of blocks with size ${sr}`)}function Jg(t,e,r){let n=t.length;const o=n%sr;if(!e&&o!==0)throw new Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");const s=Ut(t);if(e){let a=sr-o;a||(a=sr),n=n+a}const i=rc(n,r),l=Ut(i);return{b:s,o:l,out:i}}function Xg(t,e){if(!e)return t;const r=t.length;if(!r)throw new Error("aes/pcks5: empty ciphertext not allowed");const n=t[r-1];if(n<=0||n>16)throw new Error(`aes/pcks5: wrong padding byte: ${n}`);const o=t.subarray(0,-n);for(let s=0;s<n;s++)if(t[r-s-1]!==n)throw new Error("aes/pcks5: wrong padding");return o}function Qg(t){const e=new Uint8Array(16),r=Ut(e);e.set(t);const n=sr-t.length;for(let o=sr-n;o<sr;o++)e[o]=n;return r}const nc=Mg({blockSize:16,nonceLength:16},function(t,e,r={}){Te(t),Te(e,16);const n=!r.disablePadding;return{encrypt:(o,s)=>{const i=ec(t),{b:l,o:a,out:u}=Jg(o,n,s),c=Ut(e);let f=c[0],h=c[1],g=c[2],p=c[3],d=0;for(;d+4<=l.length;)f^=l[d+0],h^=l[d+1],g^=l[d+2],p^=l[d+3],{s0:f,s1:h,s2:g,s3:p}=Za(i,f,h,g,p),a[d++]=f,a[d++]=h,a[d++]=g,a[d++]=p;if(n){const y=Qg(o.subarray(d*4));f^=y[0],h^=y[1],g^=y[2],p^=y[3],{s0:f,s1:h,s2:g,s3:p}=Za(i,f,h,g,p),a[d++]=f,a[d++]=h,a[d++]=g,a[d++]=p}return i.fill(0),u},decrypt:(o,s)=>{Yg(o);const i=Zg(t),l=Ut(e),a=rc(o.length,s),u=Ut(o),c=Ut(a);let f=l[0],h=l[1],g=l[2],p=l[3];for(let d=0;d+4<=u.length;){const y=f,v=h,x=g,m=p;f=u[d+0],h=u[d+1],g=u[d+2],p=u[d+3];const{s0:R,s1:I,s2:w,s3:S}=Gg(i,f,h,g,p);c[d++]=R^y,c[d++]=I^v,c[d++]=w^x,c[d++]=S^m}return i.fill(0),Xg(a,n)}}}),oc=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),ty=oc("expand 16-byte k"),ey=oc("expand 32-byte k"),ry=Ut(ty),sc=Ut(ey);sc.slice();function rt(t,e){return t<<e|t>>>32-e}function Ds(t){return t.byteOffset%4===0}const Un=64,ny=16,ic=2**32-1,Ga=new Uint32Array;function oy(t,e,r,n,o,s,i,l){const a=o.length,u=new Uint8Array(Un),c=Ut(u),f=Ds(o)&&Ds(s),h=f?Ut(o):Ga,g=f?Ut(s):Ga;for(let p=0;p<a;i++){if(t(e,r,n,c,i,l),i>=ic)throw new Error("arx: counter overflow");const d=Math.min(Un,a-p);if(f&&d===Un){const y=p/4;if(p%4!==0)throw new Error("arx: invalid block position");for(let v=0,x;v<ny;v++)x=y+v,g[x]=h[x]^c[v];p+=Un;continue}for(let y=0,v;y<d;y++)v=p+y,s[v]=o[v]^u[y];p+=d}}function sy(t,e){const{allowShortKeys:r,extendNonceFn:n,counterLength:o,counterRight:s,rounds:i}=Dg({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return as(o),as(i),Wa(s),Wa(r),(l,a,u,c,f=0)=>{Te(l),Te(a),Te(u);const h=u.length;if(c||(c=new Uint8Array(h)),Te(c),as(f),f<0||f>=ic)throw new Error("arx: counter overflow");if(c.length<h)throw new Error(`arx: output (${c.length}) is shorter than data (${h})`);const g=[];let p=l.length,d,y;if(p===32)d=l.slice(),g.push(d),y=sc;else if(p===16&&r)d=new Uint8Array(32),d.set(l),d.set(l,16),y=ry,g.push(d);else throw new Error(`arx: invalid 32-byte key, got length=${p}`);Ds(a)||(a=a.slice(),g.push(a));const v=Ut(d);if(n){if(a.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(y,v,Ut(a.subarray(0,16)),v),a=a.subarray(16)}const x=16-o;if(x!==a.length)throw new Error(`arx: nonce must be ${x} or 16 bytes`);if(x!==12){const R=new Uint8Array(12);R.set(a,s?0:12-a.length),a=R,g.push(a)}const m=Ut(a);for(oy(t,y,v,m,u,c,f,i);g.length>0;)g.pop().fill(0);return c}}function iy(t,e,r,n,o,s=20){let i=t[0],l=t[1],a=t[2],u=t[3],c=e[0],f=e[1],h=e[2],g=e[3],p=e[4],d=e[5],y=e[6],v=e[7],x=o,m=r[0],R=r[1],I=r[2],w=i,S=l,_=a,T=u,$=c,B=f,P=h,U=g,z=p,b=d,E=y,O=v,A=x,N=m,L=R,C=I;for(let Y=0;Y<s;Y+=2)w=w+$|0,A=rt(A^w,16),z=z+A|0,$=rt($^z,12),w=w+$|0,A=rt(A^w,8),z=z+A|0,$=rt($^z,7),S=S+B|0,N=rt(N^S,16),b=b+N|0,B=rt(B^b,12),S=S+B|0,N=rt(N^S,8),b=b+N|0,B=rt(B^b,7),_=_+P|0,L=rt(L^_,16),E=E+L|0,P=rt(P^E,12),_=_+P|0,L=rt(L^_,8),E=E+L|0,P=rt(P^E,7),T=T+U|0,C=rt(C^T,16),O=O+C|0,U=rt(U^O,12),T=T+U|0,C=rt(C^T,8),O=O+C|0,U=rt(U^O,7),w=w+B|0,C=rt(C^w,16),E=E+C|0,B=rt(B^E,12),w=w+B|0,C=rt(C^w,8),E=E+C|0,B=rt(B^E,7),S=S+P|0,A=rt(A^S,16),O=O+A|0,P=rt(P^O,12),S=S+P|0,A=rt(A^S,8),O=O+A|0,P=rt(P^O,7),_=_+U|0,N=rt(N^_,16),z=z+N|0,U=rt(U^z,12),_=_+U|0,N=rt(N^_,8),z=z+N|0,U=rt(U^z,7),T=T+$|0,L=rt(L^T,16),b=b+L|0,$=rt($^b,12),T=T+$|0,L=rt(L^T,8),b=b+L|0,$=rt($^b,7);let M=0;n[M++]=i+w|0,n[M++]=l+S|0,n[M++]=a+_|0,n[M++]=u+T|0,n[M++]=c+$|0,n[M++]=f+B|0,n[M++]=h+P|0,n[M++]=g+U|0,n[M++]=p+z|0,n[M++]=d+b|0,n[M++]=y+E|0,n[M++]=v+O|0,n[M++]=x+A|0,n[M++]=m+N|0,n[M++]=R+L|0,n[M++]=I+C|0}const ac=sy(iy,{counterRight:!1,counterLength:4,allowShortKeys:!1});class lc extends Vu{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,me.hash(e);const n=yn(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,s=new Uint8Array(o);s.set(n.length>o?e.create().update(n).digest():n);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=e.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(e){return me.exists(this),this.iHash.update(e),this}digestInto(e){me.exists(this),me.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:o,destroyed:s,blockLen:i,outputLen:l}=this;return e=e,e.finished=o,e.destroyed=s,e.blockLen=i,e.outputLen=l,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const qo=(t,e,r)=>new lc(t,e).update(r).digest();qo.create=(t,e)=>new lc(t,e);function ay(t,e,r){return me.hash(t),qo(t,yn(r),yn(e))}const us=new Uint8Array([0]),Ya=new Uint8Array;function ly(t,e,r,n=32){if(me.hash(t),me.number(n),n>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const o=Math.ceil(n/t.outputLen);r===void 0&&(r=Ya);const s=new Uint8Array(o*t.outputLen),i=qo.create(t,e),l=i._cloneInto(),a=new Uint8Array(i.outputLen);for(let u=0;u<o;u++)us[0]=u+1,l.update(u===0?Ya:a).update(r).update(us).digestInto(a),s.set(a,t.outputLen*u),i._cloneInto(l);return i.destroy(),l.destroy(),a.fill(0),us.fill(0),s.slice(0,n)}var uy=Object.defineProperty,gt=(t,e)=>{for(var r in e)uy(t,r,{get:e[r],enumerable:!0})},qr=Symbol("verified"),cy=t=>t instanceof Object;function Ri(t){if(!cy(t)||typeof t.kind!="number"||typeof t.content!="string"||typeof t.created_at!="number"||typeof t.pubkey!="string"||!t.pubkey.match(/^[a-f0-9]{64}$/)||!Array.isArray(t.tags))return!1;for(let e=0;e<t.tags.length;e++){let r=t.tags[e];if(!Array.isArray(r))return!1;for(let n=0;n<r.length;n++)if(typeof r[n]!="string")return!1}return!0}var fy={};gt(fy,{Queue:()=>gy,QueueNode:()=>uc,binarySearch:()=>Bi,bytesToHex:()=>vt,hexToBytes:()=>Or,insertEventIntoAscendingList:()=>py,insertEventIntoDescendingList:()=>dy,normalizeURL:()=>hy,utf8Decoder:()=>Le,utf8Encoder:()=>de});var Le=new TextDecoder("utf-8"),de=new TextEncoder;function hy(t){try{t.indexOf("://")===-1&&(t="wss://"+t);let e=new URL(t);return e.pathname=e.pathname.replace(/\/+/g,"/"),e.pathname.endsWith("/")&&(e.pathname=e.pathname.slice(0,-1)),(e.port==="80"&&e.protocol==="ws:"||e.port==="443"&&e.protocol==="wss:")&&(e.port=""),e.searchParams.sort(),e.hash="",e.toString()}catch{throw new Error(`Invalid URL: ${t}`)}}function dy(t,e){const[r,n]=Bi(t,o=>e.id===o.id?0:e.created_at===o.created_at?-1:o.created_at-e.created_at);return n||t.splice(r,0,e),t}function py(t,e){const[r,n]=Bi(t,o=>e.id===o.id?0:e.created_at===o.created_at?-1:e.created_at-o.created_at);return n||t.splice(r,0,e),t}function Bi(t,e){let r=0,n=t.length-1;for(;r<=n;){const o=Math.floor((r+n)/2),s=e(t[o]);if(s===0)return[o,!0];s<0?n=o-1:r=o+1}return[r,!1]}var uc=class{value;next=null;prev=null;constructor(t){this.value=t}},gy=class{first;last;constructor(){this.first=null,this.last=null}enqueue(t){const e=new uc(t);return this.last?this.last===this.first?(this.last=e,this.last.prev=this.first,this.first.next=e):(e.prev=this.last,this.last.next=e,this.last=e):(this.first=e,this.last=e),!0}dequeue(){if(!this.first)return null;if(this.first===this.last){const e=this.first;return this.first=null,this.last=null,e.value}const t=this.first;return this.first=t.next,this.first&&(this.first.prev=null),t.value}},yy=class{generateSecretKey(){return nn.utils.randomPrivateKey()}getPublicKey(t){return vt(nn.getPublicKey(t))}finalizeEvent(t,e){const r=t;return r.pubkey=vt(nn.getPublicKey(e)),r.id=Mn(r),r.sig=vt(nn.sign(Mn(r),e)),r[qr]=!0,r}verifyEvent(t){if(typeof t[qr]=="boolean")return t[qr];const e=Mn(t);if(e!==t.id)return t[qr]=!1,!1;try{const r=nn.verify(t.sig,e,t.pubkey);return t[qr]=r,r}catch{return t[qr]=!1,!1}}};function vy(t){if(!Ri(t))throw new Error("can't serialize event with wrong or missing properties");return JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content])}function Mn(t){let e=tn(de.encode(vy(t)));return vt(e)}var Uo=new yy,by=Uo.generateSecretKey,_i=Uo.getPublicKey,Se=Uo.finalizeEvent,Ni=Uo.verifyEvent,wy={};gt(wy,{Application:()=>bv,BadgeAward:()=>Oy,BadgeDefinition:()=>fv,BlockedRelaysList:()=>Gy,BookmarkList:()=>Ky,Bookmarksets:()=>lv,Calendar:()=>Av,CalendarEventRSVP:()=>Sv,ChannelCreation:()=>gc,ChannelHideMessage:()=>bc,ChannelMessage:()=>vc,ChannelMetadata:()=>yc,ChannelMuteUser:()=>wc,ClassifiedListing:()=>Ev,ClientAuth:()=>Ec,CommunitiesList:()=>Wy,CommunityDefinition:()=>Rv,CommunityPostApproval:()=>Cy,Contacts:()=>$y,CreateOrUpdateProduct:()=>pv,CreateOrUpdateStall:()=>dv,Curationsets:()=>uv,Date:()=>kv,DirectMessageRelaysList:()=>Qy,DraftClassifiedListing:()=>xv,DraftLong:()=>yv,Emojisets:()=>vv,EncryptedDirectMessage:()=>Ay,EventDeletion:()=>Sy,FileMetadata:()=>Ry,FileServerPreference:()=>tv,Followsets:()=>sv,GenericRepost:()=>Ui,Genericlists:()=>iv,GiftWrap:()=>mc,HTTPAuth:()=>Pi,Handlerinformation:()=>Iv,Handlerrecommendation:()=>Ov,Highlights:()=>Hy,InterestsList:()=>Jy,Interestsets:()=>hv,JobFeedback:()=>Py,JobRequest:()=>qy,JobResult:()=>Uy,Label:()=>Ly,LightningPubRPC:()=>rv,LiveChatMessage:()=>By,LiveEvent:()=>wv,LongFormArticle:()=>gv,Metadata:()=>xy,Mutelist:()=>My,NWCWalletInfo:()=>ev,NWCWalletRequest:()=>xc,NWCWalletResponse:()=>nv,NostrConnect:()=>ov,OpenTimestamps:()=>Iy,Pinlist:()=>Fy,PrivateDirectMessage:()=>pc,ProblemTracker:()=>_y,ProfileBadges:()=>cv,PublicChatsList:()=>Zy,Reaction:()=>qi,RecommendRelay:()=>ky,RelayList:()=>Vy,Relaysets:()=>av,Report:()=>Ny,Reporting:()=>Ty,Repost:()=>Ci,Seal:()=>dc,SearchRelaysList:()=>Yy,ShortTextNote:()=>hc,Time:()=>$v,UserEmojiList:()=>Xy,UserStatuses:()=>mv,Zap:()=>Dy,ZapGoal:()=>jy,ZapRequest:()=>zy,classifyKind:()=>my,isAddressableKind:()=>Li,isEphemeralKind:()=>fc,isKind:()=>Ey,isRegularKind:()=>cc,isReplaceableKind:()=>Ti});function cc(t){return 1e3<=t&&t<1e4||[1,2,4,5,6,7,8,16,40,41,42,43,44].includes(t)}function Ti(t){return[0,3].includes(t)||1e4<=t&&t<2e4}function fc(t){return 2e4<=t&&t<3e4}function Li(t){return 3e4<=t&&t<4e4}function my(t){return cc(t)?"regular":Ti(t)?"replaceable":fc(t)?"ephemeral":Li(t)?"parameterized":"unknown"}function Ey(t,e){const r=e instanceof Array?e:[e];return Ri(t)&&r.includes(t.kind)||!1}var xy=0,hc=1,ky=2,$y=3,Ay=4,Sy=5,Ci=6,qi=7,Oy=8,dc=13,pc=14,Ui=16,gc=40,yc=41,vc=42,bc=43,wc=44,Iy=1040,mc=1059,Ry=1063,By=1311,_y=1971,Ny=1984,Ty=1984,Ly=1985,Cy=4550,qy=5999,Uy=6999,Py=7e3,jy=9041,zy=9734,Dy=9735,Hy=9802,My=1e4,Fy=10001,Vy=10002,Ky=10003,Wy=10004,Zy=10005,Gy=10006,Yy=10007,Jy=10015,Xy=10030,Qy=10050,tv=10096,ev=13194,rv=21e3,Ec=22242,xc=23194,nv=23195,ov=24133,Pi=27235,sv=3e4,iv=30001,av=30002,lv=30003,uv=30004,cv=30008,fv=30009,hv=30015,dv=30017,pv=30018,gv=30023,yv=30024,vv=30030,bv=30078,wv=30311,mv=30315,Ev=30402,xv=30403,kv=31922,$v=31923,Av=31924,Sv=31925,Ov=31989,Iv=31990,Rv=34550,Bv={};gt(Bv,{getHex64:()=>ji,getInt:()=>kc,getSubscriptionId:()=>_v,matchEventId:()=>Nv,matchEventKind:()=>Lv,matchEventPubkey:()=>Tv});function ji(t,e){let r=e.length+3,n=t.indexOf(`"${e}":`)+r,o=t.slice(n).indexOf('"')+n+1;return t.slice(o,o+64)}function kc(t,e){let r=e.length,n=t.indexOf(`"${e}":`)+r+3,o=t.slice(n),s=Math.min(o.indexOf(","),o.indexOf("}"));return parseInt(o.slice(0,s),10)}function _v(t){let e=t.slice(0,22).indexOf('"EVENT"');if(e===-1)return null;let r=t.slice(e+7+1).indexOf('"');if(r===-1)return null;let n=e+7+1+r,o=t.slice(n+1,80).indexOf('"');if(o===-1)return null;let s=n+1+o;return t.slice(n+1,s)}function Nv(t,e){return e===ji(t,"id")}function Tv(t,e){return e===ji(t,"pubkey")}function Lv(t,e){return e===kc(t,"kind")}var Cv={};gt(Cv,{makeAuthEvent:()=>qv});function qv(t,e){return{kind:Ec,created_at:Math.floor(Date.now()/1e3),tags:[["relay",t],["challenge",e]],content:""}}var Uv;try{Uv=WebSocket}catch{}var Pv;try{Pv=WebSocket}catch{}var Hs={};gt(Hs,{BECH32_REGEX:()=>$c,Bech32MaxSize:()=>zi,NostrTypeGuard:()=>jv,decode:()=>Po,decodeNostrURI:()=>Dv,encodeBytes:()=>zo,naddrEncode:()=>Wv,neventEncode:()=>Kv,noteEncode:()=>Fv,nprofileEncode:()=>Vv,npubEncode:()=>Mv,nsecEncode:()=>Hv});var jv={isNProfile:t=>/^nprofile1[a-z\d]+$/.test(t||""),isNEvent:t=>/^nevent1[a-z\d]+$/.test(t||""),isNAddr:t=>/^naddr1[a-z\d]+$/.test(t||""),isNSec:t=>/^nsec1[a-z\d]{58}$/.test(t||""),isNPub:t=>/^npub1[a-z\d]{58}$/.test(t||""),isNote:t=>/^note1[a-z\d]+$/.test(t||""),isNcryptsec:t=>/^ncryptsec1[a-z\d]+$/.test(t||"")},zi=5e3,$c=/[\x21-\x7E]{1,83}1[023456789acdefghjklmnpqrstuvwxyz]{6,}/;function zv(t){const e=new Uint8Array(4);return e[0]=t>>24&255,e[1]=t>>16&255,e[2]=t>>8&255,e[3]=t&255,e}function Dv(t){try{return t.startsWith("nostr:")&&(t=t.substring(6)),Po(t)}catch{return{type:"invalid",data:null}}}function Po(t){let{prefix:e,words:r}=fr.decode(t,zi),n=new Uint8Array(fr.fromWords(r));switch(e){case"nprofile":{let o=cs(n);if(!o[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:vt(o[0][0]),relays:o[1]?o[1].map(s=>Le.decode(s)):[]}}}case"nevent":{let o=cs(n);if(!o[0]?.[0])throw new Error("missing TLV 0 for nevent");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(o[2]&&o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(o[3]&&o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:vt(o[0][0]),relays:o[1]?o[1].map(s=>Le.decode(s)):[],author:o[2]?.[0]?vt(o[2][0]):void 0,kind:o[3]?.[0]?parseInt(vt(o[3][0]),16):void 0}}}case"naddr":{let o=cs(n);if(!o[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!o[2]?.[0])throw new Error("missing TLV 2 for naddr");if(o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!o[3]?.[0])throw new Error("missing TLV 3 for naddr");if(o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:Le.decode(o[0][0]),pubkey:vt(o[2][0]),kind:parseInt(vt(o[3][0]),16),relays:o[1]?o[1].map(s=>Le.decode(s)):[]}}}case"nsec":return{type:e,data:n};case"npub":case"note":return{type:e,data:vt(n)};default:throw new Error(`unknown prefix ${e}`)}}function cs(t){let e={},r=t;for(;r.length>0;){let n=r[0],o=r[1],s=r.slice(2,2+o);if(r=r.slice(2+o),s.length<o)throw new Error(`not enough data to read on TLV ${n}`);e[n]=e[n]||[],e[n].push(s)}return e}function Hv(t){return zo("nsec",t)}function Mv(t){return zo("npub",Or(t))}function Fv(t){return zo("note",Or(t))}function jo(t,e){let r=fr.toWords(e);return fr.encode(t,r,zi)}function zo(t,e){return jo(t,e)}function Vv(t){let e=Di({0:[Or(t.pubkey)],1:(t.relays||[]).map(r=>de.encode(r))});return jo("nprofile",e)}function Kv(t){let e;t.kind!==void 0&&(e=zv(t.kind));let r=Di({0:[Or(t.id)],1:(t.relays||[]).map(n=>de.encode(n)),2:t.author?[Or(t.author)]:[],3:e?[new Uint8Array(e)]:[]});return jo("nevent",r)}function Wv(t){let e=new ArrayBuffer(4);new DataView(e).setUint32(0,t.kind,!1);let r=Di({0:[de.encode(t.identifier)],1:(t.relays||[]).map(n=>de.encode(n)),2:[Or(t.pubkey)],3:[new Uint8Array(e)]});return jo("naddr",r)}function Di(t){let e=[];return Object.entries(t).reverse().forEach(([r,n])=>{n.forEach(o=>{let s=new Uint8Array(o.length+2);s.set([parseInt(r)],0),s.set([o.length],1),s.set(o,2),e.push(s)})}),Lo(...e)}var Zv={};gt(Zv,{decrypt:()=>Gv,encrypt:()=>Ac});function Ac(t,e,r){const n=t instanceof Uint8Array?vt(t):t,o=Qr.getSharedSecret(n,"02"+e),s=Sc(o);let i=Uint8Array.from(Wu(16)),l=de.encode(r),a=nc(s,i).encrypt(l),u=Pe.encode(new Uint8Array(a)),c=Pe.encode(new Uint8Array(i.buffer));return`${u}?iv=${c}`}function Gv(t,e,r){const n=t instanceof Uint8Array?vt(t):t;let[o,s]=r.split("?iv="),i=Qr.getSharedSecret(n,"02"+e),l=Sc(i),a=Pe.decode(s),u=Pe.decode(o),c=nc(l,a).decrypt(u);return Le.decode(c)}function Sc(t){return t.slice(1,33)}var Yv={};gt(Yv,{NIP05_REGEX:()=>Hi,isNip05:()=>Jv,isValid:()=>t0,queryProfile:()=>Oc,searchDomain:()=>Qv,useFetchImplementation:()=>Xv});var Hi=/^(?:([\w.+-]+)@)?([\w_-]+(\.[\w_-]+)+)$/,Jv=t=>Hi.test(t||""),Do;try{Do=fetch}catch{}function Xv(t){Do=t}async function Qv(t,e=""){try{const r=`https://${t}/.well-known/nostr.json?name=${e}`,n=await Do(r,{redirect:"manual"});if(n.status!==200)throw Error("Wrong response code");return(await n.json()).names}catch{return{}}}async function Oc(t){const e=t.match(Hi);if(!e)return null;const[,r="_",n]=e;try{const o=`https://${n}/.well-known/nostr.json?name=${r}`,s=await Do(o,{redirect:"manual"});if(s.status!==200)throw Error("Wrong response code");const i=await s.json(),l=i.names[r];return l?{pubkey:l,relays:i.relays?.[l]}:null}catch{return null}}async function t0(t,e){const r=await Oc(e);return r?r.pubkey===t:!1}var e0={};gt(e0,{parse:()=>r0});function r0(t){const e={reply:void 0,root:void 0,mentions:[],profiles:[],quotes:[]};let r,n;for(let o=t.tags.length-1;o>=0;o--){const s=t.tags[o];if(s[0]==="e"&&s[1]){const[i,l,a,u,c]=s,f={id:l,relays:a?[a]:[],author:c};if(u==="root"){e.root=f;continue}if(u==="reply"){e.reply=f;continue}if(u==="mention"){e.mentions.push(f);continue}r?n=f:r=f,e.mentions.push(f);continue}if(s[0]==="q"&&s[1]){const[i,l,a]=s;e.quotes.push({id:l,relays:a?[a]:[]})}if(s[0]==="p"&&s[1]){e.profiles.push({pubkey:s[1],relays:s[2]?[s[2]]:[]});continue}}return e.root||(e.root=n||r||e.reply),e.reply||(e.reply=r||e.root),[e.reply,e.root].forEach(o=>{if(!o)return;let s=e.mentions.indexOf(o);if(s!==-1&&e.mentions.splice(s,1),o.author){let i=e.profiles.find(l=>l.pubkey===o.author);i&&i.relays&&(o.relays||(o.relays=[]),i.relays.forEach(l=>{o.relays?.indexOf(l)===-1&&o.relays.push(l)}),i.relays=o.relays)}}),e.mentions.forEach(o=>{if(o.author){let s=e.profiles.find(i=>i.pubkey===o.author);s&&s.relays&&(o.relays||(o.relays=[]),s.relays.forEach(i=>{o.relays.indexOf(i)===-1&&o.relays.push(i)}),s.relays=o.relays)}}),e}var n0={};gt(n0,{fetchRelayInformation:()=>s0,useFetchImplementation:()=>o0});var Ic;try{Ic=fetch}catch{}function o0(t){Ic=t}async function s0(t){return await(await fetch(t.replace("ws://","http://").replace("wss://","https://"),{headers:{Accept:"application/nostr+json"}})).json()}var i0={};gt(i0,{fastEventHash:()=>Bc,getPow:()=>Rc,minePow:()=>a0});function Rc(t){let e=0;for(let r=0;r<64;r+=8){const n=parseInt(t.substring(r,r+8),16);if(n===0)e+=32;else{e+=Math.clz32(n);break}}return e}function a0(t,e){let r=0;const n=t,o=["nonce",r.toString(),e.toString()];for(n.tags.push(o);;){const s=Math.floor(new Date().getTime()/1e3);if(s!==n.created_at&&(r=0,n.created_at=s),o[1]=(++r).toString(),n.id=Bc(n),Rc(n.id)>=e)break}return n}function Bc(t){return vt(tn(de.encode(JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content]))))}var l0={};gt(l0,{unwrapEvent:()=>m0,unwrapManyEvents:()=>E0,wrapEvent:()=>Mc,wrapManyEvents:()=>w0});var u0={};gt(u0,{createRumor:()=>jc,createSeal:()=>zc,createWrap:()=>Dc,unwrapEvent:()=>Wi,unwrapManyEvents:()=>Hc,wrapEvent:()=>uo,wrapManyEvents:()=>v0});var c0={};gt(c0,{decrypt:()=>Ki,encrypt:()=>Vi,getConversationKey:()=>Mi,v2:()=>g0});var _c=1,Nc=65535;function Mi(t,e){const r=Qr.getSharedSecret(t,"02"+e).subarray(1,33);return ay(tn,r,"nip44-v2")}function Tc(t,e){const r=ly(tn,t,e,76);return{chacha_key:r.subarray(0,32),chacha_nonce:r.subarray(32,44),hmac_key:r.subarray(44,76)}}function Fi(t){if(!Number.isSafeInteger(t)||t<1)throw new Error("expected positive integer");if(t<=32)return 32;const e=1<<Math.floor(Math.log2(t-1))+1,r=e<=256?32:e/8;return r*(Math.floor((t-1)/r)+1)}function f0(t){if(!Number.isSafeInteger(t)||t<_c||t>Nc)throw new Error("invalid plaintext size: must be between 1 and 65535 bytes");const e=new Uint8Array(2);return new DataView(e.buffer).setUint16(0,t,!1),e}function h0(t){const e=de.encode(t),r=e.length,n=f0(r),o=new Uint8Array(Fi(r)-r);return Lo(n,e,o)}function d0(t){const e=new DataView(t.buffer).getUint16(0),r=t.subarray(2,2+e);if(e<_c||e>Nc||r.length!==e||t.length!==2+Fi(e))throw new Error("invalid padding");return Le.decode(r)}function Lc(t,e,r){if(r.length!==32)throw new Error("AAD associated data must be 32 bytes");const n=Lo(r,e);return qo(tn,t,n)}function p0(t){if(typeof t!="string")throw new Error("payload must be a valid string");const e=t.length;if(e<132||e>87472)throw new Error("invalid payload length: "+e);if(t[0]==="#")throw new Error("unknown encryption version");let r;try{r=Pe.decode(t)}catch(s){throw new Error("invalid base64: "+s.message)}const n=r.length;if(n<99||n>65603)throw new Error("invalid data length: "+n);const o=r[0];if(o!==2)throw new Error("unknown encryption version "+o);return{nonce:r.subarray(1,33),ciphertext:r.subarray(33,-32),mac:r.subarray(-32)}}function Vi(t,e,r=Wu(32)){const{chacha_key:n,chacha_nonce:o,hmac_key:s}=Tc(e,r),i=h0(t),l=ac(n,o,i),a=Lc(s,l,r);return Pe.encode(Lo(new Uint8Array([2]),r,l,a))}function Ki(t,e){const{nonce:r,ciphertext:n,mac:o}=p0(t),{chacha_key:s,chacha_nonce:i,hmac_key:l}=Tc(e,r),a=Lc(l,n,r);if(!Hg(a,o))throw new Error("invalid MAC");const u=ac(s,i,n);return d0(u)}var g0={utils:{getConversationKey:Mi,calcPaddedLen:Fi},encrypt:Vi,decrypt:Ki},y0=2*24*60*60,Cc=()=>Math.round(Date.now()/1e3),qc=()=>Math.round(Cc()-Math.random()*y0),Uc=(t,e)=>Mi(t,e),Pc=(t,e,r)=>Vi(JSON.stringify(t),Uc(e,r)),Ja=(t,e)=>JSON.parse(Ki(t.content,Uc(e,t.pubkey)));function jc(t,e){const r={created_at:Cc(),content:"",tags:[],...t,pubkey:_i(e)};return r.id=Mn(r),r}function zc(t,e,r){return Se({kind:dc,content:Pc(t,e,r),created_at:qc(),tags:[]},e)}function Dc(t,e){const r=by();return Se({kind:mc,content:Pc(t,r,e),created_at:qc(),tags:[["p",e]]},r)}function uo(t,e,r){const n=jc(t,e),o=zc(n,e,r);return Dc(o,r)}function v0(t,e,r){if(!r||r.length===0)throw new Error("At least one recipient is required.");const n=_i(e),o=[uo(t,e,n)];return r.forEach(s=>{o.push(uo(t,e,s))}),o}function Wi(t,e){const r=Ja(t,e);return Ja(r,e)}function Hc(t,e){let r=[];return t.forEach(n=>{r.push(Wi(n,e))}),r.sort((n,o)=>n.created_at-o.created_at),r}function b0(t,e,r,n){const o={created_at:Math.ceil(Date.now()/1e3),kind:pc,tags:[],content:e};return(Array.isArray(t)?t:[t]).forEach(({publicKey:s,relayUrl:i})=>{o.tags.push(i?["p",s,i]:["p",s])}),n&&o.tags.push(["e",n.eventId,n.relayUrl||"","reply"]),r&&o.tags.push(["subject",r]),o}function Mc(t,e,r,n,o){const s=b0(e,r,n,o);return uo(s,t,e.publicKey)}function w0(t,e,r,n,o){if(!e||e.length===0)throw new Error("At least one recipient is required.");return[{publicKey:_i(t)},...e].map(s=>Mc(t,s,r,n,o))}var m0=Wi,E0=Hc,x0={};gt(x0,{finishRepostEvent:()=>k0,getRepostedEvent:()=>$0,getRepostedEventPointer:()=>Fc});function k0(t,e,r,n){let o;const s=[...t.tags??[],["e",e.id,r],["p",e.pubkey]];return e.kind===hc?o=Ci:(o=Ui,s.push(["k",String(e.kind)])),Se({kind:o,tags:s,content:t.content===""||e.tags?.find(i=>i[0]==="-")?"":JSON.stringify(e),created_at:t.created_at},n)}function Fc(t){if(![Ci,Ui].includes(t.kind))return;let e,r;for(let n=t.tags.length-1;n>=0&&(e===void 0||r===void 0);n--){const o=t.tags[n];o.length>=2&&(o[0]==="e"&&e===void 0?e=o:o[0]==="p"&&r===void 0&&(r=o))}if(e!==void 0)return{id:e[1],relays:[e[2],r?.[2]].filter(n=>typeof n=="string"),author:r?.[1]}}function $0(t,{skipVerification:e}={}){const r=Fc(t);if(r===void 0||t.content==="")return;let n;try{n=JSON.parse(t.content)}catch{return}if(n.id===r.id&&!(!e&&!Ni(n)))return n}var A0={};gt(A0,{NOSTR_URI_REGEX:()=>Zi,parse:()=>O0,test:()=>S0});var Zi=new RegExp(`nostr:(${$c.source})`);function S0(t){return typeof t=="string"&&new RegExp(`^${Zi.source}$`).test(t)}function O0(t){const e=t.match(new RegExp(`^${Zi.source}$`));if(!e)throw new Error(`Invalid Nostr URI: ${t}`);return{uri:e[0],value:e[1],decoded:Po(e[1])}}var I0={};gt(I0,{finishReactionEvent:()=>R0,getReactedEventPointer:()=>B0});function R0(t,e,r){const n=e.tags.filter(o=>o.length>=2&&(o[0]==="e"||o[0]==="p"));return Se({...t,kind:qi,tags:[...t.tags??[],...n,["e",e.id],["p",e.pubkey]],content:t.content??"+"},r)}function B0(t){if(t.kind!==qi)return;let e,r;for(let n=t.tags.length-1;n>=0&&(e===void 0||r===void 0);n--){const o=t.tags[n];o.length>=2&&(o[0]==="e"&&e===void 0?e=o:o[0]==="p"&&r===void 0&&(r=o))}if(!(e===void 0||r===void 0))return{id:e[1],relays:[e[2],r[2]].filter(n=>n!==void 0),author:r[1]}}var _0={};gt(_0,{parse:()=>T0});var N0=/\W/m,Xa=/\W |\W$|$|,| /m;function*T0(t){const e=t.length;let r=0,n=0;for(;n<e;){let o=t.indexOf(":",n);if(o===-1)break;if(t.substring(o-5,o)==="nostr"){const s=t.substring(o+60).match(N0),i=s?o+60+s.index:e;try{let l,{data:a,type:u}=Po(t.substring(o+1,i));switch(u){case"npub":l={pubkey:a};break;case"nsec":case"note":n=i+1;continue;default:l=a}r!==o-5&&(yield{type:"text",text:t.substring(r,o-5)}),yield{type:"reference",pointer:l},n=i,r=n;continue}catch{n=o+1;continue}}else if(t.substring(o-5,o)==="https"||t.substring(o-4,o)==="http"){const s=t.substring(o+4).match(Xa),i=s?o+4+s.index:e,l=t[o-1]==="s"?5:4;try{let a=new URL(t.substring(o-l,i));if(a.hostname.indexOf(".")===-1)throw new Error("invalid url");if(r!==o-l&&(yield{type:"text",text:t.substring(r,o-l)}),a.pathname.endsWith(".png")||a.pathname.endsWith(".jpg")||a.pathname.endsWith(".jpeg")||a.pathname.endsWith(".gif")||a.pathname.endsWith(".webp")){yield{type:"image",url:a.toString()},n=i,r=n;continue}if(a.pathname.endsWith(".mp4")||a.pathname.endsWith(".avi")||a.pathname.endsWith(".webm")||a.pathname.endsWith(".mkv")){yield{type:"video",url:a.toString()},n=i,r=n;continue}if(a.pathname.endsWith(".mp3")||a.pathname.endsWith(".aac")||a.pathname.endsWith(".ogg")||a.pathname.endsWith(".opus")){yield{type:"audio",url:a.toString()},n=i,r=n;continue}yield{type:"url",url:a.toString()},n=i,r=n;continue}catch{n=i+1;continue}}else if(t.substring(o-3,o)==="wss"||t.substring(o-2,o)==="ws"){const s=t.substring(o+4).match(Xa),i=s?o+4+s.index:e,l=t[o-1]==="s"?3:2;try{let a=new URL(t.substring(o-l,i));if(a.hostname.indexOf(".")===-1)throw new Error("invalid ws url");r!==o-l&&(yield{type:"text",text:t.substring(r,o-l)}),yield{type:"relay",url:a.toString()},n=i,r=n;continue}catch{n=i+1;continue}}else{n=o+1;continue}}r!==e&&(yield{type:"text",text:t.substring(r)})}var L0={};gt(L0,{channelCreateEvent:()=>C0,channelHideMessageEvent:()=>P0,channelMessageEvent:()=>U0,channelMetadataEvent:()=>q0,channelMuteUserEvent:()=>j0});var C0=(t,e)=>{let r;if(typeof t.content=="object")r=JSON.stringify(t.content);else if(typeof t.content=="string")r=t.content;else return;return Se({kind:gc,tags:[...t.tags??[]],content:r,created_at:t.created_at},e)},q0=(t,e)=>{let r;if(typeof t.content=="object")r=JSON.stringify(t.content);else if(typeof t.content=="string")r=t.content;else return;return Se({kind:yc,tags:[["e",t.channel_create_event_id],...t.tags??[]],content:r,created_at:t.created_at},e)},U0=(t,e)=>{const r=[["e",t.channel_create_event_id,t.relay_url,"root"]];return t.reply_to_channel_message_event_id&&r.push(["e",t.reply_to_channel_message_event_id,t.relay_url,"reply"]),Se({kind:vc,tags:[...r,...t.tags??[]],content:t.content,created_at:t.created_at},e)},P0=(t,e)=>{let r;if(typeof t.content=="object")r=JSON.stringify(t.content);else if(typeof t.content=="string")r=t.content;else return;return Se({kind:bc,tags:[["e",t.channel_message_event_id],...t.tags??[]],content:r,created_at:t.created_at},e)},j0=(t,e)=>{let r;if(typeof t.content=="object")r=JSON.stringify(t.content);else if(typeof t.content=="string")r=t.content;else return;return Se({kind:wc,tags:[["p",t.pubkey_to_mute],...t.tags??[]],content:r,created_at:t.created_at},e)},z0={};gt(z0,{EMOJI_SHORTCODE_REGEX:()=>Vc,matchAll:()=>D0,regex:()=>Gi,replaceAll:()=>H0});var Vc=/:(\w+):/,Gi=()=>new RegExp(`\\B${Vc.source}\\B`,"g");function*D0(t){const e=t.matchAll(Gi());for(const r of e)try{const[n,o]=r;yield{shortcode:n,name:o,start:r.index,end:r.index+n.length}}catch{}}function H0(t,e){return t.replaceAll(Gi(),(r,n)=>e({shortcode:r,name:n}))}var M0={};gt(M0,{useFetchImplementation:()=>F0,validateGithub:()=>V0});var Yi;try{Yi=fetch}catch{}function F0(t){Yi=t}async function V0(t,e,r){try{return await(await Yi(`https://gist.github.com/${e}/${r}/raw`)).text()===`Verifying that I control the following Nostr public key: ${t}`}catch{return!1}}var K0={};gt(K0,{makeNwcRequestEvent:()=>Z0,parseConnectionString:()=>W0});function W0(t){const{pathname:e,searchParams:r}=new URL(t),n=e,o=r.get("relay"),s=r.get("secret");if(!n||!o||!s)throw new Error("invalid connection string");return{pubkey:n,relay:o,secret:s}}async function Z0(t,e,r){const n=Ac(e,t,JSON.stringify({method:"pay_invoice",params:{invoice:r}})),o={kind:xc,created_at:Math.round(Date.now()/1e3),content:n,tags:[["p",t]]};return Se(o,e)}var G0={};gt(G0,{normalizeIdentifier:()=>Y0});function Y0(t){return t=t.trim().toLowerCase(),t=t.normalize("NFKC"),Array.from(t).map(e=>new RegExp("\\p{Letter}","u").test(e)||new RegExp("\\p{Number}","u").test(e)?e:"-").join("")}var J0={};gt(J0,{getSatoshisAmountFromBolt11:()=>nb,getZapEndpoint:()=>Q0,makeZapReceipt:()=>rb,makeZapRequest:()=>tb,useFetchImplementation:()=>X0,validateZapRequest:()=>eb});var Ji;try{Ji=fetch}catch{}function X0(t){Ji=t}async function Q0(t){try{let e="",{lud06:r,lud16:n}=JSON.parse(t.content);if(r){let{words:s}=fr.decode(r,1e3),i=fr.fromWords(s);e=Le.decode(i)}else if(n){let[s,i]=n.split("@");e=new URL(`/.well-known/lnurlp/${s}`,`https://${i}`).toString()}else return null;let o=await(await Ji(e)).json();if(o.allowsNostr&&o.nostrPubkey)return o.callback}catch{}return null}function tb({profile:t,event:e,amount:r,relays:n,comment:o=""}){if(!r)throw new Error("amount not given");if(!t)throw new Error("profile not given");let s={kind:9734,created_at:Math.round(Date.now()/1e3),content:o,tags:[["p",t],["amount",r.toString()],["relays",...n]]};if(e&&typeof e=="string"&&s.tags.push(["e",e]),e&&typeof e=="object"){if(Ti(e.kind)){const i=["a",`${e.kind}:${e.pubkey}:`];s.tags.push(i)}else if(Li(e.kind)){let i=e.tags.find(([a,u])=>a==="d"&&u);if(!i)throw new Error("d tag not found or is empty");const l=["a",`${e.kind}:${e.pubkey}:${i[1]}`];s.tags.push(l)}}return s}function eb(t){let e;try{e=JSON.parse(t)}catch{return"Invalid zap request JSON."}if(!Ri(e))return"Zap request is not a valid Nostr event.";if(!Ni(e))return"Invalid signature on zap request.";let r=e.tags.find(([o,s])=>o==="p"&&s);if(!r)return"Zap request doesn't have a 'p' tag.";if(!r[1].match(/^[a-f0-9]{64}$/))return"Zap request 'p' tag is not valid hex.";let n=e.tags.find(([o,s])=>o==="e"&&s);return n&&!n[1].match(/^[a-f0-9]{64}$/)?"Zap request 'e' tag is not valid hex.":e.tags.find(([o,s])=>o==="relays"&&s)?null:"Zap request doesn't have a 'relays' tag."}function rb({zapRequest:t,preimage:e,bolt11:r,paidAt:n}){let o=JSON.parse(t),s=o.tags.filter(([l])=>l==="e"||l==="p"||l==="a"),i={kind:9735,created_at:Math.round(n.getTime()/1e3),content:"",tags:[...s,["P",o.pubkey],["bolt11",r],["description",t]]};return e&&i.tags.push(["preimage",e]),i}function nb(t){if(t.length<50)return 0;t=t.substring(0,50);const e=t.lastIndexOf("1");if(e===-1)return 0;const r=t.substring(0,e);if(!r.startsWith("lnbc"))return 0;const n=r.substring(4);if(n.length<1)return 0;const o=n[n.length-1],s=o.charCodeAt(0)-48,i=s>=0&&s<=9;let l=n.length-1;if(i&&l++,l<1)return 0;const a=parseInt(n.substring(0,l));switch(o){case"m":return a*1e5;case"u":return a*100;case"n":return a/10;case"p":return a/1e4;default:return a*1e8}}var ob={};gt(ob,{getToken:()=>sb,hashPayload:()=>Xi,unpackEventFromToken:()=>Wc,validateEvent:()=>Qc,validateEventKind:()=>Gc,validateEventMethodTag:()=>Jc,validateEventPayloadTag:()=>Xc,validateEventTimestamp:()=>Zc,validateEventUrlTag:()=>Yc,validateToken:()=>ib});var Kc="Nostr ";async function sb(t,e,r,n=!1,o){const s={kind:Pi,tags:[["u",t],["method",e]],created_at:Math.round(new Date().getTime()/1e3),content:""};o&&s.tags.push(["payload",Xi(o)]);const i=await r(s);return(n?Kc:"")+Pe.encode(de.encode(JSON.stringify(i)))}async function ib(t,e,r){const n=await Wc(t).catch(o=>{throw o});return await Qc(n,e,r).catch(o=>{throw o})}async function Wc(t){if(!t)throw new Error("Missing token");t=t.replace(Kc,"");const e=Le.decode(Pe.decode(t));if(!e||e.length===0||!e.startsWith("{"))throw new Error("Invalid token");return JSON.parse(e)}function Zc(t){return t.created_at?Math.round(new Date().getTime()/1e3)-t.created_at<60:!1}function Gc(t){return t.kind===Pi}function Yc(t,e){const r=t.tags.find(n=>n[0]==="u");return r?r.length>0&&r[1]===e:!1}function Jc(t,e){const r=t.tags.find(n=>n[0]==="method");return r?r.length>0&&r[1].toLowerCase()===e.toLowerCase():!1}function Xi(t){const e=tn(de.encode(JSON.stringify(t)));return vt(e)}function Xc(t,e){const r=t.tags.find(o=>o[0]==="payload");if(!r)return!1;const n=Xi(e);return r.length>0&&r[1]===n}async function Qc(t,e,r,n){if(!Ni(t))throw new Error("Invalid nostr event, signature invalid");if(!Gc(t))throw new Error("Invalid nostr event, kind invalid");if(!Zc(t))throw new Error("Invalid nostr event, created_at timestamp invalid");if(!Yc(t,e))throw new Error("Invalid nostr event, url tag invalid");if(!Jc(t,r))throw new Error("Invalid nostr event, method tag invalid");if(n&&typeof n=="object"&&Object.keys(n).length>0&&!Xc(t,n))throw new Error("Invalid nostr event, payload tag does not match request body hash");return!0}function Qa(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function ab(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function _n(t,...e){if(!ab(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function lb(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Qa(t.outputLen),Qa(t.blockLen)}function co(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ub(t,e){_n(t);const r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}const fs=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const hs=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),ve=(t,e)=>t<<32-e|t>>>e;new Uint8Array(new Uint32Array([287454020]).buffer)[0];const cb=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ms(t){_n(t);let e="";for(let r=0;r<t.length;r++)e+=cb[t[r]];return e}function fb(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Qi(t){return typeof t=="string"&&(t=fb(t)),_n(t),t}function hb(...t){let e=0;for(let n=0;n<t.length;n++){const o=t[n];_n(o),e+=o.length}const r=new Uint8Array(e);for(let n=0,o=0;n<t.length;n++){const s=t[n];r.set(s,o),o+=s.length}return r}class tf{clone(){return this._cloneInto()}}function db(t){const e=n=>t().update(Qi(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function ef(t=32){if(fs&&typeof fs.getRandomValues=="function")return fs.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function pb(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const o=BigInt(32),s=BigInt(4294967295),i=Number(r>>o&s),l=Number(r&s),a=n?4:0,u=n?0:4;t.setUint32(e+a,i,n),t.setUint32(e+u,l,n)}const gb=(t,e,r)=>t&e^~t&r,yb=(t,e,r)=>t&e^t&r^e&r;class vb extends tf{constructor(e,r,n,o){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=hs(this.buffer)}update(e){co(this);const{view:r,buffer:n,blockLen:o}=this;e=Qi(e);const s=e.length;for(let i=0;i<s;){const l=Math.min(o-this.pos,s-i);if(l===o){const a=hs(e);for(;o<=s-i;i+=o)this.process(a,i);continue}n.set(e.subarray(i,i+l),this.pos),this.pos+=l,i+=l,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){co(this),ub(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:o,isLE:s}=this;let{pos:i}=this;r[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>o-i&&(this.process(n,0),i=0);for(let f=i;f<o;f++)r[f]=0;pb(n,o-8,BigInt(this.length*8),s),this.process(n,0);const l=hs(e),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=a/4,c=this.get();if(u>c.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<u;f++)l.setUint32(4*f,c[f],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:o,finished:s,destroyed:i,pos:l}=this;return e.length=o,e.pos=l,e.finished=s,e.destroyed=i,o%r&&e.buffer.set(n),e}}const bb=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Xe=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Qe=new Uint32Array(64);class wb extends vb{constructor(){super(64,32,8,!1),this.A=Xe[0]|0,this.B=Xe[1]|0,this.C=Xe[2]|0,this.D=Xe[3]|0,this.E=Xe[4]|0,this.F=Xe[5]|0,this.G=Xe[6]|0,this.H=Xe[7]|0}get(){const{A:e,B:r,C:n,D:o,E:s,F:i,G:l,H:a}=this;return[e,r,n,o,s,i,l,a]}set(e,r,n,o,s,i,l,a){this.A=e|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=l|0,this.H=a|0}process(e,r){for(let f=0;f<16;f++,r+=4)Qe[f]=e.getUint32(r,!1);for(let f=16;f<64;f++){const h=Qe[f-15],g=Qe[f-2],p=ve(h,7)^ve(h,18)^h>>>3,d=ve(g,17)^ve(g,19)^g>>>10;Qe[f]=d+Qe[f-7]+p+Qe[f-16]|0}let{A:n,B:o,C:s,D:i,E:l,F:a,G:u,H:c}=this;for(let f=0;f<64;f++){const h=ve(l,6)^ve(l,11)^ve(l,25),g=c+h+gb(l,a,u)+bb[f]+Qe[f]|0,p=(ve(n,2)^ve(n,13)^ve(n,22))+yb(n,o,s)|0;c=u,u=a,a=l,l=i+g|0,i=s,s=o,o=n,n=g+p|0}n=n+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,l=l+this.E|0,a=a+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(n,o,s,i,l,a,u,c)}roundClean(){Qe.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const fo=db(()=>new wb);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const rf=BigInt(0),Ho=BigInt(1),mb=BigInt(2);function Ir(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function Nn(t){if(!Ir(t))throw new Error("Uint8Array expected")}const Eb=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Jr(t){Nn(t);let e="";for(let r=0;r<t.length;r++)e+=Eb[t[r]];return e}function nf(t){const e=t.toString(16);return e.length&1?`0${e}`:e}function ta(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}const Ie={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function tl(t){if(t>=Ie._0&&t<=Ie._9)return t-Ie._0;if(t>=Ie._A&&t<=Ie._F)return t-(Ie._A-10);if(t>=Ie._a&&t<=Ie._f)return t-(Ie._a-10)}function Xr(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let o=0,s=0;o<r;o++,s+=2){const i=tl(t.charCodeAt(s)),l=tl(t.charCodeAt(s+1));if(i===void 0||l===void 0){const a=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+a+'" at index '+s)}n[o]=i*16+l}return n}function Dt(t){return ta(Jr(t))}function ea(t){return Nn(t),ta(Jr(Uint8Array.from(t).reverse()))}function hr(t,e){return Xr(t.toString(16).padStart(e*2,"0"))}function ra(t,e){return hr(t,e).reverse()}function xb(t){return Xr(nf(t))}function qt(t,e,r){let n;if(typeof e=="string")try{n=Xr(e)}catch(s){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${s}`)}else if(Ir(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);const o=n.length;if(typeof r=="number"&&o!==r)throw new Error(`${t} expected ${r} bytes, got ${o}`);return n}function Rr(...t){let e=0;for(let n=0;n<t.length;n++){const o=t[n];Nn(o),e+=o.length}const r=new Uint8Array(e);for(let n=0,o=0;n<t.length;n++){const s=t[n];r.set(s,o),o+=s.length}return r}function kb(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}function $b(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Ab(t){let e;for(e=0;t>rf;t>>=Ho,e+=1);return e}function Sb(t,e){return t>>BigInt(e)&Ho}function Ob(t,e,r){return t|(r?Ho:rf)<<BigInt(e)}const na=t=>(mb<<BigInt(t-1))-Ho,ds=t=>new Uint8Array(t),el=t=>Uint8Array.from(t);function of(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=ds(t),o=ds(t),s=0;const i=()=>{n.fill(1),o.fill(0),s=0},l=(...c)=>r(o,n,...c),a=(c=ds())=>{o=l(el([0]),c),n=l(),c.length!==0&&(o=l(el([1]),c),n=l())},u=()=>{if(s++>=1e3)throw new Error("drbg: tried 1000 values");let c=0;const f=[];for(;c<e;){n=l();const h=n.slice();f.push(h),c+=n.length}return Rr(...f)};return(c,f)=>{i(),a(c);let h;for(;!(h=f(u()));)a();return i(),h}}const Ib={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||Ir(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Tn(t,e,r={}){const n=(o,s,i)=>{const l=Ib[s];if(typeof l!="function")throw new Error(`Invalid validator "${s}", expected function`);const a=t[o];if(!(i&&a===void 0)&&!l(a,t))throw new Error(`Invalid param ${String(o)}=${a} (${typeof a}), expected ${s}`)};for(const[o,s]of Object.entries(e))n(o,s,!1);for(const[o,s]of Object.entries(r))n(o,s,!0);return t}const Rb=Object.freeze(Object.defineProperty({__proto__:null,abytes:Nn,bitGet:Sb,bitLen:Ab,bitMask:na,bitSet:Ob,bytesToHex:Jr,bytesToNumberBE:Dt,bytesToNumberLE:ea,concatBytes:Rr,createHmacDrbg:of,ensureBytes:qt,equalBytes:kb,hexToBytes:Xr,hexToNumber:ta,isBytes:Ir,numberToBytesBE:hr,numberToBytesLE:ra,numberToHexUnpadded:nf,numberToVarBytesBE:xb,utf8ToBytes:$b,validateObject:Tn},Symbol.toStringTag,{value:"Module"}));/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Rt=BigInt(0),xt=BigInt(1),yr=BigInt(2),Bb=BigInt(3),Fs=BigInt(4),rl=BigInt(5),nl=BigInt(8);BigInt(9);BigInt(16);function Nt(t,e){const r=t%e;return r>=Rt?r:e+r}function _b(t,e,r){if(r<=Rt||e<Rt)throw new Error("Expected power/modulo > 0");if(r===xt)return Rt;let n=xt;for(;e>Rt;)e&xt&&(n=n*t%r),t=t*t%r,e>>=xt;return n}function Qt(t,e,r){let n=t;for(;e-- >Rt;)n*=n,n%=r;return n}function Vs(t,e){if(t===Rt||e<=Rt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=Nt(t,e),n=e,o=Rt,s=xt;for(;r!==Rt;){const i=n/r,l=n%r,a=o-s*i;n=r,r=l,o=s,s=a}if(n!==xt)throw new Error("invert: does not exist");return Nt(o,e)}function Nb(t){const e=(t-xt)/yr;let r,n,o;for(r=t-xt,n=0;r%yr===Rt;r/=yr,n++);for(o=yr;o<t&&_b(o,e,t)!==t-xt;o++);if(n===1){const i=(t+xt)/Fs;return function(l,a){const u=l.pow(a,i);if(!l.eql(l.sqr(u),a))throw new Error("Cannot find square root");return u}}const s=(r+xt)/yr;return function(i,l){if(i.pow(l,e)===i.neg(i.ONE))throw new Error("Cannot find square root");let a=n,u=i.pow(i.mul(i.ONE,o),r),c=i.pow(l,s),f=i.pow(l,r);for(;!i.eql(f,i.ONE);){if(i.eql(f,i.ZERO))return i.ZERO;let h=1;for(let p=i.sqr(f);h<a&&!i.eql(p,i.ONE);h++)p=i.sqr(p);const g=i.pow(u,xt<<BigInt(a-h-1));u=i.sqr(g),c=i.mul(c,g),f=i.mul(f,u),a=h}return c}}function Tb(t){if(t%Fs===Bb){const e=(t+xt)/Fs;return function(r,n){const o=r.pow(n,e);if(!r.eql(r.sqr(o),n))throw new Error("Cannot find square root");return o}}if(t%nl===rl){const e=(t-rl)/nl;return function(r,n){const o=r.mul(n,yr),s=r.pow(o,e),i=r.mul(n,s),l=r.mul(r.mul(i,yr),s),a=r.mul(i,r.sub(l,r.ONE));if(!r.eql(r.sqr(a),n))throw new Error("Cannot find square root");return a}}return Nb(t)}const Lb=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Cb(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Lb.reduce((n,o)=>(n[o]="function",n),e);return Tn(t,r)}function qb(t,e,r){if(r<Rt)throw new Error("Expected power > 0");if(r===Rt)return t.ONE;if(r===xt)return e;let n=t.ONE,o=e;for(;r>Rt;)r&xt&&(n=t.mul(n,o)),o=t.sqr(o),r>>=xt;return n}function Ub(t,e){const r=new Array(e.length),n=e.reduce((s,i,l)=>t.is0(i)?s:(r[l]=s,t.mul(s,i)),t.ONE),o=t.inv(n);return e.reduceRight((s,i,l)=>t.is0(i)?s:(r[l]=t.mul(s,r[l]),t.mul(s,i)),o),r}function sf(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Pb(t,e,r=!1,n={}){if(t<=Rt)throw new Error(`Expected Field ORDER > 0, got ${t}`);const{nBitLength:o,nByteLength:s}=sf(t,e);if(s>2048)throw new Error("Field lengths over 2048 bytes are not supported");const i=Tb(t),l=Object.freeze({ORDER:t,BITS:o,BYTES:s,MASK:na(o),ZERO:Rt,ONE:xt,create:a=>Nt(a,t),isValid:a=>{if(typeof a!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof a}`);return Rt<=a&&a<t},is0:a=>a===Rt,isOdd:a=>(a&xt)===xt,neg:a=>Nt(-a,t),eql:(a,u)=>a===u,sqr:a=>Nt(a*a,t),add:(a,u)=>Nt(a+u,t),sub:(a,u)=>Nt(a-u,t),mul:(a,u)=>Nt(a*u,t),pow:(a,u)=>qb(l,a,u),div:(a,u)=>Nt(a*Vs(u,t),t),sqrN:a=>a*a,addN:(a,u)=>a+u,subN:(a,u)=>a-u,mulN:(a,u)=>a*u,inv:a=>Vs(a,t),sqrt:n.sqrt||(a=>i(l,a)),invertBatch:a=>Ub(l,a),cmov:(a,u,c)=>c?u:a,toBytes:a=>r?ra(a,s):hr(a,s),fromBytes:a=>{if(a.length!==s)throw new Error(`Fp.fromBytes: expected ${s}, got ${a.length}`);return r?ea(a):Dt(a)}});return Object.freeze(l)}function af(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function lf(t){const e=af(t);return e+Math.ceil(e/2)}function jb(t,e,r=!1){const n=t.length,o=af(e),s=lf(e);if(n<16||n<s||n>1024)throw new Error(`expected ${s}-1024 bytes of input, got ${n}`);const i=r?Dt(t):ea(t),l=Nt(i,e-xt)+xt;return r?ra(l,o):hr(l,o)}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const zb=BigInt(0),ps=BigInt(1);function Db(t,e){const r=(o,s)=>{const i=s.negate();return o?i:s},n=o=>{const s=Math.ceil(e/o)+1,i=2**(o-1);return{windows:s,windowSize:i}};return{constTimeNegate:r,unsafeLadder(o,s){let i=t.ZERO,l=o;for(;s>zb;)s&ps&&(i=i.add(l)),l=l.double(),s>>=ps;return i},precomputeWindow(o,s){const{windows:i,windowSize:l}=n(s),a=[];let u=o,c=u;for(let f=0;f<i;f++){c=u,a.push(c);for(let h=1;h<l;h++)c=c.add(u),a.push(c);u=c.double()}return a},wNAF(o,s,i){const{windows:l,windowSize:a}=n(o);let u=t.ZERO,c=t.BASE;const f=BigInt(2**o-1),h=2**o,g=BigInt(o);for(let p=0;p<l;p++){const d=p*a;let y=Number(i&f);i>>=g,y>a&&(y-=h,i+=ps);const v=d,x=d+Math.abs(y)-1,m=p%2!==0,R=y<0;y===0?c=c.add(r(m,s[v])):u=u.add(r(R,s[x]))}return{p:u,f:c}},wNAFCached(o,s,i,l){const a=o._WINDOW_SIZE||1;let u=s.get(o);return u||(u=this.precomputeWindow(o,a),a!==1&&s.set(o,l(u))),this.wNAF(a,u,i)}}}function uf(t){return Cb(t.Fp),Tn(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...sf(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Hb(t){const e=uf(t);Tn(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:o}=e;if(r){if(!n.eql(o,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}const{bytesToNumberBE:Mb,hexToBytes:Fb}=Rb,br={Err:class extends Error{constructor(t=""){super(t)}},_parseInt(t){const{Err:e}=br;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");const r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Mb(n),l:t.subarray(r+2)}},toSig(t){const{Err:e}=br,r=typeof t=="string"?Fb(t):t;Nn(r);let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");const{d:o,l:s}=br._parseInt(r.subarray(2)),{d:i,l}=br._parseInt(s);if(l.length)throw new e("Invalid signature: left bytes after parsing");return{r:o,s:i}},hexFromSig(t){const e=u=>Number.parseInt(u[0],16)&8?"00"+u:u,r=u=>{const c=u.toString(16);return c.length&1?`0${c}`:c},n=e(r(t.s)),o=e(r(t.r)),s=n.length/2,i=o.length/2,l=r(s),a=r(i);return`30${r(i+s+4)}02${a}${o}02${l}${n}`}},Ne=BigInt(0),ne=BigInt(1);BigInt(2);const ol=BigInt(3);BigInt(4);function Vb(t){const e=Hb(t),{Fp:r}=e,n=e.toBytes||((p,d,y)=>{const v=d.toAffine();return Rr(Uint8Array.from([4]),r.toBytes(v.x),r.toBytes(v.y))}),o=e.fromBytes||(p=>{const d=p.subarray(1),y=r.fromBytes(d.subarray(0,r.BYTES)),v=r.fromBytes(d.subarray(r.BYTES,2*r.BYTES));return{x:y,y:v}});function s(p){const{a:d,b:y}=e,v=r.sqr(p),x=r.mul(v,p);return r.add(r.add(x,r.mul(p,d)),y)}if(!r.eql(r.sqr(e.Gy),s(e.Gx)))throw new Error("bad generator point: equation left != right");function i(p){return typeof p=="bigint"&&Ne<p&&p<e.n}function l(p){if(!i(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function a(p){const{allowedPrivateKeyLengths:d,nByteLength:y,wrapPrivateKey:v,n:x}=e;if(d&&typeof p!="bigint"){if(Ir(p)&&(p=Jr(p)),typeof p!="string"||!d.includes(p.length))throw new Error("Invalid key");p=p.padStart(y*2,"0")}let m;try{m=typeof p=="bigint"?p:Dt(qt("private key",p,y))}catch{throw new Error(`private key must be ${y} bytes, hex or bigint, not ${typeof p}`)}return v&&(m=Nt(m,x)),l(m),m}const u=new Map;function c(p){if(!(p instanceof f))throw new Error("ProjectivePoint expected")}class f{constructor(d,y,v){if(this.px=d,this.py=y,this.pz=v,d==null||!r.isValid(d))throw new Error("x required");if(y==null||!r.isValid(y))throw new Error("y required");if(v==null||!r.isValid(v))throw new Error("z required")}static fromAffine(d){const{x:y,y:v}=d||{};if(!d||!r.isValid(y)||!r.isValid(v))throw new Error("invalid affine point");if(d instanceof f)throw new Error("projective point not allowed");const x=m=>r.eql(m,r.ZERO);return x(y)&&x(v)?f.ZERO:new f(y,v,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(d){const y=r.invertBatch(d.map(v=>v.pz));return d.map((v,x)=>v.toAffine(y[x])).map(f.fromAffine)}static fromHex(d){const y=f.fromAffine(o(qt("pointHex",d)));return y.assertValidity(),y}static fromPrivateKey(d){return f.BASE.multiply(a(d))}_setWindowSize(d){this._WINDOW_SIZE=d,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}const{x:d,y}=this.toAffine();if(!r.isValid(d)||!r.isValid(y))throw new Error("bad point: x or y not FE");const v=r.sqr(y),x=s(d);if(!r.eql(v,x))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){const{y:d}=this.toAffine();if(r.isOdd)return!r.isOdd(d);throw new Error("Field doesn't support isOdd")}equals(d){c(d);const{px:y,py:v,pz:x}=this,{px:m,py:R,pz:I}=d,w=r.eql(r.mul(y,I),r.mul(m,x)),S=r.eql(r.mul(v,I),r.mul(R,x));return w&&S}negate(){return new f(this.px,r.neg(this.py),this.pz)}double(){const{a:d,b:y}=e,v=r.mul(y,ol),{px:x,py:m,pz:R}=this;let I=r.ZERO,w=r.ZERO,S=r.ZERO,_=r.mul(x,x),T=r.mul(m,m),$=r.mul(R,R),B=r.mul(x,m);return B=r.add(B,B),S=r.mul(x,R),S=r.add(S,S),I=r.mul(d,S),w=r.mul(v,$),w=r.add(I,w),I=r.sub(T,w),w=r.add(T,w),w=r.mul(I,w),I=r.mul(B,I),S=r.mul(v,S),$=r.mul(d,$),B=r.sub(_,$),B=r.mul(d,B),B=r.add(B,S),S=r.add(_,_),_=r.add(S,_),_=r.add(_,$),_=r.mul(_,B),w=r.add(w,_),$=r.mul(m,R),$=r.add($,$),_=r.mul($,B),I=r.sub(I,_),S=r.mul($,T),S=r.add(S,S),S=r.add(S,S),new f(I,w,S)}add(d){c(d);const{px:y,py:v,pz:x}=this,{px:m,py:R,pz:I}=d;let w=r.ZERO,S=r.ZERO,_=r.ZERO;const T=e.a,$=r.mul(e.b,ol);let B=r.mul(y,m),P=r.mul(v,R),U=r.mul(x,I),z=r.add(y,v),b=r.add(m,R);z=r.mul(z,b),b=r.add(B,P),z=r.sub(z,b),b=r.add(y,x);let E=r.add(m,I);return b=r.mul(b,E),E=r.add(B,U),b=r.sub(b,E),E=r.add(v,x),w=r.add(R,I),E=r.mul(E,w),w=r.add(P,U),E=r.sub(E,w),_=r.mul(T,b),w=r.mul($,U),_=r.add(w,_),w=r.sub(P,_),_=r.add(P,_),S=r.mul(w,_),P=r.add(B,B),P=r.add(P,B),U=r.mul(T,U),b=r.mul($,b),P=r.add(P,U),U=r.sub(B,U),U=r.mul(T,U),b=r.add(b,U),B=r.mul(P,b),S=r.add(S,B),B=r.mul(E,b),w=r.mul(z,w),w=r.sub(w,B),B=r.mul(z,P),_=r.mul(E,_),_=r.add(_,B),new f(w,S,_)}subtract(d){return this.add(d.negate())}is0(){return this.equals(f.ZERO)}wNAF(d){return g.wNAFCached(this,u,d,y=>{const v=r.invertBatch(y.map(x=>x.pz));return y.map((x,m)=>x.toAffine(v[m])).map(f.fromAffine)})}multiplyUnsafe(d){const y=f.ZERO;if(d===Ne)return y;if(l(d),d===ne)return this;const{endo:v}=e;if(!v)return g.unsafeLadder(this,d);let{k1neg:x,k1:m,k2neg:R,k2:I}=v.splitScalar(d),w=y,S=y,_=this;for(;m>Ne||I>Ne;)m&ne&&(w=w.add(_)),I&ne&&(S=S.add(_)),_=_.double(),m>>=ne,I>>=ne;return x&&(w=w.negate()),R&&(S=S.negate()),S=new f(r.mul(S.px,v.beta),S.py,S.pz),w.add(S)}multiply(d){l(d);let y=d,v,x;const{endo:m}=e;if(m){const{k1neg:R,k1:I,k2neg:w,k2:S}=m.splitScalar(y);let{p:_,f:T}=this.wNAF(I),{p:$,f:B}=this.wNAF(S);_=g.constTimeNegate(R,_),$=g.constTimeNegate(w,$),$=new f(r.mul($.px,m.beta),$.py,$.pz),v=_.add($),x=T.add(B)}else{const{p:R,f:I}=this.wNAF(y);v=R,x=I}return f.normalizeZ([v,x])[0]}multiplyAndAddUnsafe(d,y,v){const x=f.BASE,m=(I,w)=>w===Ne||w===ne||!I.equals(x)?I.multiplyUnsafe(w):I.multiply(w),R=m(this,y).add(m(d,v));return R.is0()?void 0:R}toAffine(d){const{px:y,py:v,pz:x}=this,m=this.is0();d==null&&(d=m?r.ONE:r.inv(x));const R=r.mul(y,d),I=r.mul(v,d),w=r.mul(x,d);if(m)return{x:r.ZERO,y:r.ZERO};if(!r.eql(w,r.ONE))throw new Error("invZ was invalid");return{x:R,y:I}}isTorsionFree(){const{h:d,isTorsionFree:y}=e;if(d===ne)return!0;if(y)return y(f,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:d,clearCofactor:y}=e;return d===ne?this:y?y(f,this):this.multiplyUnsafe(e.h)}toRawBytes(d=!0){return this.assertValidity(),n(f,this,d)}toHex(d=!0){return Jr(this.toRawBytes(d))}}f.BASE=new f(e.Gx,e.Gy,r.ONE),f.ZERO=new f(r.ZERO,r.ONE,r.ZERO);const h=e.nBitLength,g=Db(f,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:f,normPrivateKeyToScalar:a,weierstrassEquation:s,isWithinCurveOrder:i}}function Kb(t){const e=uf(t);return Tn(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Wb(t){const e=Kb(t),{Fp:r,n}=e,o=r.BYTES+1,s=2*r.BYTES+1;function i(b){return Ne<b&&b<r.ORDER}function l(b){return Nt(b,n)}function a(b){return Vs(b,n)}const{ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:f,isWithinCurveOrder:h}=Vb({...e,toBytes(b,E,O){const A=E.toAffine(),N=r.toBytes(A.x),L=Rr;return O?L(Uint8Array.from([E.hasEvenY()?2:3]),N):L(Uint8Array.from([4]),N,r.toBytes(A.y))},fromBytes(b){const E=b.length,O=b[0],A=b.subarray(1);if(E===o&&(O===2||O===3)){const N=Dt(A);if(!i(N))throw new Error("Point is not on curve");const L=f(N);let C;try{C=r.sqrt(L)}catch(Y){const lt=Y instanceof Error?": "+Y.message:"";throw new Error("Point is not on curve"+lt)}const M=(C&ne)===ne;return(O&1)===1!==M&&(C=r.neg(C)),{x:N,y:C}}else if(E===s&&O===4){const N=r.fromBytes(A.subarray(0,r.BYTES)),L=r.fromBytes(A.subarray(r.BYTES,2*r.BYTES));return{x:N,y:L}}else throw new Error(`Point of length ${E} was invalid. Expected ${o} compressed bytes or ${s} uncompressed bytes`)}}),g=b=>Jr(hr(b,e.nByteLength));function p(b){const E=n>>ne;return b>E}function d(b){return p(b)?l(-b):b}const y=(b,E,O)=>Dt(b.slice(E,O));class v{constructor(E,O,A){this.r=E,this.s=O,this.recovery=A,this.assertValidity()}static fromCompact(E){const O=e.nByteLength;return E=qt("compactSignature",E,O*2),new v(y(E,0,O),y(E,O,2*O))}static fromDER(E){const{r:O,s:A}=br.toSig(qt("DER",E));return new v(O,A)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(E){return new v(this.r,this.s,E)}recoverPublicKey(E){const{r:O,s:A,recovery:N}=this,L=S(qt("msgHash",E));if(N==null||![0,1,2,3].includes(N))throw new Error("recovery id invalid");const C=N===2||N===3?O+e.n:O;if(C>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");const M=N&1?"03":"02",Y=u.fromHex(M+g(C)),lt=a(C),bt=l(-L*lt),pt=l(A*lt),wt=u.BASE.multiplyAndAddUnsafe(Y,bt,pt);if(!wt)throw new Error("point at infinify");return wt.assertValidity(),wt}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new v(this.r,l(-this.s),this.recovery):this}toDERRawBytes(){return Xr(this.toDERHex())}toDERHex(){return br.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Xr(this.toCompactHex())}toCompactHex(){return g(this.r)+g(this.s)}}const x={isValidPrivateKey(b){try{return c(b),!0}catch{return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{const b=lf(e.n);return jb(e.randomBytes(b),e.n)},precompute(b=8,E=u.BASE){return E._setWindowSize(b),E.multiply(BigInt(3)),E}};function m(b,E=!0){return u.fromPrivateKey(b).toRawBytes(E)}function R(b){const E=Ir(b),O=typeof b=="string",A=(E||O)&&b.length;return E?A===o||A===s:O?A===2*o||A===2*s:b instanceof u}function I(b,E,O=!0){if(R(b))throw new Error("first arg must be private key");if(!R(E))throw new Error("second arg must be public key");return u.fromHex(E).multiply(c(b)).toRawBytes(O)}const w=e.bits2int||function(b){const E=Dt(b),O=b.length*8-e.nBitLength;return O>0?E>>BigInt(O):E},S=e.bits2int_modN||function(b){return l(w(b))},_=na(e.nBitLength);function T(b){if(typeof b!="bigint")throw new Error("bigint expected");if(!(Ne<=b&&b<_))throw new Error(`bigint expected < 2^${e.nBitLength}`);return hr(b,e.nByteLength)}function $(b,E,O=B){if(["recovered","canonical"].some(G=>G in O))throw new Error("sign() legacy options not supported");const{hash:A,randomBytes:N}=e;let{lowS:L,prehash:C,extraEntropy:M}=O;L==null&&(L=!0),b=qt("msgHash",b),C&&(b=qt("prehashed msgHash",A(b)));const Y=S(b),lt=c(E),bt=[T(lt),T(Y)];if(M!=null&&M!==!1){const G=M===!0?N(r.BYTES):M;bt.push(qt("extraEntropy",G))}const pt=Rr(...bt),wt=Y;function W(G){const et=w(G);if(!h(et))return;const nt=a(et),ct=u.BASE.multiply(et).toAffine(),dt=l(ct.x);if(dt===Ne)return;const ot=l(nt*l(wt+dt*lt));if(ot===Ne)return;let Kt=(ct.x===dt?0:2)|Number(ct.y&ne),le=ot;return L&&p(ot)&&(le=d(ot),Kt^=1),new v(dt,le,Kt)}return{seed:pt,k2sig:W}}const B={lowS:e.lowS,prehash:!1},P={lowS:e.lowS,prehash:!1};function U(b,E,O=B){const{seed:A,k2sig:N}=$(b,E,O),L=e;return of(L.hash.outputLen,L.nByteLength,L.hmac)(A,N)}u.BASE._setWindowSize(8);function z(b,E,O,A=P){var N;const L=b;if(E=qt("msgHash",E),O=qt("publicKey",O),"strict"in A)throw new Error("options.strict was renamed to lowS");const{lowS:C,prehash:M}=A;let Y,lt;try{if(typeof L=="string"||Ir(L))try{Y=v.fromDER(L)}catch(ct){if(!(ct instanceof br.Err))throw ct;Y=v.fromCompact(L)}else if(typeof L=="object"&&typeof L.r=="bigint"&&typeof L.s=="bigint"){const{r:ct,s:dt}=L;Y=new v(ct,dt)}else throw new Error("PARSE");lt=u.fromHex(O)}catch(ct){if(ct.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(C&&Y.hasHighS())return!1;M&&(E=e.hash(E));const{r:bt,s:pt}=Y,wt=S(E),W=a(pt),G=l(wt*W),et=l(bt*W),nt=(N=u.BASE.multiplyAndAddUnsafe(lt,G,et))==null?void 0:N.toAffine();return nt?l(nt.x)===bt:!1}return{CURVE:e,getPublicKey:m,getSharedSecret:I,sign:U,verify:z,ProjectivePoint:u,Signature:v,utils:x}}class cf extends tf{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,lb(e);const n=Qi(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const o=this.blockLen,s=new Uint8Array(o);s.set(n.length>o?e.create().update(n).digest():n);for(let i=0;i<s.length;i++)s[i]^=54;this.iHash.update(s),this.oHash=e.create();for(let i=0;i<s.length;i++)s[i]^=106;this.oHash.update(s),s.fill(0)}update(e){return co(this),this.iHash.update(e),this}digestInto(e){co(this),_n(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:n,finished:o,destroyed:s,blockLen:i,outputLen:l}=this;return e=e,e.finished=o,e.destroyed=s,e.blockLen=i,e.outputLen=l,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const ff=(t,e,r)=>new cf(t,e).update(r).digest();ff.create=(t,e)=>new cf(t,e);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Zb(t){return{hash:t,hmac:(e,...r)=>ff(t,e,hb(...r)),randomBytes:ef}}function Gb(t,e){const r=n=>Wb({...t,...Zb(n)});return Object.freeze({...r(e),create:r})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Mo=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),ho=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),hf=BigInt(1),po=BigInt(2),sl=(t,e)=>(t+e/po)/e;function df(t){const e=Mo,r=BigInt(3),n=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),l=BigInt(44),a=BigInt(88),u=t*t*t%e,c=u*u*t%e,f=Qt(c,r,e)*c%e,h=Qt(f,r,e)*c%e,g=Qt(h,po,e)*u%e,p=Qt(g,o,e)*g%e,d=Qt(p,s,e)*p%e,y=Qt(d,l,e)*d%e,v=Qt(y,a,e)*y%e,x=Qt(v,l,e)*d%e,m=Qt(x,r,e)*c%e,R=Qt(m,i,e)*p%e,I=Qt(R,n,e)*u%e,w=Qt(I,po,e);if(!Ks.eql(Ks.sqr(w),t))throw new Error("Cannot find square root");return w}const Ks=Pb(Mo,void 0,void 0,{sqrt:df}),oa=Gb({a:BigInt(0),b:BigInt(7),Fp:Ks,n:ho,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{const e=ho,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-hf*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),o=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,i=BigInt("0x100000000000000000000000000000000"),l=sl(s*t,e),a=sl(-n*t,e);let u=Nt(t-l*r-a*o,e),c=Nt(-l*n-a*s,e);const f=u>i,h=c>i;if(f&&(u=e-u),h&&(c=e-c),u>i||c>i)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:f,k1:u,k2neg:h,k2:c}}}},fo),Fo=BigInt(0),pf=t=>typeof t=="bigint"&&Fo<t&&t<Mo,Yb=t=>typeof t=="bigint"&&Fo<t&&t<ho,il={};function go(t,...e){let r=il[t];if(r===void 0){const n=fo(Uint8Array.from(t,o=>o.charCodeAt(0)));r=Rr(n,n),il[t]=r}return fo(Rr(r,...e))}const sa=t=>t.toRawBytes(!0).slice(1),Ws=t=>hr(t,32),gs=t=>Nt(t,Mo),vn=t=>Nt(t,ho),ia=oa.ProjectivePoint,Jb=(t,e,r)=>ia.BASE.multiplyAndAddUnsafe(t,e,r);function Zs(t){let e=oa.utils.normPrivateKeyToScalar(t),r=ia.fromPrivateKey(e);return{scalar:r.hasEvenY()?e:vn(-e),bytes:sa(r)}}function gf(t){if(!pf(t))throw new Error("bad x: need 0 < x < p");const e=gs(t*t),r=gs(e*t+BigInt(7));let n=df(r);n%po!==Fo&&(n=gs(-n));const o=new ia(t,n,hf);return o.assertValidity(),o}function yf(...t){return vn(Dt(go("BIP0340/challenge",...t)))}function Xb(t){return Zs(t).bytes}function Qb(t,e,r=ef(32)){const n=qt("message",t),{bytes:o,scalar:s}=Zs(e),i=qt("auxRand",r,32),l=Ws(s^Dt(go("BIP0340/aux",i))),a=go("BIP0340/nonce",l,o,n),u=vn(Dt(a));if(u===Fo)throw new Error("sign failed: k is zero");const{bytes:c,scalar:f}=Zs(u),h=yf(c,o,n),g=new Uint8Array(64);if(g.set(c,0),g.set(Ws(vn(f+h*s)),32),!vf(g,n,o))throw new Error("sign: Invalid signature produced");return g}function vf(t,e,r){const n=qt("signature",t,64),o=qt("message",e),s=qt("publicKey",r,32);try{const i=gf(Dt(s)),l=Dt(n.subarray(0,32));if(!pf(l))return!1;const a=Dt(n.subarray(32,64));if(!Yb(a))return!1;const u=yf(Ws(l),sa(i),o),c=Jb(i,a,vn(-u));return!(!c||!c.hasEvenY()||c.toAffine().x!==l)}catch{return!1}}const ys={getPublicKey:Xb,sign:Qb,verify:vf,utils:{randomPrivateKey:oa.utils.randomPrivateKey,lift_x:gf,pointToBytes:sa,numberToBytesBE:hr,bytesToNumberBE:Dt,taggedHash:go,mod:Nt}},tw=new TextEncoder;function ew(t){return Ms(fo(tw.encode(t)))}const rw={sign:(t,e)=>Ms(ys.sign(t,e)),verify:ys.verify,getPublicKey:t=>Ms(ys.getPublicKey(t))};function nw(t){const e=JSON.stringify([0,t.pubkey,t.created_at,t.kind,t.tags,t.content]);return ew(e)}function ow(t){try{return rw.verify(t.sig,nw(t),t.pubkey)}catch(e){return console.warn("The following error occurred during verify():",e),!1}}const sw=async t=>ow(t),yo=["wss://relay.nostr.band","wss://nos.lol"];function iw(t){const[,e,r]=t,[n,o,...s]=e.split(":"),i=s.join(":");return r!==void 0&&r!==""?{kind:Number(n),pubkey:o,identifier:i??"",relays:[r]}:{kind:Number(n),pubkey:o,identifier:i??""}}class bf{rxNostr;config;profileCache=new Map;noteCache=new Map;constructor(e){this.config={timeout:5e3,maxConnections:10,...e},this.rxNostr=mp({verifier:sw,eoseTimeout:e.timeout||5e3}),this.rxNostr.setDefaultRelays(this.config.relays||yo)}async fetchByFilters(e,r,n=!1){const o=this.rxNostr.getDefaultRelays();Object.keys(o).length===0&&this.rxNostr.setDefaultRelays(this.config.relays||yo);const s=xp();return new Promise(async(i,l)=>{const a=[],u=setTimeout(()=>{i(a)},(this.config.timeout||5e3)+5e3),c=((r||[]).length>0?this.rxNostr.use(s,{relays:r}):this.rxNostr.use(s)).pipe(sp()).subscribe({next:f=>{f.event&&(a.push(f.event),n&&(clearTimeout(u),c.unsubscribe(),i([f.event])))},error:f=>{clearTimeout(u),l(f)},complete:()=>{clearTimeout(u),i(a.sort((f,h)=>h.created_at-f.created_at))}});s.emit(e),s.over()})}async fetchNote(e,r){let n=e;try{if(e.startsWith("nevent")||e.startsWith("note")){const s=Hs.decode(e);s.type==="nevent"?n=s.data.id:s.type==="note"&&(n=s.data)}}catch{console.warn("Failed to decode note id:",e)}if(this.noteCache.has(n))return this.noteCache.get(n);const o=(await this.fetchByFilters([{ids:[n],limit:1}],r,!0))[0]??null;return o&&this.noteCache.set(n,o),o}async fetchProfile(e,r){let n=e;try{if(e.startsWith("npub")){const s=Hs.decode(e);s.type==="npub"&&(n=s.data)}}catch{console.warn("Failed to decode npub:",e)}if(this.profileCache.has(n))return this.profileCache.get(n);const o=(await this.fetchByFilters([{kinds:[0],authors:[n]}],r,!0))[0];if(o)try{const s=JSON.parse(o.content);return s.pubkey=n,this.profileCache.set(n,s),{...s,tags:o.tags}}catch(s){return console.warn("Failed to parse profile:",s),null}return null}disconnect(){this.rxNostr.dispose()}}const ln=Ph(null);function Vo(t,e){return e(),{destroy(){}}}var aw=K("<div><!></div>");function lw(t,e){Ft(e,!1);let r=D(e,"relays",12,yo),n=yt([]),o=yt(),s=yt(!1);function i(){k(s)||(F(s,!0),l())}async function l(){if(!Gl(ln))try{const c={relays:k(n)},f=new bf(c);ln.set(f),k(o)?.dispatchEvent(new CustomEvent("nostr-client-ready",{detail:{client:f},bubbles:!0,composed:!0}))}catch(c){console.error("Invalid relays configuration:",c),ln.set(null)}}se(()=>Ot(r()),()=>{try{typeof r()=="string"?F(n,JSON.parse(r())):Array.isArray(r())?F(n,r()):F(n,[])}catch{F(n,[])}}),se(()=>(k(s),k(n)),()=>{k(s)&&k(n).length&&l()}),xo(),Io();var a=aw(),u=X(a);return Ih(u,e,"default",{}),J(a),Oo(a,(c,f)=>Vo?.(c,f),()=>i),qh(a,c=>F(o,c),()=>k(o)),q(t,a),Vt({get relays(){return r()},set relays(c){r(c),j()}})}customElements.define("nostr-container",Jt(lw,{relays:{}},["default"],[],!1));async function bn(t=[]){let e=Gl(ln);if(!e){const r=t.length>0?t:yo;e=new bf({relays:r}),ln.set(e)}return e}function uw(t,e){let r=t;for(const[n,o]of Object.entries(e)){const s=`{${n}}`;r=r.replace(new RegExp(s,"g"),o)}return r}function al(t,e){return uw(t,{id:e})}function vo(t,e,r="https://njump.me/{id}"){return t?t.includes("{id}")?al(t,e):t:al(r,e)}var cw=K("<div><!></div>"),fw=K('<div class="placeholder avatar svelte-1kvl06z"></div>'),hw=K('<div class="placeholder name svelte-1kvl06z"></div>'),dw=K('<div class="placeholder time svelte-1kvl06z"></div>'),pw=K('<div class="placeholder content svelte-1kvl06z"></div>'),gw=K('<div class="note-link svelte-1kvl06z"><!></div>'),yw=K('<div><div class="note-content svelte-1kvl06z"><div class="note-avatar svelte-1kvl06z"><!></div> <div class="note-details svelte-1kvl06z"><div class="note-header svelte-1kvl06z"><div class="note-name svelte-1kvl06z"><!></div> <div class="note-time svelte-1kvl06z"><!></div></div> <div class="mention-container svelte-1kvl06z"><!></div> <div class="note-body svelte-1kvl06z"><!></div></div></div> <!></div>');const vw={hash:"svelte-1kvl06z",code:`:host {--bg-color: #fff;--text-color: #222;--border-color: #ddd;--name-color: #333;--time-color: #888;--placeholder-color: #e0e0e0;--error-bg: #f8d7da;--error-border: #f5c2c7;--error-text: #842029;

		/* :  */--link-color: #1a0dab;--link-hover-color: #551a8b;}.theme-dark.svelte-1kvl06z,
	:host(.dark) {--bg-color: #1e1e1e;--text-color: #ddd;--border-color: #444;--name-color: #eee;--time-color: #aaa;--placeholder-color: #333;--error-bg: #4b1c1f;--error-border: #8a1f2e;--error-text: #ffb3b3;

		/* :  */--link-color: #8ab4f8;--link-hover-color: #a3d0ff;}:host(.theme-light),
	:host(.light) {--bg-color: #fff;--text-color: #222;--border-color: #ddd;--name-color: #333;--time-color: #888;--placeholder-color: #e0e0e0;--error-bg: #f8d7da;--error-border: #f5c2c7;--error-text: #842029;

		/*  */--link-color: #1a0dab;--link-hover-color: #551a8b;}.note-error.svelte-1kvl06z {padding:12px;border:1px solid var(--error-border);background-color:var(--error-bg);color:var(--error-text);border-radius:6px;}.note-link.svelte-1kvl06z {position:absolute;top:0;right:0;overflow:visible;}.nostr-wrapper.svelte-1kvl06z {border:1px solid var(--border-color);border-radius:6px;padding:6px;background-color:var(--bg-color);color:var(--text-color);font-family:sans-serif;position:relative;}.note-content.svelte-1kvl06z {display:flex;align-items:flex-start;gap:12px;}.note-avatar.svelte-1kvl06z {width:40px;height:40px;border-radius:50%;overflow:hidden;display:flex;align-items:center;justify-content:center;flex-shrink:0;}.note-avatar.svelte-1kvl06z > * {max-width:100%;max-height:100%;object-fit:contain;border-radius:50%;}.note-details.svelte-1kvl06z {flex:1;display:flex;flex-direction:column;}.note-header.svelte-1kvl06z {display:flex;align-items:center;gap:8px;}.note-name.svelte-1kvl06z {font-weight:bold;font-size:14px;color:var(--name-color);}.note-time.svelte-1kvl06z {font-size:12px;color:var(--time-color);}.note-body.svelte-1kvl06z {white-space:pre-wrap;word-break:normal;word-break:break-word;}.placeholder.svelte-1kvl06z {background-color:var(--placeholder-color);border-radius:4px;
		animation: svelte-1kvl06z-pulse 1.5s ease-in-out infinite;}.placeholder.avatar.svelte-1kvl06z {width:40px;height:40px;border-radius:50%;}.placeholder.name.svelte-1kvl06z {width:80px;height:14px;}.placeholder.time.svelte-1kvl06z {width:60px;height:10px;}.placeholder.content.svelte-1kvl06z {width:100%;height:48px;margin-top:4px;}

	@keyframes svelte-1kvl06z-pulse {
		0%,
		100% {
			opacity: 1;
		}
		50% {
			opacity: 0.7;
		}
	}.mention-container.svelte-1kvl06z {margin:4px 0;font-size:small;display:inline-flex;flex-wrap:wrap;max-height:3.5em;overflow-y:auto;white-space:nowrap;

		/*  */padding-left:8px; /*  */border-left:4px solid var(--mention-line-color, #3b82f6);border-radius:4px;gap:4px;align-items:center;}

	/*  */.mention-container.svelte-1kvl06z > :where(.svelte-1kvl06z) {flex-shrink:0;white-space:nowrap;}`};function aa(t,e){Ft(e,!0),Ae(t,vw);let r=D(e,"class",7,""),n=D(e,"noLink",7,!1),o=D(e,"showPlaceholders",7,!1),s=D(e,"hasError",7,!1),i=D(e,"link",7),l=D(e,"avatar",7),a=D(e,"name",7),u=D(e,"createdAt",7),c=D(e,"content",7),f=D(e,"error",7),h=D(e,"themeClass",7),g=D(e,"height",7),p=D(e,"replyUser",7);var d=ut(),y=it(d);{var v=m=>{var R=cw(),I=X(R);{var w=_=>{var T=ut(),$=it(T);Zt($,f),q(_,T)},S=_=>{var T=ie("Error loading note");q(_,T)};V(I,_=>{f()?_(w):_(S,!1)})}J(R),Z(()=>ur(R,1,`note-error ${r()??""}`,"svelte-1kvl06z")),q(m,R)},x=m=>{var R=yw(),I=X(R),w=X(I),S=X(w);{var _=W=>{var G=ut(),et=it(G);Zt(et,l),q(W,G)},T=(W,G)=>{{var et=nt=>{var ct=fw();q(nt,ct)};V(W,nt=>{o()&&nt(et)},G)}};V(S,W=>{l()?W(_):W(T,!1)})}J(w);var $=be(w,2),B=X($),P=X(B),U=X(P);{var z=W=>{var G=ut(),et=it(G);Zt(et,a),q(W,G)},b=(W,G)=>{{var et=nt=>{var ct=hw();q(nt,ct)};V(W,nt=>{o()&&nt(et)},G)}};V(U,W=>{a()?W(z):W(b,!1)})}J(P);var E=be(P,2),O=X(E);{var A=W=>{var G=ut(),et=it(G);Zt(et,u),q(W,G)},N=(W,G)=>{{var et=nt=>{var ct=dw();q(nt,ct)};V(W,nt=>{o()&&nt(et)},G)}};V(O,W=>{u()?W(A):W(N,!1)})}J(E),J(B);var L=be(B,2),C=X(L);Zt(C,()=>p()??mr),J(L);var M=be(L,2),Y=X(M);{var lt=W=>{var G=ut(),et=it(G);Zt(et,c),q(W,G)},bt=(W,G)=>{{var et=nt=>{var ct=pw();q(nt,ct)};V(W,nt=>{o()&&nt(et)},G)}};V(Y,W=>{c()?W(lt):W(bt,!1)})}J(M),J($),J(I);var pt=be(I,2);{var wt=W=>{var G=gw(),et=X(G);Zt(et,i),J(G),q(W,G)};V(pt,W=>{!n()&&i()&&W(wt)})}J(R),Z(()=>{ur(R,1,`nostr-wrapper ${r()??""} ${h()??""}`,"svelte-1kvl06z"),hi(M,`${g()?`max-height: ${g()}; overflow-y: auto;`:"overflow-y:hidden"}`)}),q(m,R)};V(y,m=>{s()?m(v):m(x,!1)})}return q(t,d),Vt({get class(){return r()},set class(m=""){r(m),j()},get noLink(){return n()},set noLink(m=!1){n(m),j()},get showPlaceholders(){return o()},set showPlaceholders(m=!1){o(m),j()},get hasError(){return s()},set hasError(m=!1){s(m),j()},get link(){return i()},set link(m){i(m),j()},get avatar(){return l()},set avatar(m){l(m),j()},get name(){return a()},set name(m){a(m),j()},get createdAt(){return u()},set createdAt(m){u(m),j()},get content(){return c()},set content(m){c(m),j()},get error(){return f()},set error(m){f(m),j()},get themeClass(){return h()},set themeClass(m){h(m),j()},get height(){return g()},set height(m){g(m),j()},get replyUser(){return p()},set replyUser(m){p(m),j()}})}Jt(aa,{class:{},noLink:{},showPlaceholders:{},hasError:{},link:{},avatar:{},name:{},createdAt:{},content:{},error:{},themeClass:{},height:{},replyUser:{}},[],[],!0);var bw=K('<div class="placeholder name svelte-52otqq"></div>');const ww={hash:"svelte-52otqq",code:`.placeholder.svelte-52otqq {display:inline-block;
		animation: svelte-52otqq-pulse 1s cubic-bezier(0.4, 0, 0.6, 1) infinite;background-color:var(--placeholder-color);border-radius:3px;}
	@keyframes svelte-52otqq-pulse {
		50% {
			opacity: 0.5;
		}
	}.name.svelte-52otqq {width:80px;height:14px;}`};function la(t,e){Ft(e,!0),Ae(t,ww);let r=D(e,"name",7);var n=ut(),o=it(n);{var s=l=>{var a=ie();Z(()=>$t(a,r())),q(l,a)},i=l=>{var a=bw();q(l,a)};V(o,l=>{r()?l(s):l(i,!1)})}return q(t,n),Vt({get name(){return r()},set name(l){r(l),j()}})}Jt(la,{name:{}},[],[],!0);var mw=K('<img alt="avatar" class="avatar-img"/>'),Ew=K('<div class="placeholder avatar svelte-c68c41"></div>');const xw={hash:"svelte-c68c41",code:".placeholder.svelte-c68c41 {display:inline-block;background-color:var(--placeholder-color);border-radius:50%;}.placeholder.avatar.svelte-c68c41 {width:48px;height:48px;}"};function Ko(t,e){Ft(e,!0),Ae(t,xw);let r=D(e,"src",7);var n=ut(),o=it(n);{var s=l=>{var a=mw();Z(()=>jt(a,"src",r())),q(l,a)},i=l=>{var a=Ew();q(l,a)};V(o,l=>{r()?l(s):l(i,!1)})}return q(t,n),Vt({get src(){return r()},set src(l){r(l),j()}})}Jt(Ko,{src:{}},[],[],!0);const tt={TEXT:"text",NIP19:"nip19",RELAY:"relay",URL:"url",CUSTOM_EMOJI:"custom_emoji",HASHTAG:"hashtag",LN_ADDRESS:"ln_address",LN_URL:"ln_url",LNBC:"lnbc",EMAIL:"email",CASHU_TOKEN:"cashu_token",BITCOIN_ADDRESS:"bitcoin_address",NIP_IDENTIFIER:"nip_identifier",LEGACY_REFERENCE:"legacy_reference"},te={NPUB:"npub",NPROFILE:"nprofile",NOTE:"note",NEVENT:"nevent",NADDR:"naddr",NSEC:"nsec"},kw={[te.NPUB]:te.NPUB,[te.NPROFILE]:te.NPROFILE,[te.NOTE]:te.NOTE,[te.NEVENT]:te.NEVENT,[te.NADDR]:te.NADDR,[te.NSEC]:te.NSEC};function $w(t){const e=["gmail.com","yahoo.com","hotmail.com","outlook.com","icloud.com","protonmail.com","aol.com","live.com"],r=t.split("@")[1]?.toLowerCase();return!!r&&!e.includes(r)}function Aw(t,e){if(!e)return null;const r=e.find(n=>n[0]==="emoji"&&n[1]===t);return r?{url:r[2]}:null}const Sw={npub:/nostr:npub1[023456789acdefghjklmnpqrstuvwxyz]{58}/g,nprofile:/nostr:nprofile1[023456789acdefghjklmnpqrstuvwxyz]+/g,note:/nostr:note1[023456789acdefghjklmnpqrstuvwxyz]{58}/g,nevent:/nostr:nevent1[023456789acdefghjklmnpqrstuvwxyz]+/g,naddr:/nostr:naddr1[023456789acdefghjklmnpqrstuvwxyz]+/g,nsec:/nostr:nsec1[023456789acdefghjklmnpqrstuvwxyz]{58}/g},Ow={npub:new RegExp("(?<!nostr:)npub1[023456789acdefghjklmnpqrstuvwxyz]{58}","g"),nprofile:new RegExp("(?<!nostr:)nprofile1[023456789acdefghjklmnpqrstuvwxyz]+","g"),note:new RegExp("(?<!nostr:)note1[023456789acdefghjklmnpqrstuvwxyz]{58}","g"),nevent:new RegExp("(?<!nostr:)nevent1[023456789acdefghjklmnpqrstuvwxyz]+","g"),naddr:new RegExp("(?<!nostr:)naddr1[023456789acdefghjklmnpqrstuvwxyz]+","g"),nsec:new RegExp("(?<!nostr:)nsec1[023456789acdefghjklmnpqrstuvwxyz]{58}","g")},ll=/(https?:\/\/+[^\s"'<`\]]+[^\s"'<`:\].]+)/g,Iw=/lnurl1[02-9ac-hj-np-z]+/gi,Rw=/lnbc[0-9]*[munp]?1[02-9ac-hj-np-z]+/gi,Bw=/cashuA[A-Za-z0-9_-]+=*/g,_w=/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g,Nw=/:([a-zA-Z0-9_+-]+):/g,ul=new RegExp("(?<![\\p{XID_Continue}\\p{Extended_Pictographic}\\p{Emoji_Component}_+\\-])[#](?:(?![#])(?:\\p{XID_Continue}|\\p{Extended_Pictographic}|\\p{Emoji_Component}|[_+\\-]))+","gu"),Tw=/wss?:\/\/[a-zA-Z0-9.-]+(:[0-9]{1,5})?(\/[a-zA-Z0-9._~%+-]*)*/gi,Lw=/#\[\d+\]/g,Cw={legacy:/\b1[1-9A-HJ-NP-Za-km-z]{25,34}\b/g,script:/\b3[1-9A-HJ-NP-Za-km-z]{25,34}\b/g,bech32:/\bbc1[02-9ac-hj-np-z]{25,87}\b/gi},qw=/\bNIP-[0-9A-Za-z]+\b/g;function Uw(t){const e=t.match(/^NIP-([0-9A-Za-z]+)$/);if(!e)throw new Error("Invalid NIP identifier format");const r=e[1],n=/[A-Za-z]/.test(r),o=/[0-9]/.test(r);return{number:r,hasAlpha:n,hasDigit:o}}const Pw=t=>{let e=t;const r=/[.,;:!?\)\]}>]$/;for(;r.test(e);){const n=e.slice(-1);if(n===")"){const o=(e.match(/\(/g)||[]).length,s=(e.match(/\)/g)||[]).length;if(o>=s)break}else if(n===""){const o=(e.match(//g)||[]).length,s=(e.match(//g)||[]).length;if(o>=s)break}else if(n===""){const o=(e.match(//g)||[]).length,s=(e.match(//g)||[]).length;if(o>=s)break}else if(n==="]"){const o=(e.match(/\[/g)||[]).length,s=(e.match(/\]/g)||[]).length;if(o>=s)break}else if(n==="}"){const o=(e.match(/\{/g)||[]).length,s=(e.match(/\}/g)||[]).length;if(o>=s)break}e=e.slice(0,-1)}return e};function jw(t,e){const r=t.match(/#\[(\d+)\]/);if(!r)return null;const n=parseInt(r[1],10);if(!e||n>=e.length)return{tagIndex:n};const o=e[n];if(!o||o.length<2)return{tagIndex:n};const s=o[0],i=o[1];let l="unknown";return s==="p"?l="npub":s==="e"?l="note":s==="a"&&(l="naddr"),{tagIndex:n,tagType:s,referenceId:i,referenceType:l}}function Br(t,e,r,n,o={}){return{type:t,content:e,start:r,end:n,metadata:o}}function _r(t,e,r,n){return t<n&&r<e}function zw(t){const e=t.split("?")[0].split("#")[0].split(".").pop()?.toLowerCase();if(!e)return;const r=["mp4","webm","mov","mkv"],n=["mp3","wav","ogg","flac"],o=["jpg","jpeg","png","gif","webp","bmp","svg"];if(r.includes(e))return"video";if(n.includes(e))return"audio";if(o.includes(e))return"image"}function Dw(t){const e=new Set;for(const r of t)r.length>=2&&r[0]==="t"&&e.add(r[1].toLowerCase());return e}function Hw(t){const e=[],r=new RegExp(ll.source,ll.flags);let n;for(;(n=r.exec(t))!==null;){const o=n[0],s=Pw(o),i=n.index,l=i+s.length,a={scheme:s.startsWith("https://")?"https":s.startsWith("http://")?"http":null},u=zw(s);if(u&&(a.type=u),e.push(Br(tt.URL,s,i,l,a)),s!==o){const c=o.slice(s.length);e.push(Br(tt.TEXT,c,i+s.length,i+o.length))}}return e}const Mw=[{patterns:{nip_identifier:qw},handler:(t,e)=>{try{const r=Uw(t[0]);return{type:tt.NIP_IDENTIFIER,metadata:r}}catch{return null}}},{patterns:{legacy_reference:Lw},handler:(t,e,r)=>{const n=jw(t[0],r);return{type:tt.LEGACY_REFERENCE,metadata:n||{tagIndex:-1}}}},{patterns:{[tt.RELAY]:Tw},handler:(t,e,r)=>{const n=t[0],o=n.startsWith("wss://")?"wss":n.startsWith("ws://")?"ws":null;return{type:tt.RELAY,metadata:o?{scheme:o}:{}}}},{patterns:{ln_url:Iw},handler:()=>({type:tt.LN_URL})},{patterns:{lnbc:Rw},handler:()=>({type:tt.LNBC})},{patterns:{cashu_token:Bw},handler:()=>({type:tt.CASHU_TOKEN})},{patterns:Cw,handler:(t,e)=>({type:tt.BITCOIN_ADDRESS,metadata:{addressType:e}})},{patterns:{email:_w},handler:t=>{const e=t[0],r=$w(e);return{type:r?tt.LN_ADDRESS:tt.EMAIL,metadata:r?{domain:e.split("@")[1]}:{}}}},{patterns:{custom_emoji:Nw},handler:(t,e,r)=>{const n=t[1],o=Aw(n,r);return{type:tt.CUSTOM_EMOJI,metadata:{name:n,...o}}}}];function cl(t,e,r,n){Object.entries(e).forEach(([o,s])=>{const i=new RegExp(s.source,s.flags);let l;for(;(l=i.exec(t))!==null;){const[a]=l,u=l.index,c=u+a.length,f=r.some(g=>_r(u,c,g.start,g.end)),h=n.some(g=>_r(u,c,g.start,g.end));if(!f&&!h){const g=kw[o]||o;r.push(Br(tt.NIP19,a,u,c,{subType:g,hasNostrPrefix:a.startsWith("nostr:"),plainNip19:a.replace(/^nostr:/,"")}))}}})}function Fw(t,e,r=[],n=[],o=!0){const s=o?Dw(r):null;for(const i of Mw)for(const[l,a]of Object.entries(i.patterns)){const u=new RegExp(a.source,a.flags);let c;for(;(c=u.exec(t))!==null;){const f=c.index,h=f+c[0].length;if(e.some(p=>_r(f,h,p.start,p.end))||n.some(p=>_r(f,h,p.start,p.end)))continue;const g=i.handler(c,l,r);g&&e.push(Br(g.type,c[0],f,h,"metadata"in g?g.metadata:{}))}}Vw(t,e,n,s)}function Vw(t,e,r,n){const o=new RegExp(ul.source,ul.flags);let s;for(;(s=o.exec(t))!==null;){const i=s.index,l=i+s[0].length,a=s[0].slice(1);e.some(u=>_r(i,l,u.start,u.end))||r.some(u=>_r(i,l,u.start,u.end))||n&&!n.has(a.toLowerCase())||e.push(Br(tt.HASHTAG,s[0],i,l,{tag:a,validated:n!==null}))}}const Pn={[tt.URL]:15,[tt.NIP19]:10,[tt.RELAY]:10,[tt.CASHU_TOKEN]:2,[tt.LNBC]:2,[tt.LN_URL]:2,[tt.LN_ADDRESS]:2,[tt.CUSTOM_EMOJI]:1,[tt.BITCOIN_ADDRESS]:1,[tt.EMAIL]:1,[tt.LEGACY_REFERENCE]:1,[tt.HASHTAG]:0,[tt.NIP_IDENTIFIER]:0,[tt.TEXT]:0};function Kw(t){const e=[...t].sort((n,o)=>n.start!==o.start?n.start-o.start:n.end!==o.end?o.end-n.end:(Pn[o.type]??0)-(Pn[n.type]??0)),r=[];for(const n of e){const o=r.findIndex(s=>_r(s.start,s.end,n.start,n.end));if(o===-1)r.push(n);else{const s=r[o],i=Pn[n.type]??0,l=Pn[s.type]??0,a=n.end-n.start,u=s.end-s.start;(i>l||i===l&&a>u)&&r.splice(o,1,n)}}return r.sort((n,o)=>n.start-o.start)}function Ww(t,e){const r=Kw(e),n=[];let o=0;for(const s of r)s.start>o&&n.push(Br(tt.TEXT,t.slice(o,s.start),o,s.start)),n.push(s),o=s.end;return o<t.length&&n.push(Br(tt.TEXT,t.slice(o),o,t.length)),n}function Zw(t,e=[],r={}){if(!t)return[];const{includeNostrPrefixOnly:n=!0,hashtagsFromTagsOnly:o=!0}=r,s=Hw(t),i=[...s];return cl(t,Sw,i,s),n||cl(t,Ow,i,s),Fw(t,i,e,s,o),Ww(t,i)}var jn=new TextDecoder("utf-8");new TextEncoder;var Gw=5e3;function Yw(t){let{prefix:e,words:r}=fr.decode(t,Gw),n=new Uint8Array(fr.fromWords(r));switch(e){case"nprofile":{let o=vs(n);if(!o[0]?.[0])throw new Error("missing TLV 0 for nprofile");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");return{type:"nprofile",data:{pubkey:vt(o[0][0]),relays:o[1]?o[1].map(s=>jn.decode(s)):[]}}}case"nevent":{let o=vs(n);if(!o[0]?.[0])throw new Error("missing TLV 0 for nevent");if(o[0][0].length!==32)throw new Error("TLV 0 should be 32 bytes");if(o[2]&&o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(o[3]&&o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"nevent",data:{id:vt(o[0][0]),relays:o[1]?o[1].map(s=>jn.decode(s)):[],author:o[2]?.[0]?vt(o[2][0]):void 0,kind:o[3]?.[0]?parseInt(vt(o[3][0]),16):void 0}}}case"naddr":{let o=vs(n);if(!o[0]?.[0])throw new Error("missing TLV 0 for naddr");if(!o[2]?.[0])throw new Error("missing TLV 2 for naddr");if(o[2][0].length!==32)throw new Error("TLV 2 should be 32 bytes");if(!o[3]?.[0])throw new Error("missing TLV 3 for naddr");if(o[3][0].length!==4)throw new Error("TLV 3 should be 4 bytes");return{type:"naddr",data:{identifier:jn.decode(o[0][0]),pubkey:vt(o[2][0]),kind:parseInt(vt(o[3][0]),16),relays:o[1]?o[1].map(s=>jn.decode(s)):[]}}}case"nsec":return{type:e,data:n};case"npub":case"note":return{type:e,data:vt(n)};default:throw new Error(`unknown prefix ${e}`)}}function vs(t){let e={},r=t;for(;r.length>0;){let n=r[0],o=r[1],s=r.slice(2,2+o);if(r=r.slice(2+o),s.length<o)throw new Error(`not enough data to read on TLV ${n}`);e[n]=e[n]||[],e[n].push(s)}return e}var Jw=K('<!><img loading="lazy"/>',1);const Xw={hash:"svelte-iylet9",code:".custom-emoji.svelte-iylet9 {margin:0;display:inline;overflow:hidden;object-fit:contain;vertical-align:bottom;}"};function wf(t,e){Ft(e,!0),Ae(t,Xw);let r=D(e,"part",7),n=D(e,"height",7,24),o=ue(!1),s=ue(!1);var i=ut(),l=it(i);{var a=c=>{var f=Jw(),h=it(f);{var g=d=>{var y=ie();Z(()=>$t(y,r().content)),q(d,y)};V(h,d=>{k(s)||d(g)})}var p=be(h);ur(p,1,"custom-emoji","svelte-iylet9"),Z(()=>{jt(p,"height",`${n()}px`),jt(p,"alt",`${r().content}`),jt(p,"src",r().metadata.url),jt(p,"title",`${r().content}`),hi(p,`height:${n()}px`)}),$s("load",p,()=>{F(s,!0)}),$s("error",p,()=>{F(o,!0)}),Ml(p),q(c,f)},u=c=>{var f=ie();Z(()=>$t(f,r().content)),q(c,f)};V(l,c=>{r().metadata&&r().metadata.url&&!k(o)?c(a):c(u,!1)})}return q(t,i),Vt({get part(){return r()},set part(c){r(c),j()},get height(){return n()},set height(c=24){n(c),j()}})}Jt(wf,{part:{},height:{}},[],[],!0);var Qw=K('<a target="_blank" rel="noopener noreferrer" referrerpolicy="no-referrer"><!></a>');const tm={hash:"svelte-1tuxtjh",code:"a.svelte-1tuxtjh {display:inline;white-space:pre-wrap;word-break:normal;word-break:break-word;color:var(--link-color);text-decoration:underline;}a.svelte-1tuxtjh:hover {color:var(--link-hover-color);}"};function Nr(t,e){Ft(e,!0),Ae(t,tm);let r=D(e,"href",7),n=D(e,"children",7),o=D(e,"themeClass",7);var s=Qw(),i=X(s);return Zt(i,()=>n()??mr),J(s),Z(()=>{jt(s,"href",r()),ur(s,1,Bh(o()),"svelte-1tuxtjh")}),q(t,s),Vt({get href(){return r()},set href(l){r(l),j()},get children(){return n()},set children(l){n(l),j()},get themeClass(){return o()},set themeClass(l){o(l),j()}})}Jt(Nr,{href:{},children:{},themeClass:{}},[],[],!0);var em=K("<nostr-profile></nostr-profile>",2),rm=K("<nostr-note></nostr-note>",2);function mf(t,e){Ft(e,!0);let r=D(e,"decoded",7),n=D(e,"themeClass",7),o=D(e,"theme",7),s=D(e,"part",7);var i=ut(),l=it(i);{var a=c=>{var f=em();ce(f,"display","name"),Z(()=>ce(f,"id",r().type==="npub"?r().data:r().data.pubkey)),Z(()=>ce(f,"theme",o())),q(c,f)},u=(c,f)=>{{var h=p=>{var d=rm();Z(()=>ce(d,"id",r().type==="note"?r().data:r().data.author)),Z(()=>ce(d,"theme",o())),q(p,d)},g=(p,d)=>{{var y=x=>{const m=jr(()=>`https://njump.me/${s().content}`);Nr(x,{get themeClass(){return n()},get href(){return k(m)},children:(R,I)=>{Fr();var w=ie();Z(()=>$t(w,s().content)),q(R,w)},$$slots:{default:!0}})},v=(x,m)=>{{var R=I=>{const w=jr(()=>`https://njump.me/${s().content}`);Nr(I,{get themeClass(){return n()},get href(){return k(w)},children:(S,_)=>{Fr();var T=ie();Z(()=>$t(T,s().content)),q(S,T)},$$slots:{default:!0}})};V(x,I=>{r().type==="nsec"&&I(R)},m)}};V(p,x=>{r().type==="naddr"?x(y):x(v,!1)},d)}};V(c,p=>{r().type==="nevent"||r().type==="note"?p(h):p(g,!1)},f)}};V(l,c=>{r().type==="npub"||r().type==="nprofile"?c(a):c(u,!1)})}return q(t,i),Vt({get decoded(){return r()},set decoded(c){r(c),j()},get themeClass(){return n()},set themeClass(c){n(c),j()},get theme(){return o()},set theme(c){o(c),j()},get part(){return s()},set part(c){s(c),j()}})}Jt(mf,{decoded:{},themeClass:{},theme:{},part:{}},[],[],!0);var nm=K('<img loading="lazy" class="svelte-1eu7aia"/>');const om={hash:"svelte-1eu7aia",code:"img.svelte-1eu7aia {display:inline-flex;max-width:100%;object-fit:contain;max-height:10rem;}"};function Ef(t,e){Ft(e,!0),Ae(t,om);let r=D(e,"src",7),n=D(e,"themeClass",7),o=ue(!1);var s=ut(),i=it(s);{var l=u=>{var c=nm();Z(()=>{jt(c,"src",r()),jt(c,"alt",r())}),$s("error",c,()=>F(o,!0)),Ml(c),q(u,c)},a=u=>{Nr(u,{get themeClass(){return n()},get href(){return r()},children:(c,f)=>{Fr();var h=ie();Z(()=>$t(h,r())),q(c,h)},$$slots:{default:!0}})};V(i,u=>{k(o)?u(a,!1):u(l)})}return q(t,s),Vt({get src(){return r()},set src(u){r(u),j()},get themeClass(){return n()},set themeClass(u){n(u),j()}})}Jt(Ef,{src:{},themeClass:{}},[],[],!0);var sm=K('<span class="break-words whitespace-pre-wrap" style="word-break: break-word;"> </span>');function Wo(t,e){Ft(e,!0);let r=D(e,"text",7),n=D(e,"tags",7),o=D(e,"themeClass",7),s=D(e,"theme",7),i=jr(()=>Zw(r(),n()));const l=f=>{if(f!==void 0)try{const h=Yw(f);return h.type==="naddr"?{type:h.type,data:h.data}:h.type==="nevent"?{type:h.type,data:h.data}:h.type==="nprofile"?{type:h.type,data:h.data}:h.type==="nsec"?{type:h.type,data:h.data}:{type:h.type,data:h.data}}catch{return}},a=(f,h)=>{try{switch(f){case"a":return{type:"naddr",data:iw(["a",h])};case"p":return{type:"npub",data:h};case"e":return{type:"note",data:h}}}catch{return}};var u=ut(),c=it(u);return Xn(c,17,()=>k(i),fi,(f,h)=>{var g=ut(),p=it(g);{var d=v=>{var x=ut();const m=jr(()=>l(k(h).metadata.plainNip19));var R=it(x);{var I=S=>{mf(S,{get decoded(){return k(m)},get part(){return k(h)},get theme(){return s()},get themeClass(){return o()}})},w=S=>{var _=ie();Z(()=>$t(_,k(h).content)),q(S,_)};V(R,S=>{k(m)?S(I):S(w,!1)})}q(v,x)},y=(v,x)=>{{var m=I=>{var w=ut();const S=jr(()=>a(k(h).metadata.tagType,k(h).metadata.referenceId));var _=it(w);{var T=B=>{const P=jr(()=>`https://njump.me/${k(h).content}`);Nr(B,{get themeClass(){return o()},get href(){return k(P)},children:(U,z)=>{Fr();var b=ie();Z(()=>$t(b,k(h).content)),q(U,b)},$$slots:{default:!0}})},$=B=>{var P=ie();Z(()=>$t(P,k(h).content)),q(B,P)};V(_,B=>{k(S)?B(T):B($,!1)})}q(I,w)},R=(I,w)=>{{var S=T=>{var $=ut(),B=it($);{var P=z=>{Ef(z,{get src(){return k(h).content},get themeClass(){return o()}})},U=z=>{Nr(z,{get themeClass(){return o()},get href(){return k(h).content},children:(b,E)=>{Fr();var O=ie();Z(()=>$t(O,k(h).content)),q(b,O)},$$slots:{default:!0}})};V(B,z=>{k(h).metadata.type==="image"?z(P):z(U,!1)})}q(T,$)},_=(T,$)=>{{var B=U=>{wf(U,{get part(){return k(h)}})},P=U=>{var z=sm(),b=X(z,!0);J(z),Z(()=>$t(b,k(h).content)),q(U,z)};V(T,U=>{k(h).type===tt.CUSTOM_EMOJI?U(B):U(P,!1)},$)}};V(I,T=>{k(h).type==="url"?T(S):T(_,!1)},w)}};V(v,I=>{k(h).type===tt.LEGACY_REFERENCE&&k(h).metadata&&k(h).metadata.tagType&&k(h).metadata.referenceId?I(m):I(R,!1)},x)}};V(p,v=>{k(h).type==="nip19"?v(d):v(y,!1)})}q(f,g)}),q(t,u),Vt({get text(){return r()},set text(f){r(f),j()},get tags(){return n()},set tags(f){n(f),j()},get themeClass(){return o()},set themeClass(f){o(f),j()},get theme(){return s()},set theme(f){s(f),j()}})}Jt(Wo,{text:{},tags:{},themeClass:{},theme:{}},[],[],!0);var im=K('<a referrerpolicy="no-referrer" class="external-link svelte-rp4zfn" title="Open in new tab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link-icon lucide-external-link"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a>'),am=K('<span class="timestamp"> </span>'),lm=K("<nostr-profile></nostr-profile>",2),um=K("<span> </span>"),cm=K("<div><!></div>");const fm={hash:"svelte-rp4zfn",code:`:host {--bg-color: #fff;--text-color: #222;--border-color: #ddd;--error-bg: #f8d7da;--error-border: #f5c2c7;--error-text: #842029;--loading-color: #666;--empty-color: #888;

		/*  */--mention-line-color: #3b82f6; /*  */--mention-bg-color: #e0f5ff; /*  */}.theme-dark.svelte-rp4zfn {--bg-color: #1e1e1e;--text-color: #ddd;--border-color: #444;--error-bg: #4b1c1f;--error-border: #8a1f2e;--error-text: #ffb3b3;--loading-color: #aaa;--empty-color: #999;

		/*  */--mention-line-color: #60a5fa; /*  */--mention-bg-color: #1e3a8a22; /*  */}.theme-light.svelte-rp4zfn {--bg-color: #fff;--text-color: #222;--border-color: #ddd;--error-bg: #f8d7da;--error-border: #f5c2c7;--error-text: #842029;--loading-color: #666;--empty-color: #888;

		/*  */--mention-line-color: #3b82f6;--mention-bg-color: #e0f5ff;}.external-link.svelte-rp4zfn {display:flex;align-items:center;justify-content:center;text-decoration:none;padding:0;color:var(--link-color);}.external-link.svelte-rp4zfn:hover {color:var(--link-hover-color);}`};function hm(t,e){Ft(e,!1),Ae(t,fm);const r=yt(),n=yt();let o=D(e,"id",12,""),s=D(e,"relays",28,()=>[]),i=D(e,"href",12,null),l=D(e,"target",12,"_blank"),a=D(e,"noLink",12,!1),u=D(e,"className",12,""),c=D(e,"theme",12,"auto"),f=D(e,"height",12,void 0),h=yt(""),g=yt(!1),p=null,d=yt(null),y=yt(null),v=!1,x=yt(!1);function m(){if(k(x)||!o()){console.warn("[nostr-note] Skipping initialize: mounted =",k(x),", id =",o());return}F(x,!0),R()}async function R(){if(!(!o()||k(g))){F(g,!0),p=null,F(d,null),F(y,null);try{const T=await bn(s());if(!T){p="Nostr client not available",console.error("[nostr-note] Client is null");return}const $=await T.fetchNote(o(),s());if(!$){p="Note not found";return}F(d,$),I($.pubkey)}catch(T){p=T.message||"Error loading note",console.error("[nostr-note] Exception:",T)}finally{F(g,!1),console.log("[nostr-note] loading complete")}}}async function I(T){if(!v){v=!0;try{const $=await bn(s());if(!$){console.error("[nostr-note] Metadata client unavailable");return}F(y,await $.fetchProfile(T,s()))}catch($){console.warn("[nostr-note] Failed to load metadata:",$)}finally{v=!1}}}se(()=>Ot(c()),()=>{F(h,c()==="dark"?"theme-dark":c()==="light"?"theme-light":"")}),se(()=>(Ot(i()),Ot(o())),()=>{F(r,vo(i(),o(),"https://njump.me/{id}"))}),se(()=>(k(x),Ot(o())),()=>{k(x)&&o()&&R()}),se(()=>k(d),()=>{F(n,k(d)?.tags?.filter(T=>T[0]==="p"&&typeof T[1]=="string")?.map(T=>T[1]))}),xo(),Io();var w=cm(),S=X(w);const _=Bt(()=>k(g)||!k(d));{const T=E=>{var O=im();Z(()=>{jt(O,"href",k(r)),jt(O,"target",l())}),q(E,O)},$=E=>{const O=Bt(()=>(k(y),ft(()=>k(y)?.picture)));Ko(E,{get src(){return k(O)}})},B=E=>{const O=Bt(()=>(k(y),ft(()=>k(y)?.name)));la(E,{get name(){return k(O)}})},P=E=>{var O=ut(),A=it(O);{var N=L=>{var C=am(),M=X(C,!0);J(C),Z(Y=>$t(M,Y),[()=>(k(d),ft(()=>new Date(k(d).created_at*1e3).toLocaleString()))],Bt),q(L,C)};V(A,L=>{k(d)&&L(N)})}q(E,O)},U=E=>{var O=ut(),A=it(O);Xn(A,1,()=>k(n)||[],fi,(N,L)=>{var C=lm();ce(C,"display","name"),Z(()=>ce(C,"theme",c())),Z(()=>ce(C,"id",k(L))),q(N,C)}),q(E,O)},z=E=>{var O=ut(),A=it(O);{var N=L=>{Wo(L,{get text(){return k(d),ft(()=>k(d).content)},get themeClass(){return k(h)},get theme(){return c()},get tags(){return k(d),ft(()=>k(d).tags)}})};V(A,L=>{k(d)&&L(N)})}q(E,O)},b=E=>{var O=um(),A=X(O);J(O),Z(()=>$t(A,`Error: ${b??""}`)),q(E,O)};aa(S,{get class(){return u()},get themeClass(){return k(h)},get noLink(){return a()},get height(){return f()},get showPlaceholders(){return k(_)},link:T,avatar:$,name:B,createdAt:P,replyUser:U,content:z,error:b,$$slots:{link:!0,avatar:!0,name:!0,createdAt:!0,replyUser:!0,content:!0,error:!0}})}return J(w),Oo(w,(T,$)=>Vo?.(T,$),()=>m),Z(()=>ur(w,1,`nostr-wrapper ${k(h)??""} ${u()??""}`,"svelte-rp4zfn")),q(t,w),Vt({get id(){return o()},set id(T){o(T),j()},get relays(){return s()},set relays(T){s(T),j()},get href(){return i()},set href(T){i(T),j()},get target(){return l()},set target(T){l(T),j()},get noLink(){return a()},set noLink(T){a(T),j()},get className(){return u()},set className(T){u(T),j()},get theme(){return c()},set theme(T){c(T),j()},get height(){return f()},set height(T){f(T),j()}})}customElements.define("nostr-note",Jt(hm,{id:{},relays:{},href:{},target:{},noLink:{},className:{},theme:{},height:{}},[],[],!0));var dm=K('<div class="placeholder avatar svelte-vqbtnk"></div>'),pm=K('<div class="placeholder name svelte-vqbtnk"></div>'),gm=K('<div class="placeholder username svelte-vqbtnk"></div>'),ym=K('<div class="placeholder about svelte-vqbtnk"></div>'),vm=K('<div class="profile-about svelte-vqbtnk"><!></div>'),bm=K('<div class="profile-link svelte-vqbtnk"><!></div>'),wm=K('<div><div class="profile-content svelte-vqbtnk"><div class="profile-avatar svelte-vqbtnk"><!></div> <div class="profile-details svelte-vqbtnk"><div class="profile-header svelte-vqbtnk"><div class="profile-name svelte-vqbtnk"><!></div> <div class="profile-username svelte-vqbtnk"><!></div></div> <!></div></div> <!></div>');const mm={hash:"svelte-vqbtnk",code:`:host {--bg-color: #fff;--text-color: #222;--border-color: #ddd;--name-color: #333;--time-color: #888;--placeholder-color: #e0e0e0;--error-bg: #f8d7da;--error-border: #f5c2c7;--error-text: #842029;

		/* :  */--link-color: #1a0dab;--link-hover-color: #551a8b;}.theme-dark.svelte-vqbtnk,
	:host(.dark) {--bg-color: #1e1e1e;--text-color: #ddd;--border-color: #444;--name-color: #eee;--time-color: #aaa;--placeholder-color: #333;--error-bg: #4b1c1f;--error-border: #8a1f2e;--error-text: #ffb3b3;

		/* :  */--link-color: #8ab4f8;--link-hover-color: #a3d0ff;}:host(.theme-light),
	:host(.light) {--bg-color: #fff;--text-color: #222;--border-color: #ddd;--name-color: #333;--time-color: #888;--placeholder-color: #e0e0e0;--error-bg: #f8d7da;--error-border: #f5c2c7;--error-text: #842029;

		/*  */--link-color: #1a0dab;--link-hover-color: #551a8b;}.placeholder.svelte-vqbtnk {display:inline-block;
		animation: svelte-vqbtnk-pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;background-color:var(--placeholder-color);border-radius:3px;}

	@keyframes svelte-vqbtnk-pulse {
		50% {
			opacity: 0.5;
		}
	}.profile-error.svelte-vqbtnk {padding:16px;border:1px solid var(--error-border);background-color:var(--error-bg);color:var(--error-text);border-radius:6px;}.nostr-wrapper.svelte-vqbtnk {position:relative;}.profile-link.svelte-vqbtnk {position:absolute;top:0;right:0;overflow:visible;}.profile-content.svelte-vqbtnk {display:flex;align-items:flex-start;gap:16px;}.profile-avatar.svelte-vqbtnk {width:60px;height:60px;border-radius:50%;overflow:hidden;display:flex;align-items:center;justify-content:center;flex-shrink:0;}.profile-avatar.svelte-vqbtnk > * {max-width:100%;max-height:100%;object-fit:contain;border-radius:50%;}.profile-details.svelte-vqbtnk {flex:1;display:flex;flex-direction:column;gap:8px;}.profile-header.svelte-vqbtnk {display:flex;align-items:center;gap:12px;}.profile-name.svelte-vqbtnk {font-weight:bold;font-size:18px;color:var(--name-color);}.profile-username.svelte-vqbtnk {font-size:14px;color:var(--username-color);}.profile-about.svelte-vqbtnk {line-height:1.4;color:var(--about-color);margin-top:4px;}.placeholder.svelte-vqbtnk {background-color:var(--placeholder-color);border-radius:4px;
		animation: svelte-vqbtnk-pulse 1.5s ease-in-out infinite;}.placeholder.avatar.svelte-vqbtnk {width:60px;height:60px;border-radius:50%;}.placeholder.name.svelte-vqbtnk {width:120px;height:18px;}.placeholder.username.svelte-vqbtnk {width:80px;height:14px;}.placeholder.about.svelte-vqbtnk {width:100%;height:36px;margin-top:4px;}

	@keyframes svelte-vqbtnk-pulse {
		0%,
		100% {
			opacity: 1;
		}
		50% {
			opacity: 0.7;
		}
	}`};function xf(t,e){Ft(e,!0),Ae(t,mm);let r=D(e,"class",7,""),n=D(e,"noLink",7,!1),o=D(e,"showPlaceholders",7,!1),s=D(e,"hasError",7,!1),i=D(e,"link",7),l=D(e,"avatar",7),a=D(e,"name",7),u=D(e,"username",7),c=D(e,"about",7),f=D(e,"error",7),h=D(e,"themeClass",7),g=D(e,"height",7);var p=wm(),d=X(p),y=X(d),v=X(y);{var x=A=>{var N=ut(),L=it(N);Zt(L,l),q(A,N)},m=(A,N)=>{{var L=C=>{var M=dm();q(C,M)};V(A,C=>{o()&&C(L)},N)}};V(v,A=>{l()?A(x):A(m,!1)})}J(y);var R=be(y,2),I=X(R),w=X(I),S=X(w);{var _=A=>{var N=ut(),L=it(N);Zt(L,a),q(A,N)},T=(A,N)=>{{var L=C=>{var M=pm();q(C,M)};V(A,C=>{o()&&C(L)},N)}};V(S,A=>{a()?A(_):A(T,!1)})}J(w);var $=be(w,2),B=X($);{var P=A=>{var N=ut(),L=it(N);Zt(L,u),q(A,N)},U=(A,N)=>{{var L=C=>{var M=gm();q(C,M)};V(A,C=>{o()&&C(L)},N)}};V(B,A=>{u()?A(P):A(U,!1)})}J($),J(I);var z=be(I,2);{var b=A=>{var N=vm(),L=X(N);{var C=Y=>{var lt=ut(),bt=it(lt);Zt(bt,c),q(Y,lt)},M=(Y,lt)=>{{var bt=pt=>{var wt=ym();q(pt,wt)};V(Y,pt=>{o()&&pt(bt)},lt)}};V(L,Y=>{c()?Y(C):Y(M,!1)})}J(N),Z(()=>hi(N,`${g()?`max-height: ${g()}; overflow-y: auto;`:"overflow-y:hidden"}`)),q(A,N)};V(z,A=>{(c()||o())&&A(b)})}J(R),J(d);var E=be(d,2);{var O=A=>{var N=bm(),L=X(N);Zt(L,i),J(N),q(A,N)};V(E,A=>{!n()&&i()&&A(O)})}return J(p),Z(()=>ur(p,1,`nostr-wrapper ${r()??""} ${h()??""}`,"svelte-vqbtnk")),q(t,p),Vt({get class(){return r()},set class(A=""){r(A),j()},get noLink(){return n()},set noLink(A=!1){n(A),j()},get showPlaceholders(){return o()},set showPlaceholders(A=!1){o(A),j()},get hasError(){return s()},set hasError(A=!1){s(A),j()},get link(){return i()},set link(A){i(A),j()},get avatar(){return l()},set avatar(A){l(A),j()},get name(){return a()},set name(A){a(A),j()},get username(){return u()},set username(A){u(A),j()},get about(){return c()},set about(A){c(A),j()},get error(){return f()},set error(A){f(A),j()},get themeClass(){return h()},set themeClass(A){h(A),j()},get height(){return g()},set height(A){g(A),j()}})}Jt(xf,{class:{},noLink:{},showPlaceholders:{},hasError:{},link:{},avatar:{},name:{},username:{},about:{},error:{},themeClass:{},height:{}},[],[],!0);var Em=K('<a referrerpolicy="no-referrer" class="external-link svelte-ym83xw" title="Open in new tab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link-icon lucide-external-link svelte-ym83xw"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a>'),xm=K('<span class="username"> </span>'),km=K("<span> </span>"),$m=K('<div class="nostr-wrapper svelte-ym83xw"><!></div>'),Am=K("<span> </span>"),Sm=K("<div><!></div>");const Om={hash:"svelte-ym83xw",code:`:host {--bg-color: #fff;--text-color: #222;--border-color: #ddd;--name-color: #333;--time-color: #888;--placeholder-color: #e0e0e0;--error-bg: #f8d7da;--error-border: #f5c2c7;--error-text: #842029;

		/* :  */--link-color: #1a0dab;--link-hover-color: #551a8b;}.theme-dark.svelte-ym83xw,
	:host(.dark) {--bg-color: #1e1e1e;--text-color: #ddd;--border-color: #444;--name-color: #eee;--time-color: #aaa;--placeholder-color: #333;--error-bg: #4b1c1f;--error-border: #8a1f2e;--error-text: #ffb3b3;

		/* :  */--link-color: #8ab4f8;--link-hover-color: #a3d0ff;}:host(.theme-light),
	:host(.light) {--bg-color: #fff;--text-color: #222;--border-color: #ddd;--name-color: #333;--time-color: #888;--placeholder-color: #e0e0e0;--error-bg: #f8d7da;--error-border: #f5c2c7;--error-text: #842029;

		/*  */--link-color: #1a0dab;--link-hover-color: #551a8b;}.nostr-wrapper.svelte-ym83xw {border:1px solid var(--border-color);border-radius:6px;padding:12px;background-color:var(--bg-color);color:var(--text-color);font-family:sans-serif;position:relative;}.external-link.svelte-ym83xw {width:100%;height:100%;display:flex;align-items:center;justify-content:center;padding:0;border:none;background:transparent;color:#007aff;text-decoration:none;cursor:pointer;}.external-link.svelte-ym83xw svg:where(.svelte-ym83xw) {width:20px;height:20px;stroke-width:2;}.external-link.svelte-ym83xw:hover {background-color:rgba(0, 0, 0, 0.05);border-radius:4px;}.profile.svelte-ym83xw {width:fit-content;}`};function Im(t,e){Ft(e,!1),Ae(t,Om);let r=D(e,"id",12,""),n=D(e,"relays",28,()=>[]),o=D(e,"href",12,null),s=D(e,"target",12,"_blank"),i=D(e,"noLink",12,!1),l=D(e,"display",12,"card"),a=D(e,"className",12,""),u=D(e,"theme",12,"auto"),c=yt(!1),f=yt(null),h=null,g=yt(!1),p=yt("");function d(){k(g)||!r()||(F(g,!0),y())}async function y(){if(!(k(c)||!r())){F(c,!0),h=null;try{const w=await bn(n());F(f,await w.fetchProfile(r(),n())),k(f)||(h="Profile not found")}catch(w){h=w?.message||"Error loading profile"}finally{F(c,!1)}}}let v=yt(null);se(()=>Ot(u()),()=>{F(p,u()==="dark"?"theme-dark":u()==="light"?"theme-light":"")}),se(()=>(k(g),Ot(r())),()=>{k(g)&&r()&&y()}),se(()=>(Ot(o()),Ot(r())),()=>{F(v,vo(o(),r(),"https://njump.me/{id}"))}),xo(),Io();var x=Sm(),m=X(x);{var R=w=>{var S=$m(),_=X(S);const T=Bt(()=>`${a()}`),$=Bt(()=>k(c)||!k(f));{const B=E=>{var O=Em();Z(()=>{jt(O,"href",k(v)),jt(O,"target",s())}),q(E,O)},P=E=>{const O=Bt(()=>(k(f),ft(()=>k(f)?.picture)));Ko(E,{get src(){return k(O)}})},U=E=>{var O=ut(),A=it(O);{var N=L=>{var C=xm(),M=X(C,!0);J(C),Z(()=>$t(M,(k(f),ft(()=>k(f).name)))),q(L,C)};V(A,L=>{k(f),ft(()=>k(f)?.name)&&L(N)})}q(E,O)},z=E=>{var O=ut(),A=it(O);{var N=L=>{const C=Bt(()=>(k(f),ft(()=>k(f).about||"")));Wo(L,{get text(){return k(C)},get tags(){return k(f),ft(()=>k(f).tags)}})};V(A,L=>{k(f)&&L(N)})}q(E,O)},b=E=>{var O=km(),A=X(O);J(O),Z(()=>$t(A,`Error: ${b??""}`)),q(E,O)};xf(_,{get class(){return k(T)},get themeClass(){return k(p)},get noLink(){return i()},get showPlaceholders(){return k($)},link:B,avatar:P,name:U,about:z,error:b,$$slots:{link:!0,avatar:!0,name:!0,about:!0,error:!0}})}J(S),q(w,S)},I=(w,S)=>{{var _=$=>{var B=Am(),P=X(B);J(B),Z(()=>$t(P,`@${k(f),ft(()=>k(f)?.name||k(f)?.display_name||"Unknown User")??""}`)),q($,B)},T=$=>{Nr($,{get themeClass(){return k(p)},get href(){return k(v)},children:(B,P)=>{Fr();var U=ie();Z(()=>$t(U,`@${k(f),ft(()=>k(f)?.name||k(f)?.display_name||"Unknown User")??""}`)),q(B,U)},$$slots:{default:!0}})};V(w,$=>{i()?$(_):$(T,!1)},S)}};V(m,w=>{l()==="card"?w(R):w(I,!1)})}return J(x),Oo(x,(w,S)=>Vo?.(w,S),()=>d),Z(()=>ur(x,1,`profile ${k(p)??""} ${a()??""}`,"svelte-ym83xw")),q(t,x),Vt({get id(){return r()},set id(w){r(w),j()},get relays(){return n()},set relays(w){n(w),j()},get href(){return o()},set href(w){o(w),j()},get target(){return s()},set target(w){s(w),j()},get noLink(){return i()},set noLink(w){i(w),j()},get display(){return l()},set display(w){l(w),j()},get className(){return a()},set className(w){a(w),j()},get theme(){return u()},set theme(w){u(w),j()}})}customElements.define("nostr-profile",Jt(Im,{id:{},relays:{},href:{},target:{},noLink:{},display:{},className:{},theme:{}},[],[],!0));var Rm=K('<div class="loading svelte-xuua0i">Loading events...</div>'),Bm=K('<div class="error svelte-xuua0i"> </div>'),_m=K('<div class="empty svelte-xuua0i">No events found</div>'),Nm=K('<a referrerpolicy="no-referrer" class="external-link" title="Open in new tab"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-external-link-icon lucide-external-link"><path d="M15 3h6v6"></path><path d="M10 14 21 3"></path><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path></svg></a>'),Tm=K('<span class="timestamp"> </span>'),Lm=K("<nostr-profile></nostr-profile>",2),Cm=K("<span> </span>"),qm=K('<div class="events-container svelte-xuua0i"></div>'),Um=K("<div><!></div>");const Pm={hash:"svelte-xuua0i",code:`:host {--bg-color: #fff;--text-color: #222;--border-color: #ddd;--error-bg: #f8d7da;--error-border: #f5c2c7;--error-text: #842029;--loading-color: #666;--empty-color: #888;

		/*  */--mention-line-color: #3b82f6; /*  */--mention-bg-color: #e0f5ff; /*  */}.theme-dark.svelte-xuua0i {--bg-color: #1e1e1e;--text-color: #ddd;--border-color: #444;--error-bg: #4b1c1f;--error-border: #8a1f2e;--error-text: #ffb3b3;--loading-color: #aaa;--empty-color: #999;

		/*  */--mention-line-color: #60a5fa; /*  */--mention-bg-color: #1e3a8a22; /*  */}.theme-light.svelte-xuua0i {--bg-color: #fff;--text-color: #222;--border-color: #ddd;--error-bg: #f8d7da;--error-border: #f5c2c7;--error-text: #842029;--loading-color: #666;--empty-color: #888;

		/*  */--mention-line-color: #3b82f6;--mention-bg-color: #e0f5ff;}.nostr-list-wrapper.svelte-xuua0i {width:100%;background-color:var(--bg-color);color:var(--text-color);}.loading.svelte-xuua0i {padding:20px;text-align:center;color:var(--loading-color);font-style:italic;}.error.svelte-xuua0i {padding:15px;background-color:var(--error-bg);border:1px solid var(--error-border);border-radius:4px;color:var(--error-text);margin:10px 0;}.empty.svelte-xuua0i {padding:20px;text-align:center;color:var(--empty-color);font-style:italic;}.events-container.svelte-xuua0i {display:flex;flex-direction:column;}.event-item.svelte-xuua0i:last-child {border-bottom:none;}`};function jm(t,e){Ft(e,!1),Ae(t,Pm);let r=D(e,"filters",12,"[]"),n=D(e,"relays",28,()=>[]),o=D(e,"className",12,""),s=D(e,"theme",12,"auto"),i=D(e,"limit",12,50),l=D(e,"height",12,void 0),a=D(e,"href",12,null),u=D(e,"target",12,"_blank"),c=D(e,"noLink",12,!1),f=yt(50),h=yt(""),g=yt([]),p=new Map,d=yt(!1),y=yt(null),v=yt(!1);function x(){k(v)||(F(v,!0),m())}async function m(){if(k(d)){console.warn("[nostr-list] loadEvents() skipped: already loading");return}console.log("[nostr-list] Loading events with filters:",r()),F(d,!0),F(y,null),F(g,[]),p.clear();let $;try{const B=JSON.parse(r());if(!Array.isArray(B))throw new Error("filters must be an array");$=B}catch(B){F(y,`Invalid filters: ${B.message}`),F(d,!1);return}try{const B=await bn(n());if(!B){F(y,"Nostr client not available"),console.error("[nostr-list] Client is null");return}const P=$.map(z=>({...z,limit:z.limit||k(f)})),U=await B.fetchByFilters(P,n(),!1);if(!U){F(y,"Failed to fetch events");return}F(g,U.sort((z,b)=>b.created_at-z.created_at)),k(f)>0&&F(g,k(g).slice(0,k(f))),await R()}catch(B){F(y,B?.message||"Failed to fetch events"),console.error("[nostr-list] Exception:",B)}finally{F(d,!1),console.log("[nostr-list] loading complete")}}async function R(){try{const $=await bn(n());if(!$)return;const B=[...new Set(k(g).map(U=>U.pubkey))];if(B.length===0)return;const P=B.map(async U=>{try{const z=await $.fetchProfile(U,n());z&&p.set(U,z)}catch(z){console.warn(`[nostr-list] Failed to fetch metadata for ${U}:`,z)}});await Promise.allSettled(P),p=p}catch($){console.error("[nostr-list] Failed to load metadata:",$)}}function I($){return p.get($)}se(()=>Ot(i()),()=>{try{const $=Number(i());F(f,Number.isFinite($)&&$>0?Math.floor($):50)}catch{F(f,50)}}),se(()=>Ot(s()),()=>{F(h,s()==="dark"?"theme-dark":s()==="light"?"theme-light":"")}),se(()=>(k(v),Ot(r())),()=>{k(v)&&r()&&m()}),xo(),Io();var w=Um(),S=X(w);{var _=$=>{var B=Rm();q($,B)},T=($,B)=>{{var P=z=>{var b=Bm(),E=X(b);J(b),Z(()=>$t(E,`Error: ${k(y)??""}`)),q(z,b)},U=(z,b)=>{{var E=A=>{var N=_m();q(A,N)},O=A=>{var N=qm();Xn(N,5,()=>k(g),L=>L.id,(L,C)=>{const M=Bt(()=>(k(C),ft(()=>k(C)?.tags?.filter(pt=>pt[0]==="p"&&typeof pt[1]=="string")?.map(pt=>pt[1])))),Y=Bt(()=>(k(C),ft(()=>I(k(C).pubkey)))),lt=Bt(()=>(Ot(vo),Ot(a()),k(C),ft(()=>vo(a(),k(C).id,"https://njump.me/{id}")))),bt=Bt(()=>k(d)||!k(C));{const pt=dt=>{var ot=Nm();Z(()=>{jt(ot,"href",k(lt)),jt(ot,"target",u())}),q(dt,ot)},wt=dt=>{const ot=Bt(()=>(Ot(k(Y)),ft(()=>k(Y)?.picture)));Ko(dt,{get src(){return k(ot)}})},W=dt=>{const ot=Bt(()=>(Ot(k(Y)),ft(()=>k(Y)?.name)));la(dt,{get name(){return k(ot)}})},G=dt=>{var ot=ut(),Kt=it(ot);{var le=Oe=>{var We=Tm(),kf=X(We,!0);J(We),Z($f=>$t(kf,$f),[()=>(k(C),ft(()=>new Date(k(C).created_at*1e3).toLocaleString()))],Bt),q(Oe,We)};V(Kt,Oe=>{k(C)&&Oe(le)})}q(dt,ot)},et=dt=>{var ot=ut(),Kt=it(ot);Xn(Kt,1,()=>k(M)||[],fi,(le,Oe)=>{var We=Lm();ce(We,"display","name"),Z(()=>ce(We,"theme",s())),Z(()=>ce(We,"id",k(Oe))),q(le,We)}),q(dt,ot)},nt=dt=>{var ot=ut(),Kt=it(ot);{var le=Oe=>{Wo(Oe,{get text(){return k(C),ft(()=>k(C).content)},get themeClass(){return k(h)},get theme(){return s()},get tags(){return k(C),ft(()=>k(C).tags)}})};V(Kt,Oe=>{k(C)&&Oe(le)})}q(dt,ot)},ct=dt=>{var ot=Cm(),Kt=X(ot);J(ot),Z(()=>$t(Kt,`Error: ${k(ct)??""}`)),q(dt,ot)};aa(L,{get class(){return o()},get themeClass(){return k(h)},get noLink(){return c()},get height(){return l()},get showPlaceholders(){return k(bt)},link:pt,avatar:wt,name:W,createdAt:G,replyUser:et,content:nt,error:ct,$$slots:{link:!0,avatar:!0,name:!0,createdAt:!0,replyUser:!0,content:!0,error:!0}})}}),J(N),q(A,N)};V(z,A=>{k(g),ft(()=>k(g).length===0)?A(E):A(O,!1)},b)}};V($,z=>{k(y)?z(P):z(U,!1)},B)}};V(S,$=>{k(d)?$(_):$(T,!1)})}return J(w),Oo(w,($,B)=>Vo?.($,B),()=>x),Z(()=>ur(w,1,`nostr-list-wrapper ${k(h)??""} ${o()??""}`,"svelte-xuua0i")),q(t,w),Vt({get filters(){return r()},set filters($){r($),j()},get relays(){return n()},set relays($){n($),j()},get className(){return o()},set className($){o($),j()},get theme(){return s()},set theme($){s($),j()},get limit(){return i()},set limit($){i($),j()},get height(){return l()},set height($){l($),j()},get href(){return a()},set href($){a($),j()},get target(){return u()},set target($){u($),j()},get noLink(){return c()},set noLink($){c($),j()}})}customElements.define("nostr-list",Jt(jm,{filters:{},relays:{},className:{},theme:{},limit:{},height:{},href:{},target:{},noLink:{}},[],[],!0));export{lw as NostrContainer,jm as NostrEventList,hm as NostrNote,Im as NostrProfile};
